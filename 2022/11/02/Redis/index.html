<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>RedisÁ¨îËÆ∞ | Decap-Blogü•ù</title><meta name="author" content="AXDecap"><meta name="copyright" content="AXDecap"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Redis1„ÄÅÂÆâË£Öhttps:&#x2F;&#x2F;registry.hub.docker.com&#x2F;_&#x2F;redis  ÂáÜÂ§á redis.conf  ‰ªéÂÆòÁΩë‰∏ãËΩΩredis.confÊñá‰ª∂ÔºåÁÇπÂáªË∂ÖÈìæÊé•‰∏ãËΩΩ redisÂÆòÁΩëÔºöhttps:&#x2F;&#x2F;redis.io&#x2F; ËøõÂÖ•ÂÆòÁΩëÔºåÁõ¥Êé•‰∏ãËΩΩ redis-xxx.tar.gzÔºåÁÑ∂ÂêéËß£Âéã‰πüÂèØ‰ª•ÂæóÂà∞redis.conf Â∞Üredis.confÊîæÂú®Êú¨Âú∞ÁöÑ‰∏Ä‰∏™ÁõÆÂΩï,ÊØîÂ¶Ç: D:&#x2F;red">
<meta property="og:type" content="article">
<meta property="og:title" content="RedisÁ¨îËÆ∞">
<meta property="og:url" content="http://example.com/2022/11/02/Redis/index.html">
<meta property="og:site_name" content="Decap-Blogü•ù">
<meta property="og:description" content="Redis1„ÄÅÂÆâË£Öhttps:&#x2F;&#x2F;registry.hub.docker.com&#x2F;_&#x2F;redis  ÂáÜÂ§á redis.conf  ‰ªéÂÆòÁΩë‰∏ãËΩΩredis.confÊñá‰ª∂ÔºåÁÇπÂáªË∂ÖÈìæÊé•‰∏ãËΩΩ redisÂÆòÁΩëÔºöhttps:&#x2F;&#x2F;redis.io&#x2F; ËøõÂÖ•ÂÆòÁΩëÔºåÁõ¥Êé•‰∏ãËΩΩ redis-xxx.tar.gzÔºåÁÑ∂ÂêéËß£Âéã‰πüÂèØ‰ª•ÂæóÂà∞redis.conf Â∞Üredis.confÊîæÂú®Êú¨Âú∞ÁöÑ‰∏Ä‰∏™ÁõÆÂΩï,ÊØîÂ¶Ç: D:&#x2F;red">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://gcore.jsdelivr.net/gh/AXDecap/imagehost/img/mmexport1652792137012.jpg">
<meta property="article:published_time" content="2022-11-02T15:00:00.000Z">
<meta property="article:modified_time" content="2022-11-02T15:00:00.000Z">
<meta property="article:author" content="AXDecap">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gcore.jsdelivr.net/gh/AXDecap/imagehost/img/mmexport1652792137012.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2022/11/02/Redis/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"ÁπÅ","msgToSimplifiedChinese":"ÁÆÄ"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":230},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: true
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"Traditional Chinese Activated Manually","cht_to_chs":"Simplified Chinese Activated Manually","day_to_night":"Dark Mode Activated Manually","night_to_day":"Light Mode Activated Manually","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"top-right"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'RedisÁ¨îËÆ∞',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-11-02 23:00:00'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/AXDecap/imagehost/img/1.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">1</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> È¶ñÈ°µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> ÂΩíÊ°£</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Ê†áÁ≠æ</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> ÂàÜÁ±ª</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Èü≥‰πê</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> ÁîµÂΩ±</span></a></li><li><a class="site-page child" href="/comments/"><i class="fa-fw fas fa-envelope-open"></i><span> ÁïôË®ÄÊùø</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> ÂèãÈìæ</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> ÂÖ≥‰∫é</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://gcore.jsdelivr.net/gh/AXDecap/imagehost/img/mmexport1652792137012.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Decap-Blogü•ù</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> È¶ñÈ°µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> ÂΩíÊ°£</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Ê†áÁ≠æ</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> ÂàÜÁ±ª</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Èü≥‰πê</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> ÁîµÂΩ±</span></a></li><li><a class="site-page child" href="/comments/"><i class="fa-fw fas fa-envelope-open"></i><span> ÁïôË®ÄÊùø</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> ÂèãÈìæ</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> ÂÖ≥‰∫é</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">RedisÁ¨îËÆ∞</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2022-11-02T15:00:00.000Z" title="Created 2022-11-02 23:00:00">2022-11-02</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2022-11-02T15:00:00.000Z" title="Updated 2022-11-02 23:00:00">2022-11-02</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">17.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>62min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="RedisÁ¨îËÆ∞"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h2><h3 id="1„ÄÅÂÆâË£Ö"><a href="#1„ÄÅÂÆâË£Ö" class="headerlink" title="1„ÄÅÂÆâË£Ö"></a>1„ÄÅÂÆâË£Ö</h3><p><a target="_blank" rel="noopener" href="https://registry.hub.docker.com/_/redis">https://registry.hub.docker.com/_/redis</a></p>
<ol>
<li><strong>ÂáÜÂ§á redis.conf</strong></li>
</ol>
<p>‰ªéÂÆòÁΩë‰∏ãËΩΩ<a href="https://link.juejin.cn/?target=http://download.redis.io/redis-stable/redis.conf">redis.conf</a>Êñá‰ª∂ÔºåÁÇπÂáªË∂ÖÈìæÊé•‰∏ãËΩΩ</p>
<p>redisÂÆòÁΩëÔºö<a target="_blank" rel="noopener" href="https://redis.io/">https://redis.io/</a></p>
<p>ËøõÂÖ•ÂÆòÁΩëÔºåÁõ¥Êé•‰∏ãËΩΩ redis-xxx.tar.gzÔºåÁÑ∂ÂêéËß£Âéã‰πüÂèØ‰ª•ÂæóÂà∞redis.conf</p>
<p>Â∞Üredis.confÊîæÂú®Êú¨Âú∞ÁöÑ‰∏Ä‰∏™ÁõÆÂΩï,ÊØîÂ¶Ç: D:&#x2F;redis. Âπ∂ÂØπÊñá‰ª∂ÂÅö‰∏Ä‰∏ã‰øÆÊîπ:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">bind 127.0.0.1 #Ê≥®ÈáäÊéâËøôÈÉ®ÂàÜÔºåËøôÊòØÈôêÂà∂redisÂè™ËÉΩÊú¨Âú∞ËÆøÈóÆ</span><br><span class="line">protected-mode no #ÈªòËÆ§yesÔºåÂºÄÂêØ‰øùÊä§Ê®°ÂºèÔºåÈôêÂà∂‰∏∫Êú¨Âú∞ËÆøÈóÆ</span><br><span class="line">daemonize no#ÈªòËÆ§noÔºåÊîπ‰∏∫yesÊÑè‰∏∫‰ª•ÂÆàÊä§ËøõÁ®ãÊñπÂºèÂêØÂä®ÔºåÂèØÂêéÂè∞ËøêË°åÔºåÈô§ÈùûkillËøõÁ®ãÔºåÊîπ‰∏∫yes‰ºö‰ΩøÈÖçÁΩÆÊñá‰ª∂ÊñπÂºèÂêØÂä®redisÂ§±Ë¥•</span><br><span class="line">databases 16 #Êï∞ÊçÆÂ∫ì‰∏™Êï∞ÔºàÂèØÈÄâÔºâÔºåÊàë‰øÆÊîπ‰∫ÜËøô‰∏™Âè™ÊòØÊü•ÁúãÊòØÂê¶ÁîüÊïà„ÄÇ„ÄÇ</span><br><span class="line">dir  ./ #ËæìÂÖ•Êú¨Âú∞redisÊï∞ÊçÆÂ∫ìÂ≠òÊîæÊñá‰ª∂Â§πÔºàÂèØÈÄâÔºâ</span><br><span class="line">appendonly yes #redisÊåÅ‰πÖÂåñÔºàÂèØÈÄâÔºâ</span><br><span class="line">requirepass  ÂØÜÁ†Å #ÈÖçÁΩÆredisËÆøÈóÆÂØÜÁ†Å</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>ÊãâÂèñÈïúÂÉè</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker search redis</span><br><span class="line">docker pull redis</span><br><span class="line">docker images</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>Âú®D:&#x2F;redisÁõÆÂΩï‰∏ãÈù¢Êñ∞Âª∫dataÁõÆÂΩï,Áî®‰∫éÂ≠òÂÇ®redisÊï∞ÊçÆ</li>
<li>ÂêØÂä®redisÈïúÂÉè(ÈÖçÁΩÆÂíåÊï∞ÊçÆÊò†Â∞ÑÂà∞Êú¨Âú∞)</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -dit --name redis-server -p 6379:6379 -v D:\Software\Redis\conf:/etc/redis -v D:\Software\Redis\data:/data redis:latest redis-server /etc/redis/redis.conf --appendonly yes --requirepass &quot;123456&quot;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ps: ‰∏äÈù¢ÁöÑÂëΩ‰ª§ÈáåÈù¢,Á¨¨‰∏Ä‰∏™<code>-v</code>ÊòØÂ∞Üredis.confÊò†Â∞ÑÂà∞dockerÁöÑredisÈÖçÁΩÆ,Á¨¨‰∫å‰∏™<code>-v</code>ÊòØÂ∞ÜredisÂ≠òÂÇ®Êï∞ÊçÆÂÅöÊò†Â∞Ñ.ËøôÈáå<code>:</code>ÂâçÈù¢ÁöÑË∑ØÂæÑÈÉΩÊòØÊú¨Âú∞ÁöÑË∑ØÂæÑ,‰∏çË¶ÅÂºÑÈîô‰∫Ü</p>
<p>redis-server &#x2F;etc&#x2F;redis&#x2F;redis.confÔºöÊåáÂÆöÂÆπÂô®ÂêØÂä®Êó∂ÊâßË°åÁöÑÂëΩ‰ª§</p>
<p>‚Äìappendonly yes ÂºÄÂêØÊï∞ÊçÆÊåÅ‰πÖÂåñ,</p>
<p> ‚Äìrequirepass ‚Äú123456‚Äù ÊåáÂÆöÂØÜÁ†Å</p>
<p>Ëøô‰∫õÈÖçÁΩÆÂõûË¢´ËÆ∞ÂΩïÂú®ÂÆπÂô®ÂÜÖÈÉ®docker inspect ÂÆπÂô®ÂêçÊü•Áúã</p>
<p>ÂÆûÈ™åÂèëÁé∞, Â¶ÇÊûúÂú®ÈÖçÁΩÆÊñá‰ª∂‰øÆÊîπËøô‰∫õÈÖçÁΩÆÔºåÈáçÂêØredisÂêé‰æùÁÑ∂‰∏ç‰ºöÁîüÊïàÔºåÂè™ÊúâÂú®ÂêØÂä®Êó∂‰∏çÂä†Ëøô‰∫õÂèÇÊï∞ÔºåÊâç‰ºöÊúâÊïà</p>
</blockquote>
<ol start="5">
<li>Êü•Áúã</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker ps</span><br><span class="line">docker exec -it redis-server /bin/bash</span><br><span class="line">redis-cli -a 123456</span><br></pre></td></tr></table></figure>

<h3 id="2„ÄÅÈÖçÁΩÆ"><a href="#2„ÄÅÈÖçÁΩÆ" class="headerlink" title="2„ÄÅÈÖçÁΩÆ"></a>2„ÄÅÈÖçÁΩÆ</h3><p>Redis ÁöÑÈÖçÁΩÆÊñá‰ª∂‰Ωç‰∫é Redis ÂÆâË£ÖÁõÆÂΩï‰∏ãÔºåÊñá‰ª∂Âêç‰∏∫ <strong>redis.conf</strong>(Windows Âêç‰∏∫ redis.windows.conf)„ÄÇ</p>
<p>‰Ω†ÂèØ‰ª•ÈÄöËøá <strong>CONFIG</strong> ÂëΩ‰ª§Êü•ÁúãÊàñËÆæÁΩÆÈÖçÁΩÆÈ°π„ÄÇ</p>
<p>ËØ≠Ê≥ï</p>
<p>Redis CONFIG ÂëΩ‰ª§Ê†ºÂºèÂ¶Ç‰∏ãÔºö</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis 127.0.0.1:6379&gt; CONFIG GET CONFIG_SETTING_NAME</span><br></pre></td></tr></table></figure>

<p>‰ΩøÁî® ***** Âè∑Ëé∑ÂèñÊâÄÊúâÈÖçÁΩÆÈ°πÔºö</p>
<p><strong>ÁºñËæëÈÖçÁΩÆ</strong></p>
<p>‰Ω†ÂèØ‰ª•ÈÄöËøá‰øÆÊîπ redis.conf Êñá‰ª∂Êàñ‰ΩøÁî® <strong>CONFIG set</strong> ÂëΩ‰ª§Êù•‰øÆÊîπÈÖçÁΩÆ„ÄÇ</p>
<p>ËØ≠Ê≥ï</p>
<p><strong>CONFIG SET</strong> ÂëΩ‰ª§Âü∫Êú¨ËØ≠Ê≥ïÔºö</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis 127.0.0.1:6379&gt; CONFIG SET CONFIG_SETTING_NAME NEW_CONFIG_VALUE</span><br></pre></td></tr></table></figure>

<p><strong>ÂèÇÊï∞ËØ¥Êòé</strong></p>
<p>redis.conf ÈÖçÁΩÆÈ°πËØ¥ÊòéÂ¶Ç‰∏ãÔºö</p>
<table>
<thead>
<tr>
<th align="left">Â∫èÂè∑</th>
<th align="left">ÈÖçÁΩÆÈ°π</th>
<th align="left">ËØ¥Êòé</th>
</tr>
</thead>
<tbody><tr>
<td align="left">1</td>
<td align="left"><code>daemonize no</code></td>
<td align="left">Redis ÈªòËÆ§‰∏çÊòØ‰ª•ÂÆàÊä§ËøõÁ®ãÁöÑÊñπÂºèËøêË°åÔºåÂèØ‰ª•ÈÄöËøáËØ•ÈÖçÁΩÆÈ°π‰øÆÊîπÔºå‰ΩøÁî® yes ÂêØÁî®ÂÆàÊä§ËøõÁ®ãÔºàWindows ‰∏çÊîØÊåÅÂÆàÊä§Á∫øÁ®ãÁöÑÈÖçÁΩÆ‰∏∫ no Ôºâ</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left"><code>pidfile /var/run/redis.pid</code></td>
<td align="left">ÂΩì Redis ‰ª•ÂÆàÊä§ËøõÁ®ãÊñπÂºèËøêË°åÊó∂ÔºåRedis ÈªòËÆ§‰ºöÊää pid ÂÜôÂÖ• &#x2F;var&#x2F;run&#x2F;redis.pid Êñá‰ª∂ÔºåÂèØ‰ª•ÈÄöËøá pidfile ÊåáÂÆö</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left"><code>port 6379</code></td>
<td align="left">ÊåáÂÆö Redis ÁõëÂê¨Á´ØÂè£ÔºåÈªòËÆ§Á´ØÂè£‰∏∫ 6379Ôºå‰ΩúËÄÖÂú®Ëá™Â∑±ÁöÑ‰∏ÄÁØáÂçöÊñá‰∏≠Ëß£Èáä‰∫Ü‰∏∫‰ªÄ‰πàÈÄâÁî® 6379 ‰Ωú‰∏∫ÈªòËÆ§Á´ØÂè£ÔºåÂõ†‰∏∫ 6379 Âú®ÊâãÊú∫ÊåâÈîÆ‰∏ä MERZ ÂØπÂ∫îÁöÑÂè∑Á†ÅÔºåËÄå MERZ ÂèñËá™ÊÑèÂ§ßÂà©Ê≠åÂ•≥ Alessia Merz ÁöÑÂêçÂ≠ó</td>
</tr>
<tr>
<td align="left">4</td>
<td align="left"><code>bind 127.0.0.1</code></td>
<td align="left"><strong>ÁªëÂÆöÁöÑ‰∏ªÊú∫Âú∞ÂùÄ</strong>ÔºåÈªòËÆ§Âè™ÊúâÊú¨Âú∞ÂèØ‰ª•ËÆøÈóÆ</td>
</tr>
<tr>
<td align="left">5</td>
<td align="left"><code>timeout 300</code></td>
<td align="left">ÂΩìÂÆ¢Êà∑Á´ØÈó≤ÁΩÆÂ§öÈïøÁßíÂêéÂÖ≥Èó≠ËøûÊé•ÔºåÂ¶ÇÊûúÊåáÂÆö‰∏∫ 0 ÔºåË°®Á§∫ÂÖ≥Èó≠ËØ•ÂäüËÉΩ</td>
</tr>
<tr>
<td align="left">6</td>
<td align="left"><code>loglevel notice</code></td>
<td align="left">ÊåáÂÆöÊó•ÂøóËÆ∞ÂΩïÁ∫ßÂà´ÔºåRedis ÊÄªÂÖ±ÊîØÊåÅÂõõ‰∏™Á∫ßÂà´Ôºödebug„ÄÅverbose„ÄÅnotice„ÄÅwarningÔºåÈªòËÆ§‰∏∫ notice</td>
</tr>
<tr>
<td align="left">7</td>
<td align="left"><code>logfile stdout</code></td>
<td align="left">Êó•ÂøóËÆ∞ÂΩïÊñπÂºèÔºåÈªòËÆ§‰∏∫Ê†áÂáÜËæìÂá∫ÔºåÂ¶ÇÊûúÈÖçÁΩÆ Redis ‰∏∫ÂÆàÊä§ËøõÁ®ãÊñπÂºèËøêË°åÔºåËÄåËøôÈáåÂèàÈÖçÁΩÆ‰∏∫Êó•ÂøóËÆ∞ÂΩïÊñπÂºè‰∏∫Ê†áÂáÜËæìÂá∫ÔºåÂàôÊó•ÂøóÂ∞Ü‰ºöÂèëÈÄÅÁªô &#x2F;dev&#x2F;null</td>
</tr>
<tr>
<td align="left">8</td>
<td align="left"><code>databases 16</code></td>
<td align="left">ËÆæÁΩÆÊï∞ÊçÆÂ∫ìÁöÑÊï∞ÈáèÔºåÈªòËÆ§Êï∞ÊçÆÂ∫ì‰∏∫0ÔºåÂèØ‰ª•‰ΩøÁî®SELECT ÂëΩ‰ª§Âú®ËøûÊé•‰∏äÊåáÂÆöÊï∞ÊçÆÂ∫ìid</td>
</tr>
<tr>
<td align="left">9</td>
<td align="left"><code>save &lt;seconds&gt; &lt;changes&gt;</code>Redis ÈªòËÆ§ÈÖçÁΩÆÊñá‰ª∂‰∏≠Êèê‰æõ‰∫Ü‰∏â‰∏™Êù°‰ª∂Ôºö<strong>save 900 1<strong><strong>save 300 10</strong></strong>save 60 10000</strong>ÂàÜÂà´Ë°®Á§∫ 900 ÁßíÔºà15 ÂàÜÈíüÔºâÂÜÖÊúâ 1 ‰∏™Êõ¥ÊîπÔºå300 ÁßíÔºà5 ÂàÜÈíüÔºâÂÜÖÊúâ 10 ‰∏™Êõ¥Êîπ‰ª•Âèä 60 ÁßíÂÜÖÊúâ 10000 ‰∏™Êõ¥Êîπ„ÄÇ</td>
<td align="left">ÊåáÂÆöÂú®Â§öÈïøÊó∂Èó¥ÂÜÖÔºåÊúâÂ§öÂ∞ëÊ¨°Êõ¥Êñ∞Êìç‰ΩúÔºåÂ∞±Â∞ÜÊï∞ÊçÆÂêåÊ≠•Âà∞Êï∞ÊçÆÊñá‰ª∂ÔºåÂèØ‰ª•Â§ö‰∏™Êù°‰ª∂ÈÖçÂêà</td>
</tr>
<tr>
<td align="left">10</td>
<td align="left"><code>rdbcompression yes</code></td>
<td align="left">ÊåáÂÆöÂ≠òÂÇ®Ëá≥Êú¨Âú∞Êï∞ÊçÆÂ∫ìÊó∂ÊòØÂê¶ÂéãÁº©Êï∞ÊçÆÔºåÈªòËÆ§‰∏∫ yesÔºåRedis ÈááÁî® LZF ÂéãÁº©ÔºåÂ¶ÇÊûú‰∏∫‰∫ÜËäÇÁúÅ CPU Êó∂Èó¥ÔºåÂèØ‰ª•ÂÖ≥Èó≠ËØ•ÈÄâÈ°πÔºå‰ΩÜ‰ºöÂØºËá¥Êï∞ÊçÆÂ∫ìÊñá‰ª∂ÂèòÁöÑÂ∑®Â§ß</td>
</tr>
<tr>
<td align="left">11</td>
<td align="left"><code>dbfilename dump.rdb</code></td>
<td align="left">ÊåáÂÆöÊú¨Âú∞Êï∞ÊçÆÂ∫ìÊñá‰ª∂ÂêçÔºåÈªòËÆ§ÂÄº‰∏∫ dump.rdb</td>
</tr>
<tr>
<td align="left">12</td>
<td align="left"><code>dir ./</code></td>
<td align="left">ÊåáÂÆöÊú¨Âú∞Êï∞ÊçÆÂ∫ìÂ≠òÊîæÁõÆÂΩï</td>
</tr>
<tr>
<td align="left">13</td>
<td align="left"><code>slaveof &lt;masterip&gt; &lt;masterport&gt;</code></td>
<td align="left">ËÆæÁΩÆÂΩìÊú¨Êú∫‰∏∫ slave ÊúçÂä°Êó∂ÔºåËÆæÁΩÆ master ÊúçÂä°ÁöÑ IP Âú∞ÂùÄÂèäÁ´ØÂè£ÔºåÂú® Redis ÂêØÂä®Êó∂ÔºåÂÆÉ‰ºöËá™Âä®‰ªé master ËøõË°åÊï∞ÊçÆÂêåÊ≠•</td>
</tr>
<tr>
<td align="left">14</td>
<td align="left"><code>masterauth &lt;master-password&gt;</code></td>
<td align="left">ÂΩì master ÊúçÂä°ËÆæÁΩÆ‰∫ÜÂØÜÁ†Å‰øùÊä§Êó∂Ôºåslave ÊúçÂä°ËøûÊé• master ÁöÑÂØÜÁ†Å</td>
</tr>
<tr>
<td align="left">15</td>
<td align="left"><code>requirepass foobared</code></td>
<td align="left">ËÆæÁΩÆ Redis ËøûÊé•ÂØÜÁ†ÅÔºåÂ¶ÇÊûúÈÖçÁΩÆ‰∫ÜËøûÊé•ÂØÜÁ†ÅÔºåÂÆ¢Êà∑Á´ØÂú®ËøûÊé• Redis Êó∂ÈúÄË¶ÅÈÄöËøá AUTH <password> ÂëΩ‰ª§Êèê‰æõÂØÜÁ†ÅÔºåÈªòËÆ§ÂÖ≥Èó≠</td>
</tr>
<tr>
<td align="left">16</td>
<td align="left"><code> maxclients 128</code></td>
<td align="left">ËÆæÁΩÆÂêå‰∏ÄÊó∂Èó¥ÊúÄÂ§ßÂÆ¢Êà∑Á´ØËøûÊé•Êï∞ÔºåÈªòËÆ§Êó†ÈôêÂà∂ÔºåRedis ÂèØ‰ª•ÂêåÊó∂ÊâìÂºÄÁöÑÂÆ¢Êà∑Á´ØËøûÊé•Êï∞‰∏∫ Redis ËøõÁ®ãÂèØ‰ª•ÊâìÂºÄÁöÑÊúÄÂ§ßÊñá‰ª∂ÊèèËø∞Á¨¶Êï∞ÔºåÂ¶ÇÊûúËÆæÁΩÆ maxclients 0ÔºåË°®Á§∫‰∏ç‰ΩúÈôêÂà∂„ÄÇÂΩìÂÆ¢Êà∑Á´ØËøûÊé•Êï∞Âà∞ËææÈôêÂà∂Êó∂ÔºåRedis ‰ºöÂÖ≥Èó≠Êñ∞ÁöÑËøûÊé•Âπ∂ÂêëÂÆ¢Êà∑Á´ØËøîÂõû max number of clients reached ÈîôËØØ‰ø°ÊÅØ</td>
</tr>
<tr>
<td align="left">17</td>
<td align="left"><code>maxmemory &lt;bytes&gt;</code></td>
<td align="left">ÊåáÂÆö Redis ÊúÄÂ§ßÂÜÖÂ≠òÈôêÂà∂ÔºåRedis Âú®ÂêØÂä®Êó∂‰ºöÊääÊï∞ÊçÆÂä†ËΩΩÂà∞ÂÜÖÂ≠ò‰∏≠ÔºåËææÂà∞ÊúÄÂ§ßÂÜÖÂ≠òÂêéÔºåRedis ‰ºöÂÖàÂ∞ùËØïÊ∏ÖÈô§Â∑≤Âà∞ÊúüÊàñÂç≥Â∞ÜÂà∞ÊúüÁöÑ KeyÔºåÂΩìÊ≠§ÊñπÊ≥ïÂ§ÑÁêÜ ÂêéÔºå‰ªçÁÑ∂Âà∞ËææÊúÄÂ§ßÂÜÖÂ≠òËÆæÁΩÆÔºåÂ∞ÜÊó†Ê≥ïÂÜçËøõË°åÂÜôÂÖ•Êìç‰ΩúÔºå‰ΩÜ‰ªçÁÑ∂ÂèØ‰ª•ËøõË°åËØªÂèñÊìç‰Ωú„ÄÇRedis Êñ∞ÁöÑ vm Êú∫Âà∂Ôºå‰ºöÊää Key Â≠òÊîæÂÜÖÂ≠òÔºåValue ‰ºöÂ≠òÊîæÂú® swap Âå∫</td>
</tr>
<tr>
<td align="left">18</td>
<td align="left"><code>appendonly no</code></td>
<td align="left">ÊåáÂÆöÊòØÂê¶Âú®ÊØèÊ¨°Êõ¥Êñ∞Êìç‰ΩúÂêéËøõË°åÊó•ÂøóËÆ∞ÂΩïÔºåRedis Âú®ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÊòØÂºÇÊ≠•ÁöÑÊääÊï∞ÊçÆÂÜôÂÖ•Á£ÅÁõòÔºåÂ¶ÇÊûú‰∏çÂºÄÂêØÔºåÂèØËÉΩ‰ºöÂú®Êñ≠ÁîµÊó∂ÂØºËá¥‰∏ÄÊÆµÊó∂Èó¥ÂÜÖÁöÑÊï∞ÊçÆ‰∏¢Â§±„ÄÇÂõ†‰∏∫ redis Êú¨Ë∫´ÂêåÊ≠•Êï∞ÊçÆÊñá‰ª∂ÊòØÊåâ‰∏äÈù¢ save Êù°‰ª∂Êù•ÂêåÊ≠•ÁöÑÔºåÊâÄ‰ª•ÊúâÁöÑÊï∞ÊçÆ‰ºöÂú®‰∏ÄÊÆµÊó∂Èó¥ÂÜÖÂè™Â≠òÂú®‰∫éÂÜÖÂ≠ò‰∏≠„ÄÇÈªòËÆ§‰∏∫ no</td>
</tr>
<tr>
<td align="left">19</td>
<td align="left"><code>appendfilename appendonly.aof</code></td>
<td align="left">ÊåáÂÆöÊõ¥Êñ∞Êó•ÂøóÊñá‰ª∂ÂêçÔºåÈªòËÆ§‰∏∫ appendonly.aof</td>
</tr>
<tr>
<td align="left">20</td>
<td align="left"><code>appendfsync everysec</code></td>
<td align="left">ÊåáÂÆöÊõ¥Êñ∞Êó•ÂøóÊù°‰ª∂ÔºåÂÖ±Êúâ 3 ‰∏™ÂèØÈÄâÂÄºÔºö<strong>no</strong>ÔºöË°®Á§∫Á≠âÊìç‰ΩúÁ≥ªÁªüËøõË°åÊï∞ÊçÆÁºìÂ≠òÂêåÊ≠•Âà∞Á£ÅÁõòÔºàÂø´Ôºâ<strong>always</strong>ÔºöË°®Á§∫ÊØèÊ¨°Êõ¥Êñ∞Êìç‰ΩúÂêéÊâãÂä®Ë∞ÉÁî® fsync() Â∞ÜÊï∞ÊçÆÂÜôÂà∞Á£ÅÁõòÔºàÊÖ¢ÔºåÂÆâÂÖ®Ôºâ<strong>everysec</strong>ÔºöË°®Á§∫ÊØèÁßíÂêåÊ≠•‰∏ÄÊ¨°ÔºàÊäò‰∏≠ÔºåÈªòËÆ§ÂÄºÔºâ</td>
</tr>
<tr>
<td align="left">21</td>
<td align="left"><code>vm-enabled no</code></td>
<td align="left">ÊåáÂÆöÊòØÂê¶ÂêØÁî®ËôöÊãüÂÜÖÂ≠òÊú∫Âà∂ÔºåÈªòËÆ§ÂÄº‰∏∫ noÔºåÁÆÄÂçïÁöÑ‰ªãÁªç‰∏Ä‰∏ãÔºåVM Êú∫Âà∂Â∞ÜÊï∞ÊçÆÂàÜÈ°µÂ≠òÊîæÔºåÁî± Redis Â∞ÜËÆøÈóÆÈáèËæÉÂ∞ëÁöÑÈ°µÂç≥ÂÜ∑Êï∞ÊçÆ swap Âà∞Á£ÅÁõò‰∏äÔºåËÆøÈóÆÂ§öÁöÑÈ°µÈù¢Áî±Á£ÅÁõòËá™Âä®Êç¢Âá∫Âà∞ÂÜÖÂ≠ò‰∏≠ÔºàÂú®ÂêéÈù¢ÁöÑÊñáÁ´†Êàë‰ºö‰ªîÁªÜÂàÜÊûê Redis ÁöÑ VM Êú∫Âà∂Ôºâ</td>
</tr>
<tr>
<td align="left">22</td>
<td align="left"><code>vm-swap-file /tmp/redis.swap</code></td>
<td align="left">ËôöÊãüÂÜÖÂ≠òÊñá‰ª∂Ë∑ØÂæÑÔºåÈªòËÆ§ÂÄº‰∏∫ &#x2F;tmp&#x2F;redis.swapÔºå‰∏çÂèØÂ§ö‰∏™ Redis ÂÆû‰æãÂÖ±‰∫´</td>
</tr>
<tr>
<td align="left">23</td>
<td align="left"><code>vm-max-memory 0</code></td>
<td align="left">Â∞ÜÊâÄÊúâÂ§ß‰∫é vm-max-memory ÁöÑÊï∞ÊçÆÂ≠òÂÖ•ËôöÊãüÂÜÖÂ≠òÔºåÊó†ËÆ∫ vm-max-memory ËÆæÁΩÆÂ§öÂ∞èÔºåÊâÄÊúâÁ¥¢ÂºïÊï∞ÊçÆÈÉΩÊòØÂÜÖÂ≠òÂ≠òÂÇ®ÁöÑ(Redis ÁöÑÁ¥¢ÂºïÊï∞ÊçÆ Â∞±ÊòØ keys)Ôºå‰πüÂ∞±ÊòØËØ¥ÔºåÂΩì vm-max-memory ËÆæÁΩÆ‰∏∫ 0 ÁöÑÊó∂ÂÄôÔºåÂÖ∂ÂÆûÊòØÊâÄÊúâ value ÈÉΩÂ≠òÂú®‰∫éÁ£ÅÁõò„ÄÇÈªòËÆ§ÂÄº‰∏∫ 0</td>
</tr>
<tr>
<td align="left">24</td>
<td align="left"><code>vm-page-size 32</code></td>
<td align="left">Redis swap Êñá‰ª∂ÂàÜÊàê‰∫ÜÂæàÂ§öÁöÑ pageÔºå‰∏Ä‰∏™ÂØπË±°ÂèØ‰ª•‰øùÂ≠òÂú®Â§ö‰∏™ page ‰∏äÈù¢Ôºå‰ΩÜ‰∏Ä‰∏™ page ‰∏ä‰∏çËÉΩË¢´Â§ö‰∏™ÂØπË±°ÂÖ±‰∫´Ôºåvm-page-size ÊòØË¶ÅÊ†πÊçÆÂ≠òÂÇ®ÁöÑ Êï∞ÊçÆÂ§ßÂ∞èÊù•ËÆæÂÆöÁöÑÔºå‰ΩúËÄÖÂª∫ËÆÆÂ¶ÇÊûúÂ≠òÂÇ®ÂæàÂ§öÂ∞èÂØπË±°Ôºåpage Â§ßÂ∞èÊúÄÂ•ΩËÆæÁΩÆ‰∏∫ 32 ÊàñËÄÖ 64bytesÔºõÂ¶ÇÊûúÂ≠òÂÇ®ÂæàÂ§ßÂ§ßÂØπË±°ÔºåÂàôÂèØ‰ª•‰ΩøÁî®Êõ¥Â§ßÁöÑ pageÔºåÂ¶ÇÊûú‰∏çÁ°ÆÂÆöÔºåÂ∞±‰ΩøÁî®ÈªòËÆ§ÂÄº</td>
</tr>
<tr>
<td align="left">25</td>
<td align="left"><code>vm-pages 134217728</code></td>
<td align="left">ËÆæÁΩÆ swap Êñá‰ª∂‰∏≠ÁöÑ page Êï∞ÈáèÔºåÁî±‰∫éÈ°µË°®Ôºà‰∏ÄÁßçË°®Á§∫È°µÈù¢Á©∫Èó≤Êàñ‰ΩøÁî®ÁöÑ bitmapÔºâÊòØÂú®ÊîæÂú®ÂÜÖÂ≠ò‰∏≠ÁöÑÔºåÔºåÂú®Á£ÅÁõò‰∏äÊØè 8 ‰∏™ pages Â∞ÜÊ∂àËÄó 1byte ÁöÑÂÜÖÂ≠ò„ÄÇ</td>
</tr>
<tr>
<td align="left">26</td>
<td align="left"><code>vm-max-threads 4</code></td>
<td align="left">ËÆæÁΩÆËÆøÈóÆswapÊñá‰ª∂ÁöÑÁ∫øÁ®ãÊï∞,ÊúÄÂ•Ω‰∏çË¶ÅË∂ÖËøáÊú∫Âô®ÁöÑÊ†∏Êï∞,Â¶ÇÊûúËÆæÁΩÆ‰∏∫0,ÈÇ£‰πàÊâÄÊúâÂØπswapÊñá‰ª∂ÁöÑÊìç‰ΩúÈÉΩÊòØ‰∏≤Ë°åÁöÑÔºåÂèØËÉΩ‰ºöÈÄ†ÊàêÊØîËæÉÈïøÊó∂Èó¥ÁöÑÂª∂Ëøü„ÄÇÈªòËÆ§ÂÄº‰∏∫4</td>
</tr>
<tr>
<td align="left">27</td>
<td align="left"><code>glueoutputbuf yes</code></td>
<td align="left">ËÆæÁΩÆÂú®ÂêëÂÆ¢Êà∑Á´ØÂ∫îÁ≠îÊó∂ÔºåÊòØÂê¶ÊääËæÉÂ∞èÁöÑÂåÖÂêàÂπ∂‰∏∫‰∏Ä‰∏™ÂåÖÂèëÈÄÅÔºåÈªòËÆ§‰∏∫ÂºÄÂêØ</td>
</tr>
<tr>
<td align="left">28</td>
<td align="left"><code>hash-max-zipmap-entries 64 hash-max-zipmap-value 512</code></td>
<td align="left">ÊåáÂÆöÂú®Ë∂ÖËøá‰∏ÄÂÆöÁöÑÊï∞ÈáèÊàñËÄÖÊúÄÂ§ßÁöÑÂÖÉÁ¥†Ë∂ÖËøáÊüê‰∏Ä‰∏¥ÁïåÂÄºÊó∂ÔºåÈááÁî®‰∏ÄÁßçÁâπÊÆäÁöÑÂìàÂ∏åÁÆóÊ≥ï</td>
</tr>
<tr>
<td align="left">29</td>
<td align="left"><code>activerehashing yes</code></td>
<td align="left">ÊåáÂÆöÊòØÂê¶ÊøÄÊ¥ªÈáçÁΩÆÂìàÂ∏åÔºåÈªòËÆ§‰∏∫ÂºÄÂêØÔºàÂêéÈù¢Âú®‰ªãÁªç Redis ÁöÑÂìàÂ∏åÁÆóÊ≥ïÊó∂ÂÖ∑‰Ωì‰ªãÁªçÔºâ</td>
</tr>
<tr>
<td align="left">30</td>
<td align="left"><code>include /path/to/local.conf</code></td>
<td align="left">ÊåáÂÆöÂåÖÂê´ÂÖ∂ÂÆÉÁöÑÈÖçÁΩÆÊñá‰ª∂ÔºåÂèØ‰ª•Âú®Âêå‰∏Ä‰∏ªÊú∫‰∏äÂ§ö‰∏™RedisÂÆû‰æã‰πãÈó¥‰ΩøÁî®Âêå‰∏Ä‰ªΩÈÖçÁΩÆÊñá‰ª∂ÔºåËÄåÂêåÊó∂ÂêÑ‰∏™ÂÆû‰æãÂèàÊã•ÊúâËá™Â∑±ÁöÑÁâπÂÆöÈÖçÁΩÆÊñá‰ª∂</td>
</tr>
</tbody></table>
<h3 id="3„ÄÅÂ∏∏Áî®‰∫îÂ§ßÊï∞ÊçÆÁ±ªÂûã"><a href="#3„ÄÅÂ∏∏Áî®‰∫îÂ§ßÊï∞ÊçÆÁ±ªÂûã" class="headerlink" title="3„ÄÅÂ∏∏Áî®‰∫îÂ§ßÊï∞ÊçÆÁ±ªÂûã"></a>3„ÄÅÂ∏∏Áî®‰∫îÂ§ßÊï∞ÊçÆÁ±ªÂûã</h3><p>redisÂ∏∏ËßÅÊï∞ÊçÆÁ±ªÂûãÊìç‰ΩúÂëΩ‰ª§<a target="_blank" rel="noopener" href="http://www.redis.cn/commands.html">http://www.redis.cn/commands.html</a></p>
<p>Redis Êï∞ÊçÆÂ∫ìÊîØÊåÅ‰∫îÁßçÊï∞ÊçÆÁ±ªÂûã„ÄÇ</p>
<ul>
<li>Â≠óÁ¨¶‰∏≤ÔºàstringÔºâ</li>
<li>ÂìàÂ∏åÔºàhashÔºâ</li>
<li>ÂàóË°®ÔºàlistÔºâ</li>
<li>ÈõÜÂêàÔºàsetÔºâ</li>
<li>ÊúâÂ∫èÈõÜÂêàÔºàsorted setÔºâ</li>
<li>‰ΩçÂõæ ( Bitmaps )</li>
<li>Âü∫Êï∞ÁªüËÆ° ( HyperLogLogs )</li>
</ul>
<h4 id="2-1ÂëΩ‰ª§"><a href="#2-1ÂëΩ‰ª§" class="headerlink" title="2.1ÂëΩ‰ª§"></a>2.1ÂëΩ‰ª§</h4><p>Ë¶ÅÂú® redis ÊúçÂä°‰∏äÊâßË°åÂëΩ‰ª§ÈúÄË¶Å‰∏Ä‰∏™ redis ÂÆ¢Êà∑Á´Ø„ÄÇRedis ÂÆ¢Êà∑Á´ØÂú®Êàë‰ª¨‰πãÂâç‰∏ãËΩΩÁöÑÁöÑ redis ÁöÑÂÆâË£ÖÂåÖ‰∏≠„ÄÇ</p>
<p>ËØ≠Ê≥ï</p>
<p>Redis ÂÆ¢Êà∑Á´ØÁöÑÂü∫Êú¨ËØ≠Ê≥ï‰∏∫Ôºö</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ redis-cli</span><br></pre></td></tr></table></figure>

<p>ÂÆû‰æã</p>
<p>‰ª•‰∏ãÂÆû‰æãËÆ≤Ëß£‰∫ÜÂ¶Ç‰ΩïÂêØÂä® redis ÂÆ¢Êà∑Á´ØÔºö</p>
<p>ÂêØÂä® redis ÊúçÂä°Âô®ÔºåÊâìÂºÄÁªàÁ´ØÂπ∂ËæìÂÖ•ÂëΩ‰ª§ <strong>redis-cli</strong>ÔºåËØ•ÂëΩ‰ª§‰ºöËøûÊé•Êú¨Âú∞ÁöÑ redis ÊúçÂä°„ÄÇ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ redis-cli</span><br><span class="line">redis 127.0.0.1:6379&gt;</span><br><span class="line">redis 127.0.0.1:6379&gt; PING</span><br><span class="line"></span><br><span class="line">PONG</span><br></pre></td></tr></table></figure>

<p>Âú®‰ª•‰∏äÂÆû‰æã‰∏≠Êàë‰ª¨ËøûÊé•Âà∞Êú¨Âú∞ÁöÑ redis ÊúçÂä°Âπ∂ÊâßË°å <strong>PING</strong> ÂëΩ‰ª§ÔºåËØ•ÂëΩ‰ª§Áî®‰∫éÊ£ÄÊµã redis ÊúçÂä°ÊòØÂê¶ÂêØÂä®„ÄÇ</p>
<p>Âú®ËøúÁ®ãÊúçÂä°‰∏äÊâßË°åÂëΩ‰ª§</p>
<p>Â¶ÇÊûúÈúÄË¶ÅÂú®ËøúÁ®ã redis ÊúçÂä°‰∏äÊâßË°åÂëΩ‰ª§ÔºåÂêåÊ†∑Êàë‰ª¨‰ΩøÁî®ÁöÑ‰πüÊòØ <strong>redis-cli</strong> ÂëΩ‰ª§„ÄÇ</p>
<p>ËØ≠Ê≥ï</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ redis-cli -h host -p port -a password</span><br></pre></td></tr></table></figure>

<p>ÂÆû‰æã</p>
<p>‰ª•‰∏ãÂÆû‰æãÊºîÁ§∫‰∫ÜÂ¶Ç‰ΩïËøûÊé•Âà∞‰∏ªÊú∫‰∏∫ 127.0.0.1ÔºåÁ´ØÂè£‰∏∫ 6379 ÔºåÂØÜÁ†Å‰∏∫ mypass ÁöÑ redis ÊúçÂä°‰∏ä„ÄÇ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$redis-cli -h 127.0.0.1 -p 6379 -a &quot;mypass&quot;</span><br><span class="line">redis 127.0.0.1:6379&gt;</span><br><span class="line">redis 127.0.0.1:6379&gt; PING</span><br><span class="line"></span><br><span class="line">PONG</span><br></pre></td></tr></table></figure>

<h4 id="2-2ÈîÆ"><a href="#2-2ÈîÆ" class="headerlink" title="2.2ÈîÆ"></a>2.2ÈîÆ</h4><ul>
<li>keys * Êü•ÁúãÂΩìÂâçÂ∫ìÊâÄÊúâkey</li>
<li>exists key Âà§Êñ≠Êüê‰∏™keyÊòØÂê¶Â≠òÂú®</li>
<li>type key Êü•ÁúãkeyÊòØ‰ªÄ‰πàÁ±ªÂûã</li>
<li>del key Âà†Èô§ÊåáÂÆöÁöÑkeyÊï∞ÊçÆ</li>
<li>unlink key Âà†Èô§ÊåáÂÆöÁöÑkeyÔºåËØ•ÂëΩ‰ª§‰ºöÊâßË°åÂëΩ‰ª§‰πãÂ§ñÁöÑÁ∫øÁ®ã‰∏≠ÊâßË°åÂÆûÈôÖÁöÑÂÜÖÂ≠òÂõûÊî∂ÔºåÂõ†Ê≠§ÂÆÉ‰∏çÊòØÈòªÂ°ûÔºåËÄå <a target="_blank" rel="noopener" href="https://www.redis.com.cn/commands/del.html">DEL</a> ÊòØÈòªÂ°ûÁöÑÔºå‰ªÖÂ∞Ükeys‰ªékeyspaceÂÖÉÊï∞ÊçÆ‰∏≠Âà†Èô§ÔºåÁúüÊ≠£ÁöÑÂà†Èô§‰ºöÂú®ÂêéÁª≠ÂºÇÊ≠•Êìç‰Ωú„ÄÇ</li>
<li>expire key 10 10s ‰∏∫ÁªôÂÆöÁöÑkeyËÆæÁΩÆÂõΩ‰ºÅÊó∂Èó¥</li>
<li>ttl key Êü•ÁúãËøòÊúâÂ§öÂ∞ëÁßíËøáÊúüÔºå-1Ë°®Á§∫Ê∞∏‰πÖ‰∏çËøáÊúüÔºå-2Ë°®Á§∫Â∑≤ËøáÊúüÔºåÈªòËÆ§ÊòØÂÆπ‰∏çËøáÊúü</li>
</ul>
<h4 id="2-1Â≠óÁ¨¶‰∏≤"><a href="#2-1Â≠óÁ¨¶‰∏≤" class="headerlink" title="2.1Â≠óÁ¨¶‰∏≤"></a>2.1Â≠óÁ¨¶‰∏≤</h4><p>string ÊòØ redis ÊúÄÂü∫Êú¨ÁöÑÁ±ªÂûãÔºå‰Ω†ÂèØ‰ª•ÁêÜËß£Êàê‰∏é Memcached ‰∏ÄÊ®°‰∏ÄÊ†∑ÁöÑÁ±ªÂûãÔºå‰∏Ä‰∏™ key ÂØπÂ∫î‰∏Ä‰∏™ value„ÄÇ</p>
<p>string Á±ªÂûãÊòØ‰∫åËøõÂà∂ÂÆâÂÖ®ÁöÑ„ÄÇÊÑèÊÄùÊòØ redis ÁöÑ string ÂèØ‰ª•ÂåÖÂê´<strong>‰ªª‰ΩïÊï∞ÊçÆ</strong>„ÄÇÊØîÂ¶ÇjpgÂõæÁâáÊàñËÄÖÂ∫èÂàóÂåñÁöÑÂØπË±°„ÄÇ</p>
<p>string Á±ªÂûãÊòØ Redis ÊúÄÂü∫Êú¨ÁöÑÊï∞ÊçÆÁ±ªÂûãÔºåstring Á±ªÂûãÁöÑÂÄºÊúÄÂ§ßËÉΩÂ≠òÂÇ® 512MB„ÄÇÂä®ÊÄÅÊâ©ÂÆπ</p>
<p><strong>Â∏∏Áî®ÂëΩ‰ª§</strong></p>
<p>‰∏ãË°®ÂàóÂá∫‰∫ÜÂ∏∏Áî®ÁöÑ redis Â≠óÁ¨¶‰∏≤ÂëΩ‰ª§Ôºö</p>
<table>
<thead>
<tr>
<th align="left">Â∫èÂè∑</th>
<th align="left">ÂëΩ‰ª§ÂèäÊèèËø∞</th>
</tr>
</thead>
<tbody><tr>
<td align="left">1</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/strings-set.html">SET key value</a> ËÆæÁΩÆÊåáÂÆö key ÁöÑÂÄº„ÄÇ</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/strings-get.html">GET key</a> Ëé∑ÂèñÊåáÂÆö key ÁöÑÂÄº„ÄÇ</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left"><strong>MSET key value [key value ‚Ä¶]</strong> ÂêåÊó∂ËÆæÁΩÆ‰∏Ä‰∏™ÊàñÂ§ö‰∏™ key-value ÂØπ„ÄÇ</td>
</tr>
<tr>
<td align="left">4</td>
<td align="left"><strong>MGET key1 [key2..]</strong> Ëé∑ÂèñÊâÄÊúâ(‰∏Ä‰∏™ÊàñÂ§ö‰∏™)ÁªôÂÆö key ÁöÑÂÄº„ÄÇ</td>
</tr>
<tr>
<td align="left">5</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/strings-strlen.html"><strong>STRLEN key</strong></a> ËøîÂõû key ÊâÄÂÇ®Â≠òÁöÑÂ≠óÁ¨¶‰∏≤ÂÄºÁöÑÈïøÂ∫¶„ÄÇ</td>
</tr>
<tr>
<td align="left">6</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/strings-incr.html"><strong>INCR key</strong></a> Â∞Ü key ‰∏≠ÂÇ®Â≠òÁöÑÊï∞Â≠óÂÄºÂ¢û‰∏Ä„ÄÇ</td>
</tr>
<tr>
<td align="left">7</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/strings-decr.html"><strong>DECR key</strong></a> Â∞Ü key ‰∏≠ÂÇ®Â≠òÁöÑÊï∞Â≠óÂÄºÂáè‰∏Ä„ÄÇ</td>
</tr>
<tr>
<td align="left">8</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/strings-incrby.html">INCRBY key increment</a> Â∞Ü key ÊâÄÂÇ®Â≠òÁöÑÂÄºÂä†‰∏äÁªôÂÆöÁöÑÂ¢ûÈáèÂÄºÔºàincrementÔºâ „ÄÇ</td>
</tr>
<tr>
<td align="left">9</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/strings-decrby.html">DECRBY key decrement</a> key ÊâÄÂÇ®Â≠òÁöÑÂÄºÂáèÂéªÁªôÂÆöÁöÑÂáèÈáèÂÄºÔºàdecrementÔºâ „ÄÇ</td>
</tr>
<tr>
<td align="left">10</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/strings-getset.html">GETSET key value</a> Â∞ÜÁªôÂÆö key ÁöÑÂÄºËÆæ‰∏∫ value ÔºåÂπ∂ËøîÂõû key ÁöÑÊóßÂÄº(old value)„ÄÇ</td>
</tr>
<tr>
<td align="left">11</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/strings-setbit.html">SETBIT key offset value</a> ÂØπ key ÊâÄÂÇ®Â≠òÁöÑÂ≠óÁ¨¶‰∏≤ÂÄºÔºåËÆæÁΩÆÊàñÊ∏ÖÈô§ÊåáÂÆöÂÅèÁßªÈáè‰∏äÁöÑ‰Ωç(bit)„ÄÇ<strong>Ëøô‰∏§‰∏™Âú®bitmap‰∏≠‰ΩøÁî®</strong></td>
</tr>
<tr>
<td align="left">12</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/strings-getbit.html">GETBIT key offset</a> ÂØπ key ÊâÄÂÇ®Â≠òÁöÑÂ≠óÁ¨¶‰∏≤ÂÄºÔºåËé∑ÂèñÊåáÂÆöÂÅèÁßªÈáè‰∏äÁöÑ‰Ωç(bit)„ÄÇ</td>
</tr>
<tr>
<td align="left">13</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/strings-setex.html">SETEX key seconds value</a> Â∞ÜÂÄº value ÂÖ≥ËÅîÂà∞ key ÔºåÂπ∂Â∞Ü key ÁöÑËøáÊúüÊó∂Èó¥ËÆæ‰∏∫ seconds (‰ª•Áßí‰∏∫Âçï‰Ωç)„ÄÇ</td>
</tr>
<tr>
<td align="left">14</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/strings-setnx.html">SETNX key value</a> Âè™ÊúâÂú® key ‰∏çÂ≠òÂú®Êó∂ËÆæÁΩÆ key ÁöÑÂÄº„ÄÇ</td>
</tr>
<tr>
<td align="left">15</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/strings-setrange.html">SETRANGE key offset value</a> Áî® value ÂèÇÊï∞Ë¶ÜÂÜôÁªôÂÆö key ÊâÄÂÇ®Â≠òÁöÑÂ≠óÁ¨¶‰∏≤ÂÄºÔºå‰ªéÂÅèÁßªÈáè offset ÂºÄÂßã„ÄÇÔºà<strong>Á¥¢Âºï‰ªé0****ÂºÄÂßã</strong>)</td>
</tr>
<tr>
<td align="left">16</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/strings-getrange.html"><strong>GETRANGE</strong> key start end</a> ËøîÂõû key ‰∏≠Â≠óÁ¨¶‰∏≤ÂÄºÁöÑÂ≠êÂ≠óÁ¨¶Ôºå<strong>Â∑¶Èó≠Âè≥Èó≠</strong></td>
</tr>
<tr>
<td align="left">17</td>
<td align="left"><strong>MSETNX</strong> key value [key value ‚Ä¶] ÂêåÊó∂ËÆæÁΩÆ‰∏Ä‰∏™ÊàñÂ§ö‰∏™ key-value ÂØπÔºåÂΩì‰∏î‰ªÖÂΩìÊâÄÊúâÁªôÂÆö key ÈÉΩ‰∏çÂ≠òÂú®„ÄÇ<strong>ÂéüÂ≠êÊÄßÔºåÊúâ‰∏Ä‰∏™Â§±Ë¥•ÂàôÈÉΩÂ§±Ë¥•</strong></td>
</tr>
<tr>
<td align="left">18</td>
<td align="left">APPEND key value Â¶ÇÊûú key Â∑≤ÁªèÂ≠òÂú®Âπ∂‰∏îÊòØ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤Ôºå APPEND ÂëΩ‰ª§Â∞ÜÊåáÂÆöÁöÑ value ËøΩÂä†Âà∞ËØ• key ÂéüÊù•ÂÄºÔºàvalueÔºâÁöÑÊú´Â∞æ„ÄÇ</td>
</tr>
<tr>
<td align="left">19</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/strings-psetex.html">PSETEX key milliseconds value</a> Ëøô‰∏™ÂëΩ‰ª§Âíå SETEX ÂëΩ‰ª§Áõ∏‰ººÔºå‰ΩÜÂÆÉ‰ª•ÊØ´Áßí‰∏∫Âçï‰ΩçËÆæÁΩÆ key ÁöÑÁîüÂ≠òÊó∂Èó¥ÔºåËÄå‰∏çÊòØÂÉè SETEX ÂëΩ‰ª§ÈÇ£Ê†∑Ôºå‰ª•Áßí‰∏∫Âçï‰Ωç„ÄÇ</td>
</tr>
<tr>
<td align="left">20</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/strings-incrbyfloat.html">INCRBYFLOAT key increment</a> Â∞Ü key ÊâÄÂÇ®Â≠òÁöÑÂÄºÂä†‰∏äÁªôÂÆöÁöÑÊµÆÁÇπÂ¢ûÈáèÂÄºÔºàincrementÔºâ „ÄÇ</td>
</tr>
</tbody></table>
<p>Â∫îÁî®Âú∫ÊôØÔºö</p>
<p><strong>ÁºìÂ≠òÂØπË±°</strong></p>
<p>‰ΩøÁî® String Êù•ÁºìÂ≠òÂØπË±°Êúâ‰∏§ÁßçÊñπÂºèÔºö</p>
<ul>
<li>Áõ¥Êé•ÁºìÂ≠òÊï¥‰∏™ÂØπË±°ÁöÑ JSONÔºåÂëΩ‰ª§‰æãÂ≠êÔºö <code>SET user:1 &#39;&#123;&quot;name&quot;:&quot;xiaolin&quot;, &quot;age&quot;:18&#125;&#39;</code>„ÄÇ</li>
<li>ÈááÁî®Â∞Ü key ËøõË°åÂàÜÁ¶ª‰∏∫ user:ID:Â±ûÊÄßÔºåÈááÁî® MSET Â≠òÂÇ®ÔºåÁî® MGET Ëé∑ÂèñÂêÑÂ±ûÊÄßÂÄºÔºåÂëΩ‰ª§‰æãÂ≠êÔºö <code>MSET user:1:name xiaolin user:1:age 18 user:2:name xiaomei user:2:age 20</code>„ÄÇ</li>
</ul>
<p><strong>Â∏∏ËßÑËÆ°Êï∞</strong></p>
<p><strong>ÂàÜÂ∏ÉÂºèÈîÅ</strong></p>
<p>SET ÂëΩ‰ª§Êúâ‰∏™ NX ÂèÇÊï∞ÂèØ‰ª•ÂÆûÁé∞„Äåkey‰∏çÂ≠òÂú®ÊâçÊèíÂÖ•„ÄçÔºåÂèØ‰ª•Áî®ÂÆÉÊù•ÂÆûÁé∞ÂàÜÂ∏ÉÂºèÈîÅÔºö</p>
<ul>
<li>Â¶ÇÊûú key ‰∏çÂ≠òÂú®ÔºåÂàôÊòæÁ§∫ÊèíÂÖ•ÊàêÂäüÔºåÂèØ‰ª•Áî®Êù•Ë°®Á§∫Âä†ÈîÅÊàêÂäüÔºõ</li>
<li>Â¶ÇÊûú key Â≠òÂú®ÔºåÂàô‰ºöÊòæÁ§∫ÊèíÂÖ•Â§±Ë¥•ÔºåÂèØ‰ª•Áî®Êù•Ë°®Á§∫Âä†ÈîÅÂ§±Ë¥•„ÄÇ</li>
</ul>
<p>‰∏ÄËà¨ËÄåË®ÄÔºåËøò‰ºöÂØπÂàÜÂ∏ÉÂºèÈîÅÂä†‰∏äËøáÊúüÊó∂Èó¥ÔºåÂàÜÂ∏ÉÂºèÈîÅÁöÑÂëΩ‰ª§Â¶Ç‰∏ãÔºö</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SET lock_key unique_value NX PX 10000</span><br></pre></td></tr></table></figure>

<ul>
<li>lock_key Â∞±ÊòØ key ÈîÆÔºõ</li>
<li>unique_value ÊòØÂÆ¢Êà∑Á´ØÁîüÊàêÁöÑÂîØ‰∏ÄÁöÑÊ†áËØÜÔºõ</li>
<li>NX ‰ª£Ë°®Âè™Âú® lock_key ‰∏çÂ≠òÂú®Êó∂ÔºåÊâçÂØπ lock_key ËøõË°åËÆæÁΩÆÊìç‰ΩúÔºõ</li>
<li>PX 10000 Ë°®Á§∫ËÆæÁΩÆ lock_key ÁöÑËøáÊúüÊó∂Èó¥‰∏∫ 10sÔºåËøôÊòØ‰∏∫‰∫ÜÈÅøÂÖçÂÆ¢Êà∑Á´ØÂèëÁîüÂºÇÂ∏∏ËÄåÊó†Ê≥ïÈáäÊîæÈîÅ„ÄÇ</li>
</ul>
<p>ËÄåËß£ÈîÅÁöÑËøáÁ®ãÂ∞±ÊòØÂ∞Ü lock_key ÈîÆÂà†Èô§Ôºå‰ΩÜ‰∏çËÉΩ‰π±Âà†ÔºåË¶Å‰øùËØÅÊâßË°åÊìç‰ΩúÁöÑÂÆ¢Êà∑Á´ØÂ∞±ÊòØÂä†ÈîÅÁöÑÂÆ¢Êà∑Á´Ø„ÄÇÊâÄ‰ª•ÔºåËß£ÈîÅÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨Ë¶ÅÂÖàÂà§Êñ≠ÈîÅÁöÑ unique_value ÊòØÂê¶‰∏∫Âä†ÈîÅÂÆ¢Êà∑Á´ØÔºåÊòØÁöÑËØùÔºåÊâçÂ∞Ü lock_key ÈîÆÂà†Èô§„ÄÇ</p>
<p>ÂèØ‰ª•ÁúãÂà∞ÔºåËß£ÈîÅÊòØÊúâ‰∏§‰∏™Êìç‰ΩúÔºåËøôÊó∂Â∞±ÈúÄË¶Å Lua ËÑöÊú¨Êù•‰øùËØÅËß£ÈîÅÁöÑÂéüÂ≠êÊÄßÔºåÂõ†‰∏∫ Redis Âú®ÊâßË°å Lua ËÑöÊú¨Êó∂ÔºåÂèØ‰ª•‰ª•ÂéüÂ≠êÊÄßÁöÑÊñπÂºèÊâßË°åÔºå‰øùËØÅ‰∫ÜÈîÅÈáäÊîæÊìç‰ΩúÁöÑÂéüÂ≠êÊÄß„ÄÇ</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// ÈáäÊîæÈîÅÊó∂ÔºåÂÖàÊØîËæÉ unique_value ÊòØÂê¶Áõ∏Á≠âÔºåÈÅøÂÖçÈîÅÁöÑËØØÈáäÊîæ</span><br><span class="line"><span class="keyword">if</span> redis.call(<span class="string">&quot;get&quot;</span>,KEYS[<span class="number">1</span>]) == ARGV[<span class="number">1</span>] <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">return</span> redis.call(<span class="string">&quot;del&quot;</span>,KEYS[<span class="number">1</span>])</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>ËøôÊ†∑‰∏ÄÊù•ÔºåÂ∞±ÈÄöËøá‰ΩøÁî® SET ÂëΩ‰ª§Âíå Lua ËÑöÊú¨Âú® Redis ÂçïËäÇÁÇπ‰∏äÂÆåÊàê‰∫ÜÂàÜÂ∏ÉÂºèÈîÅÁöÑÂä†ÈîÅÂíåËß£ÈîÅ„ÄÇ</p>
<h4 id="2-2Hash"><a href="#2-2Hash" class="headerlink" title="2.2Hash"></a>2.2Hash</h4><p>Redis hash ÊòØ‰∏Ä‰∏™ÈîÆÂÄº(key&#x3D;&gt;value)ÂØπÈõÜÂêà„ÄÇ</p>
<p>Redis hash ÊòØ‰∏Ä‰∏™ string Á±ªÂûãÁöÑ field Âíå value ÁöÑÊò†Â∞ÑË°®Ôºåhash ÁâπÂà´ÈÄÇÂêàÁî®‰∫éÂ≠òÂÇ®ÂØπË±°„ÄÇ</p>
<p><strong>Â∏∏Áî®ÂëΩ‰ª§</strong></p>
<table>
<thead>
<tr>
<th align="left">Â∫èÂè∑</th>
<th align="left">ÂëΩ‰ª§ÂèäÊèèËø∞</th>
</tr>
</thead>
<tbody><tr>
<td align="left">1</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/hashes-hset.html"><strong>HSET key field value</strong></a> Â∞ÜÂìàÂ∏åË°® key ‰∏≠ÁöÑÂ≠óÊÆµ field ÁöÑÂÄºËÆæ‰∏∫ value „ÄÇ</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/hashes-hget.html">HGET key field</a> Ëé∑ÂèñÂ≠òÂÇ®Âú®ÂìàÂ∏åË°®‰∏≠ÊåáÂÆöÂ≠óÊÆµÁöÑÂÄº„ÄÇ</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/hashes-hmset.html"><strong>HMSET key field1 value1 field2 value2</strong> </a> ÂêåÊó∂Â∞ÜÂ§ö‰∏™ field-value (Âüü-ÂÄº)ÂØπËÆæÁΩÆÂà∞ÂìàÂ∏åË°® key ‰∏≠„ÄÇ</td>
</tr>
<tr>
<td align="left">4</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/hashes-hmget.html"><strong>HMGET key field1 field2</strong></a> Ëé∑ÂèñÊâÄÊúâÁªôÂÆöÂ≠óÊÆµÁöÑÂÄº</td>
</tr>
<tr>
<td align="left">5</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/hashes-hexists.html"><strong>HEXISTS key field</strong></a> Êü•ÁúãÂìàÂ∏åË°® key ‰∏≠ÔºåÊåáÂÆöÁöÑÂ≠óÊÆµÊòØÂê¶Â≠òÂú®„ÄÇ</td>
</tr>
<tr>
<td align="left">6</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/hashes-hkeys.html"><strong>HKEYS key</strong></a> Ëé∑ÂèñÊâÄÊúâÂìàÂ∏åË°®‰∏≠ÁöÑÂ≠óÊÆµ</td>
</tr>
<tr>
<td align="left">7</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/hashes-hvals.html"><strong>HVALS key</strong></a> Ëé∑ÂèñÂìàÂ∏åË°®‰∏≠ÊâÄÊúâÂÄº„ÄÇ</td>
</tr>
<tr>
<td align="left">8</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/hashes-hincrby.html"><strong>HINCRBY key field increment</strong></a> ‰∏∫ÂìàÂ∏åË°® key ‰∏≠ÁöÑÊåáÂÆöÂ≠óÊÆµÁöÑÊï¥Êï∞ÂÄºÂä†‰∏äÂ¢ûÈáè increment „ÄÇ</td>
</tr>
<tr>
<td align="left">9</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/hashes-hsetnx.html"><strong>HSETNX key field value</strong></a> Âè™ÊúâÂú®Â≠óÊÆµ field <code>‰∏çÂ≠òÂú®Êó∂</code>ÔºåËÆæÁΩÆÂìàÂ∏åË°®Â≠óÊÆµÁöÑÂÄº„ÄÇ</td>
</tr>
<tr>
<td align="left">10</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/hashes-hdel.html">HDEL key field1 field2</a> Âà†Èô§‰∏Ä‰∏™ÊàñÂ§ö‰∏™ÂìàÂ∏åË°®Â≠óÊÆµ</td>
</tr>
<tr>
<td align="left">11</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/hashes-hgetall.html">HGETALL key</a> Ëé∑ÂèñÂú®ÂìàÂ∏åË°®‰∏≠ÊåáÂÆö key ÁöÑÊâÄÊúâÂ≠óÊÆµÂíåÂÄº</td>
</tr>
<tr>
<td align="left">12</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/hashes-hincrbyfloat.html">HINCRBYFLOAT key field increment</a> ‰∏∫ÂìàÂ∏åË°® key ‰∏≠ÁöÑÊåáÂÆöÂ≠óÊÆµÁöÑÊµÆÁÇπÊï∞ÂÄºÂä†‰∏äÂ¢ûÈáè increment „ÄÇ</td>
</tr>
<tr>
<td align="left">13</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/hashes-hlen.html">HLEN key</a> Ëé∑ÂèñÂìàÂ∏åË°®‰∏≠Â≠óÊÆµÁöÑÊï∞Èáè</td>
</tr>
<tr>
<td align="left">14</td>
<td align="left">[HSCAN key cursor <a target="_blank" rel="noopener" href="https://www.runoob.com/redis/hashes-hscan.html">MATCH pattern] [COUNT count]</a> Ëø≠‰ª£ÂìàÂ∏åË°®‰∏≠ÁöÑÈîÆÂÄºÂØπ„ÄÇ</td>
</tr>
</tbody></table>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">HMSET user:1 username ajeet password javatpoint alexa 2000  </span><br><span class="line">OK  </span><br><span class="line">HGETALL  user:1  </span><br><span class="line">&quot;username&quot;  </span><br><span class="line">&quot;ajeet&quot;  </span><br><span class="line">&quot;password&quot;  </span><br><span class="line">&quot;javatpoint&quot;  </span><br><span class="line">&quot;alexa&quot;  </span><br><span class="line">&quot;2000&quot; </span><br></pre></td></tr></table></figure>

<p>ËøôÈáåÔºåHMSET Âíå HGETALL ÊòØ Redis ÁöÑÂëΩ‰ª§ÔºåËÄå user:1 ÊòØÈîÆ„ÄÇ</p>
<p>ÊØè‰∏™ÂìàÂ∏åÂèØ‰ª•Â≠òÂÇ®Â§öËææ 2^32^-1‰∏™Â≠óÊÆµ-ÂÄºÂØπÔºà40Â§ö‰∫øÔºâ„ÄÇ</p>
<p>Êï∞ÊçÆÁªìÊûÑ</p>
<p>Hash Á±ªÂûãÁöÑÂ∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑÊòØÁî±<strong>ÂéãÁº©ÂàóË°®ÊàñÂìàÂ∏åË°®</strong>ÂÆûÁé∞ÁöÑÔºö</p>
<ul>
<li>Â¶ÇÊûúÂìàÂ∏åÁ±ªÂûãÂÖÉÁ¥†‰∏™Êï∞Â∞è‰∫é <code>512</code> ‰∏™ÔºàÈªòËÆ§ÂÄºÔºåÂèØÁî± <code>hash-max-ziplist-entries</code> ÈÖçÁΩÆÔºâÔºåÊâÄÊúâÂÄºÂ∞è‰∫é <code>64</code> Â≠óËäÇÔºàÈªòËÆ§ÂÄºÔºåÂèØÁî± <code>hash-max-ziplist-value</code> ÈÖçÁΩÆÔºâÁöÑËØùÔºåRedis ‰ºö‰ΩøÁî®<strong>ÂéãÁº©ÂàóË°®</strong>‰Ωú‰∏∫ Hash Á±ªÂûãÁöÑÂ∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑÔºõ</li>
<li>Â¶ÇÊûúÂìàÂ∏åÁ±ªÂûãÂÖÉÁ¥†‰∏çÊª°Ë∂≥‰∏äÈù¢Êù°‰ª∂ÔºåRedis ‰ºö‰ΩøÁî®<strong>ÂìàÂ∏åË°®</strong>‰Ωú‰∏∫ Hash Á±ªÂûãÁöÑ Â∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑ„ÄÇ</li>
</ul>
<p><strong>Âú® Redis 7.0 ‰∏≠ÔºåÂéãÁº©ÂàóË°®Êï∞ÊçÆÁªìÊûÑÂ∑≤ÁªèÂ∫üÂºÉ‰∫ÜÔºå‰∫§Áî± listpack Êï∞ÊçÆÁªìÊûÑÊù•ÂÆûÁé∞‰∫Ü</strong>„ÄÇ</p>
<h4 id="2-3ÂàóË°®list"><a href="#2-3ÂàóË°®list" class="headerlink" title="2.3ÂàóË°®list"></a>2.3ÂàóË°®list</h4><p>Redis ÂàóË°®ÂÆö‰πâ‰∏∫Â≠óÁ¨¶‰∏≤ÂàóË°®ÔºåÊåâ<strong>ÊèíÂÖ•È°∫Â∫èÊéíÂ∫è</strong>„ÄÇÂèØ‰ª•Â∞ÜÂÖÉÁ¥†Ê∑ªÂä†Âà∞ Redis ÂàóË°®ÁöÑÂ§¥ÈÉ®ÊàñÂ∞æÈÉ®„ÄÇ</p>
<p>ÂàóË°®ÁöÑÊúÄÂ§ßÈïøÂ∫¶‰∏∫ <code>2^32 - 1</code>Ôºå‰πüÂç≥ÊØè‰∏™ÂàóË°®ÊîØÊåÅË∂ÖËøá <code>40 ‰∫ø</code>‰∏™ÂÖÉÁ¥†„ÄÇ</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">redis 127.0.0.1:6379&gt; lpush k1 redis</span><br><span class="line">(integer) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; lpush k1 mongodb</span><br><span class="line">(integer) 2</span><br><span class="line">redis 127.0.0.1:6379&gt; lpush k1 rabbitmq</span><br><span class="line">(integer) 3</span><br><span class="line">redis 127.0.0.1:6379&gt; lrange k1 0 10</span><br><span class="line">1) &quot;rabbitmq&quot;</span><br><span class="line">2) &quot;mongodb&quot;</span><br><span class="line">3) &quot;redis&quot;</span><br><span class="line">redis 127.0.0.1:6379&gt;</span><br></pre></td></tr></table></figure>

<p><strong>Â∏∏Áî®ÂëΩ‰ª§</strong></p>
<table>
<thead>
<tr>
<th align="left">Â∫èÂè∑</th>
<th align="left">ÂëΩ‰ª§ÂèäÊèèËø∞</th>
</tr>
</thead>
<tbody><tr>
<td align="left">1</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/lists-lpush.html"><strong>LPUSH key value1 value2</strong></a> Â∞Ü‰∏Ä‰∏™ÊàñÂ§ö‰∏™ÂÄºÊèíÂÖ•Âà∞ÂàóË°®Â§¥ÈÉ®</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/lists-rpush.html"><strong>RPUSH key value1 value2</strong></a> Âú®ÂàóË°®‰∏≠Ê∑ªÂä†‰∏Ä‰∏™ÊàñÂ§ö‰∏™ÂÄº</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/lists-lpop.html"><strong>LPOP key</strong></a> ÁßªÂá∫Âπ∂Ëé∑ÂèñÂàóË°®ÁöÑÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†</td>
</tr>
<tr>
<td align="left">4</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/lists-rpop.html"><strong>RPOP key</strong></a> ÁßªÈô§ÂàóË°®ÁöÑÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥†ÔºåËøîÂõûÂÄº‰∏∫ÁßªÈô§ÁöÑÂÖÉÁ¥†„ÄÇ</td>
</tr>
<tr>
<td align="left">5</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/lists-blpop.html"><strong>BLPOP key1 [key2]  timeout</strong></a> ÁßªÂá∫Âπ∂Ëé∑ÂèñÂàóË°®ÁöÑÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†Ôºå Â¶ÇÊûúÂàóË°®Ê≤°ÊúâÂÖÉÁ¥†‰ºöÈòªÂ°ûÂàóË°®Áõ¥Âà∞Á≠âÂæÖË∂ÖÊó∂ÊàñÂèëÁé∞ÂèØÂºπÂá∫ÂÖÉÁ¥†‰∏∫Ê≠¢„ÄÇ</td>
</tr>
<tr>
<td align="left">6</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/lists-brpop.html"><strong>BRPOP key1 [key2]  timeout</strong></a> ÁßªÂá∫Âπ∂Ëé∑ÂèñÂàóË°®ÁöÑÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥†Ôºå Â¶ÇÊûúÂàóË°®Ê≤°ÊúâÂÖÉÁ¥†‰ºöÈòªÂ°ûÂàóË°®Áõ¥Âà∞Á≠âÂæÖË∂ÖÊó∂ÊàñÂèëÁé∞ÂèØÂºπÂá∫ÂÖÉÁ¥†‰∏∫Ê≠¢„ÄÇ</td>
</tr>
<tr>
<td align="left">7</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/lists-brpoplpush.html">BRPOPLPUSH source destination timeout</a> ‰ªéÂàóË°®‰∏≠ÂºπÂá∫‰∏Ä‰∏™ÂÄºÔºåÂ∞ÜÂºπÂá∫ÁöÑÂÖÉÁ¥†ÊèíÂÖ•Âà∞Âè¶Â§ñ‰∏Ä‰∏™ÂàóË°®‰∏≠Âπ∂ËøîÂõûÂÆÉÔºõ Â¶ÇÊûúÂàóË°®Ê≤°ÊúâÂÖÉÁ¥†‰ºöÈòªÂ°ûÂàóË°®Áõ¥Âà∞Á≠âÂæÖË∂ÖÊó∂ÊàñÂèëÁé∞ÂèØÂºπÂá∫ÂÖÉÁ¥†‰∏∫Ê≠¢„ÄÇ</td>
</tr>
<tr>
<td align="left">8</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/lists-lindex.html"><strong>LINDEX key index</strong></a> ÈÄöËøáÁ¥¢ÂºïËé∑ÂèñÂàóË°®‰∏≠ÁöÑÂÖÉÁ¥†</td>
</tr>
<tr>
<td align="left">9</td>
<td align="left"><strong>LRANGE key start stop</strong>Ëé∑ÂèñÂàóË°®ÊåáÂÆöËåÉÂõ¥ÂÜÖÁöÑÂÖÉÁ¥† ,<strong>-1</strong>ÂèØ‰ª•‰ª£Ë°®ÊúÄÂêé‰∏Ä‰∏™</td>
</tr>
<tr>
<td align="left">10</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/lists-llen.html"><strong>LLEN key</strong></a> Ëé∑ÂèñÂàóË°®ÈïøÂ∫¶</td>
</tr>
<tr>
<td align="left">11</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/lists-linsert.html"><strong>LINSERT key BEFORE|AFTER pivot value</strong></a> Âú®ÂàóË°®ÁöÑÂÖÉÁ¥†ÂâçÊàñËÄÖÂêéÊèíÂÖ•ÂÖÉÁ¥†</td>
</tr>
<tr>
<td align="left">12</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/lists-lset.html"><strong>LSET key index value</strong></a> ÈÄöËøáÁ¥¢ÂºïËÆæÁΩÆÂàóË°®ÂÖÉÁ¥†ÁöÑÂÄº</td>
</tr>
<tr>
<td align="left">13</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/lists-lrem.html"><strong>LREM key count value</strong></a> ÁßªÈô§ÂàóË°®ÂÖÉÁ¥†Ôºåcount &gt; 0 : ‰ªéË°®Â§¥ÂºÄÂßãÂêëË°®Â∞æÊêúÁ¥¢ÔºåÁßªÈô§‰∏é VALUE Áõ∏Á≠âÁöÑÂÖÉÁ¥†ÔºåÊï∞Èáè‰∏∫ COUNT „ÄÇcount &lt; 0 : ‰ªéË°®Â∞æÂºÄÂßãÂêëË°®Â§¥ÊêúÁ¥¢Ôºõcount &#x3D; 0 : ÁßªÈô§Ë°®‰∏≠ÊâÄÊúâ‰∏é VALUE Áõ∏Á≠âÁöÑÂÄº„ÄÇ</td>
</tr>
<tr>
<td align="left">14</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/lists-lpushx.html">LPUSHX key value</a> Â∞Ü‰∏Ä‰∏™ÂÄºÊèíÂÖ•Âà∞Â∑≤Â≠òÂú®ÁöÑÂàóË°®Â§¥ÈÉ®</td>
</tr>
<tr>
<td align="left">15</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/lists-rpushx.html">RPUSHX key value</a> ‰∏∫Â∑≤Â≠òÂú®ÁöÑÂàóË°®Ê∑ªÂä†ÂÄº</td>
</tr>
<tr>
<td align="left">16</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/lists-ltrim.html">LTRIM key start stop</a> ÂØπ‰∏Ä‰∏™ÂàóË°®ËøõË°å‰øÆÂâ™(trim)ÔºåÂ∞±ÊòØËØ¥ÔºåËÆ©ÂàóË°®Âè™‰øùÁïôÊåáÂÆöÂå∫Èó¥ÂÜÖÁöÑÂÖÉÁ¥†Ôºå‰∏çÂú®ÊåáÂÆöÂå∫Èó¥‰πãÂÜÖÁöÑÂÖÉÁ¥†ÈÉΩÂ∞ÜË¢´Âà†Èô§„ÄÇ</td>
</tr>
<tr>
<td align="left">17</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/lists-rpoplpush.html">RPOPLPUSH source destination</a> ÁßªÈô§ÂàóË°®ÁöÑÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥†ÔºåÂπ∂Â∞ÜËØ•ÂÖÉÁ¥†Ê∑ªÂä†Âà∞Âè¶‰∏Ä‰∏™ÂàóË°®Âπ∂ËøîÂõû</td>
</tr>
</tbody></table>
<p><strong>Êï∞ÊçÆÁªìÊûÑ</strong></p>
<p>List Á±ªÂûãÁöÑÂ∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑÊòØÁî±<strong>ÂèåÂêëÈìæË°®ÊàñÂéãÁº©ÂàóË°®</strong>ÂÆûÁé∞ÁöÑÔºö</p>
<ul>
<li>Â¶ÇÊûúÂàóË°®ÁöÑÂÖÉÁ¥†‰∏™Êï∞Â∞è‰∫é <code>512</code> ‰∏™ÔºàÈªòËÆ§ÂÄºÔºåÂèØÁî± <code>list-max-ziplist-entries</code> ÈÖçÁΩÆÔºâÔºåÂàóË°®ÊØè‰∏™ÂÖÉÁ¥†ÁöÑÂÄºÈÉΩÂ∞è‰∫é <code>64</code> Â≠óËäÇÔºàÈªòËÆ§ÂÄºÔºåÂèØÁî± <code>list-max-ziplist-value</code> ÈÖçÁΩÆÔºâÔºåRedis ‰ºö‰ΩøÁî®<strong>ÂéãÁº©ÂàóË°®</strong>‰Ωú‰∏∫ List Á±ªÂûãÁöÑÂ∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑÔºõ</li>
<li>Â¶ÇÊûúÂàóË°®ÁöÑÂÖÉÁ¥†‰∏çÊª°Ë∂≥‰∏äÈù¢ÁöÑÊù°‰ª∂ÔºåRedis ‰ºö‰ΩøÁî®<strong>ÂèåÂêëÈìæË°®</strong>‰Ωú‰∏∫ List Á±ªÂûãÁöÑÂ∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑÔºõ</li>
</ul>
<p>‰ΩÜÊòØ<strong>Âú® Redis 3.2 ÁâàÊú¨‰πãÂêéÔºåList Êï∞ÊçÆÁ±ªÂûãÂ∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑÂ∞±Âè™Áî± quicklist ÂÆûÁé∞‰∫ÜÔºåÊõø‰ª£‰∫ÜÂèåÂêëÈìæË°®ÂíåÂéãÁº©ÂàóË°®</strong>„ÄÇ</p>
<p>Âõ†‰∏∫ÊôÆÈÄöÁöÑÈìæË°®ÈúÄË¶ÅÁöÑÈôÑÂä†ÊåáÈíàÁ©∫Èó¥Â§™Â§ßÔºå‰ºöÊØîËæÉÊµ™Ë¥πÁ©∫Èó¥„ÄÇÊØîÂ¶ÇËøô‰∏™ÂàóË°®ÈáåÂ≠òÁöÑÂè™ÊòØintÁ±ªÂûãÁöÑÊï∞ÊçÆÔºåÁªìÊûÑ‰∏äËøòÈúÄË¶Å‰∏§‰∏™È¢ùÂ§ñÁöÑÊåáÈíàprevÂíånext„ÄÇRedisÂ∞ÜÈìæË°®ÂíåziplistÁªìÂêàËµ∑Êù•ÁªÑÊàê‰∫Üquicklist„ÄÇ‰πüÂ∞±ÊòØÂ∞ÜÂ§ö‰∏™ziplist‰ΩøÁî®ÂèåÂêëÊåáÈíà‰∏≤Ëµ∑Êù•‰ΩøÁî®„ÄÇËøôÊ†∑Êó¢Êª°Ë∂≥‰∫ÜÂø´ÈÄüÁöÑÊèíÂÖ•Âà†Èô§ÊÄßËÉΩÔºåÂèà‰∏ç‰ºöÂá∫Áé∞Â§™Â§ßÁöÑÁ©∫Èó¥ÂÜó‰Ωô„ÄÇ</p>
<p>Â∫îÁî®Âú∫ÊôØ</p>
<p><a target="_blank" rel="noopener" href="https://xiaolincoding.com/redis/data_struct/command.html#%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97">Ê∂àÊÅØÈòüÂàó</a></p>
<h4 id="2-4ÈõÜÂêàset"><a href="#2-4ÈõÜÂêàset" class="headerlink" title="2.4ÈõÜÂêàset"></a>2.4ÈõÜÂêàset</h4><p>Redis ÁöÑ Set ÊòØ String Á±ªÂûãÁöÑÊó†Â∫èÈõÜÂêà„ÄÇÈõÜÂêàÊàêÂëòÊòØÂîØ‰∏ÄÁöÑÔºåËøôÂ∞±ÊÑèÂë≥ÁùÄÈõÜÂêà‰∏≠‰∏çËÉΩÂá∫Áé∞ÈáçÂ§çÁöÑÊï∞ÊçÆ„ÄÇ</p>
<p>ÈõÜÂêàÂØπË±°ÁöÑÁºñÁ†ÅÂèØ‰ª•ÊòØ intset ÊàñËÄÖ hashtable„ÄÇ</p>
<p>Redis ‰∏≠ÈõÜÂêàÊòØÈÄöËøáÂìàÂ∏åË°®ÂÆûÁé∞ÁöÑÔºåÊâÄ‰ª•Ê∑ªÂä†ÔºåÂà†Èô§ÔºåÊü•ÊâæÁöÑÂ§çÊùÇÂ∫¶ÈÉΩÊòØ O(1)„ÄÇ</p>
<p>ÈõÜÂêà‰∏≠ÊúÄÂ§ßÁöÑÊàêÂëòÊï∞‰∏∫ 232 - 1 (4294967295, ÊØè‰∏™ÈõÜÂêàÂèØÂ≠òÂÇ®40Â§ö‰∫ø‰∏™ÊàêÂëò)„ÄÇ</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">redis 127.0.0.1:6379&gt; SADD w3ckey redis</span><br><span class="line">(integer) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; SADD w3ckey mongodb</span><br><span class="line">(integer) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; SADD w3ckey mysql</span><br><span class="line">(integer) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; SADD w3ckey mysql</span><br><span class="line">(integer) 0</span><br><span class="line">redis 127.0.0.1:6379&gt; SMEMBERS w3ckey</span><br><span class="line"> </span><br><span class="line">1) &quot;mysql&quot;</span><br><span class="line">2) &quot;mongodb&quot;</span><br><span class="line">3) &quot;redis&quot;</span><br></pre></td></tr></table></figure>

<p><strong>Â∏∏Áî®ÂëΩ‰ª§</strong></p>
<p>‰∏ãË°®ÂàóÂá∫‰∫Ü Redis ÈõÜÂêàÂü∫Êú¨ÂëΩ‰ª§Ôºö</p>
<table>
<thead>
<tr>
<th align="left">Â∫èÂè∑</th>
<th align="left">ÂëΩ‰ª§ÂèäÊèèËø∞</th>
</tr>
</thead>
<tbody><tr>
<td align="left">1</td>
<td align="left"><strong>SADD key member1 [member2]</strong> ÂêëÈõÜÂêàÊ∑ªÂä†‰∏Ä‰∏™ÊàñÂ§ö‰∏™ÊàêÂëò</td>
</tr>
<tr>
<td align="left">10</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.redis.net.cn/order/3603.html"><strong>SPOP key</strong> [count] </a> ÁßªÈô§Âπ∂ËøîÂõûÈõÜÂêà‰∏≠ÁöÑ‰∏Ä‰∏™ÈöèÊú∫ÂÖÉÁ¥†ÔºåÂèØ‰ª•ÂÆûÁé∞ÊäΩÂ•ñÂäüËÉΩÔºåÂä†countÂ∞±ÊòØÁßªÈô§count‰∏™</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.redis.net.cn/order/3595.html"><strong>SCARD key</strong></a> Ëé∑ÂèñÈõÜÂêàÁöÑÊàêÂëòÊï∞</td>
</tr>
<tr>
<td align="left">12</td>
<td align="left"><strong>SREM key member1 [member2]</strong> ÁßªÈô§ÈõÜÂêà‰∏≠‰∏Ä‰∏™ÊàñÂ§ö‰∏™ÊàêÂëò</td>
</tr>
<tr>
<td align="left">8</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.redis.net.cn/order/3601.html"><strong>SMEMBERS key</strong></a> ËøîÂõûÈõÜÂêà‰∏≠ÁöÑÊâÄÊúâÊàêÂëò</td>
</tr>
<tr>
<td align="left">7</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.redis.net.cn/order/3600.html"><strong>SISMEMBER key member</strong></a> Âà§Êñ≠ member ÂÖÉÁ¥†ÊòØÂê¶ÊòØÈõÜÂêà key ÁöÑÊàêÂëò</td>
</tr>
<tr>
<td align="left">11</td>
<td align="left"><strong>SRANDMEMBER key [count]</strong> ËøîÂõûÈõÜÂêà‰∏≠ÈöèÊú∫ÈÄâÂá∫count‰∏™ÂÖÉÁ¥†Ôºå<code>ÂÖÉÁ¥†‰∏ç‰ºö‰ªékey‰∏≠Âà†Èô§</code></td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">SDIFF key1 [key2] ËøîÂõûÁªôÂÆöÊâÄÊúâÈõÜÂêàÁöÑÂ∑ÆÈõÜ</td>
</tr>
<tr>
<td align="left">4</td>
<td align="left">SDIFFSTORE destination key1 [key2] ËøîÂõûÁªôÂÆöÊâÄÊúâÈõÜÂêàÁöÑÂ∑ÆÈõÜÂπ∂Â≠òÂÇ®Âú® destination ‰∏≠</td>
</tr>
<tr>
<td align="left">5</td>
<td align="left">SINTER key1 [key2] ËøîÂõûÁªôÂÆöÊâÄÊúâÈõÜÂêàÁöÑ‰∫§ÈõÜ</td>
</tr>
<tr>
<td align="left">6</td>
<td align="left">SINTERSTORE destination key1 [key2] ËøîÂõûÁªôÂÆöÊâÄÊúâÈõÜÂêàÁöÑ‰∫§ÈõÜÂπ∂Â≠òÂÇ®Âú® destination ‰∏≠</td>
</tr>
<tr>
<td align="left">9</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.redis.net.cn/order/3602.html">SMOVE source destination member</a> Â∞Ü member ÂÖÉÁ¥†‰ªé source ÈõÜÂêàÁßªÂä®Âà∞ destination ÈõÜÂêà</td>
</tr>
<tr>
<td align="left">13</td>
<td align="left">SUNION key1 [key2] ËøîÂõûÊâÄÊúâÁªôÂÆöÈõÜÂêàÁöÑÂπ∂ÈõÜ</td>
</tr>
<tr>
<td align="left">14</td>
<td align="left">SUNIONSTORE destination key1 [key2] ÊâÄÊúâÁªôÂÆöÈõÜÂêàÁöÑÂπ∂ÈõÜÂ≠òÂÇ®Âú® destination ÈõÜÂêà‰∏≠</td>
</tr>
<tr>
<td align="left">15</td>
<td align="left">[SSCAN key cursor <a target="_blank" rel="noopener" href="https://www.redis.net.cn/order/3608.html">MATCH pattern] [COUNT count]</a> Ëø≠‰ª£ÈõÜÂêà‰∏≠ÁöÑÂÖÉÁ¥†</td>
</tr>
</tbody></table>
<p>ÂÜÖÈÉ®ÂÆûÁé∞</p>
<p>Set Á±ªÂûãÁöÑÂ∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑÊòØÁî±<strong>ÂìàÂ∏åË°®ÊàñÊï¥Êï∞ÈõÜÂêà</strong>ÂÆûÁé∞ÁöÑÔºö</p>
<ul>
<li>Â¶ÇÊûúÈõÜÂêà‰∏≠ÁöÑÂÖÉÁ¥†ÈÉΩÊòØÊï¥Êï∞‰∏îÂÖÉÁ¥†‰∏™Êï∞Â∞è‰∫é <code>512</code> ÔºàÈªòËÆ§ÂÄºÔºå<code>set-maxintset-entries</code>ÈÖçÁΩÆÔºâ‰∏™ÔºåRedis ‰ºö‰ΩøÁî®<strong>Êï¥Êï∞ÈõÜÂêà</strong>‰Ωú‰∏∫ Set Á±ªÂûãÁöÑÂ∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑÔºõ</li>
<li>Â¶ÇÊûúÈõÜÂêà‰∏≠ÁöÑÂÖÉÁ¥†‰∏çÊª°Ë∂≥‰∏äÈù¢Êù°‰ª∂ÔºåÂàô Redis ‰ΩøÁî®<strong>ÂìàÂ∏åË°®</strong>‰Ωú‰∏∫ Set Á±ªÂûãÁöÑÂ∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑ„ÄÇ</li>
</ul>
<p><strong>Â∫îÁî®Âú∫ÊôØ</strong></p>
<p><strong>ÁÇπËµû</strong></p>
<p>Set Á±ªÂûãÂèØ‰ª•‰øùËØÅ‰∏Ä‰∏™Áî®Êà∑Âè™ËÉΩÁÇπ‰∏Ä‰∏™ËµûÔºåËøôÈáå‰∏æ‰æãÂ≠ê‰∏Ä‰∏™Âú∫ÊôØÔºåkey ÊòØÊñáÁ´†idÔºåvalue ÊòØÁî®Êà∑id„ÄÇ</p>
<p><code>uid:1</code> „ÄÅ<code>uid:2</code>„ÄÅ<code>uid:3</code> ‰∏â‰∏™Áî®Êà∑ÂàÜÂà´ÂØπ article:1 ÊñáÁ´†ÁÇπËµû‰∫Ü„ÄÇ</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">uid:1 Áî®Êà∑ÂØπÊñáÁ´† article:1 ÁÇπËµû</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">SADD article:1 uid:1</span></span><br><span class="line">(integer) 1</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">uid:2 Áî®Êà∑ÂØπÊñáÁ´† article:1 ÁÇπËµû</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">SADD article:1 uid:2</span></span><br><span class="line">(integer) 1</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">uid:3 Áî®Êà∑ÂØπÊñáÁ´† article:1 ÁÇπËµû</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">SADD article:1 uid:3</span></span><br><span class="line">(integer) 1</span><br></pre></td></tr></table></figure>

<p><code>uid:1</code> ÂèñÊ∂à‰∫ÜÂØπ article:1 ÊñáÁ´†ÁÇπËµû„ÄÇ</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; SREM article:1 uid:1</span><br><span class="line">(integer) 1</span><br></pre></td></tr></table></figure>

<p>Ëé∑Âèñ article:1 ÊñáÁ´†ÊâÄÊúâÁÇπËµûÁî®Êà∑ :</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">SMEMBERS article:1</span></span><br><span class="line">1) &quot;uid:3&quot;</span><br><span class="line">2) &quot;uid:2&quot;</span><br></pre></td></tr></table></figure>

<p>Ëé∑Âèñ article:1 ÊñáÁ´†ÁöÑÁÇπËµûÁî®Êà∑Êï∞ÈáèÔºö</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">SCARD article:1</span></span><br><span class="line">(integer) 2</span><br></pre></td></tr></table></figure>

<p>Âà§Êñ≠Áî®Êà∑ <code>uid:1</code> ÊòØÂê¶ÂØπÊñáÁ´† article:1 ÁÇπËµû‰∫ÜÔºö</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">SISMEMBER article:1 uid:1</span></span><br><span class="line">(integer) 0  # ËøîÂõû0ËØ¥ÊòéÊ≤°ÁÇπËµûÔºåËøîÂõû1ÂàôËØ¥ÊòéÁÇπËµû‰∫Ü</span><br></pre></td></tr></table></figure>

<p><strong>ÂÖ±ÂêåÂÖ≥Ê≥®</strong></p>
<p>Set Á±ªÂûãÊîØÊåÅ‰∫§ÈõÜËøêÁÆóÔºåÊâÄ‰ª•ÂèØ‰ª•Áî®Êù•ËÆ°ÁÆóÂÖ±ÂêåÂÖ≥Ê≥®ÁöÑÂ•ΩÂèã„ÄÅÂÖ¨‰ºóÂè∑Á≠â„ÄÇ</p>
<p>key ÂèØ‰ª•ÊòØÁî®Êà∑idÔºåvalue ÂàôÊòØÂ∑≤ÂÖ≥Ê≥®ÁöÑÂÖ¨‰ºóÂè∑ÁöÑid„ÄÇ</p>
<p><code>uid:1</code> Áî®Êà∑ÂÖ≥Ê≥®ÂÖ¨‰ºóÂè∑ id ‰∏∫ 5„ÄÅ6„ÄÅ7„ÄÅ8„ÄÅ9Ôºå<code>uid:2</code> Áî®Êà∑ÂÖ≥Ê≥®ÂÖ¨‰ºóÂè∑ id ‰∏∫ 7„ÄÅ8„ÄÅ9„ÄÅ10„ÄÅ11„ÄÇ</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">uid:1 Áî®Êà∑ÂÖ≥Ê≥®ÂÖ¨‰ºóÂè∑ <span class="built_in">id</span> ‰∏∫ 5„ÄÅ6„ÄÅ7„ÄÅ8„ÄÅ9</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">SADD uid:1 5 6 7 8 9</span></span><br><span class="line">(integer) 5</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">uid:2  Áî®Êà∑ÂÖ≥Ê≥®ÂÖ¨‰ºóÂè∑ <span class="built_in">id</span> ‰∏∫ 7„ÄÅ8„ÄÅ9„ÄÅ10„ÄÅ11</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">SADD uid:2 7 8 9 10 11</span></span><br><span class="line">(integer) 5</span><br></pre></td></tr></table></figure>

<p><code>uid:1</code> Âíå <code>uid:2</code> ÂÖ±ÂêåÂÖ≥Ê≥®ÁöÑÂÖ¨‰ºóÂè∑Ôºö</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Ëé∑ÂèñÂÖ±ÂêåÂÖ≥Ê≥®</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">SINTER uid:1 uid:2</span></span><br><span class="line">1) &quot;7&quot;</span><br><span class="line">2) &quot;8&quot;</span><br><span class="line">3) &quot;9&quot;</span><br></pre></td></tr></table></figure>

<p>Áªô <code>uid:2</code> Êé®Ëçê <code>uid:1</code> ÂÖ≥Ê≥®ÁöÑÂÖ¨‰ºóÂè∑Ôºö</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">SDIFF uid:1 uid:2</span></span><br><span class="line">1) &quot;5&quot;</span><br><span class="line">2) &quot;6&quot;</span><br></pre></td></tr></table></figure>

<p>È™åËØÅÊüê‰∏™ÂÖ¨‰ºóÂè∑ÊòØÂê¶ÂêåÊó∂Ë¢´ <code>uid:1</code> Êàñ <code>uid:2</code> ÂÖ≥Ê≥®:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">SISMEMBER uid:1 5</span></span><br><span class="line">(integer) 1 # ËøîÂõû0ÔºåËØ¥ÊòéÂÖ≥Ê≥®‰∫Ü</span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">SISMEMBER uid:2 5</span></span><br><span class="line">(integer) 0 # ËøîÂõû0ÔºåËØ¥ÊòéÊ≤°ÂÖ≥Ê≥®</span><br></pre></td></tr></table></figure>

<p><strong>ÊäΩÂ•ñÊ¥ªÂä®</strong></p>
<p>Â≠òÂÇ®ÊüêÊ¥ªÂä®‰∏≠‰∏≠Â•ñÁöÑÁî®Êà∑Âêç ÔºåSet Á±ªÂûãÂõ†‰∏∫ÊúâÂéªÈáçÂäüËÉΩÔºåÂèØ‰ª•‰øùËØÅÂêå‰∏Ä‰∏™Áî®Êà∑‰∏ç‰ºö‰∏≠Â•ñ‰∏§Ê¨°„ÄÇ</p>
<p>key‰∏∫ÊäΩÂ•ñÊ¥ªÂä®ÂêçÔºåvalue‰∏∫ÂëòÂ∑•ÂêçÁß∞ÔºåÊääÊâÄÊúâÂëòÂ∑•ÂêçÁß∞ÊîæÂÖ•ÊäΩÂ•ñÁÆ± Ôºö</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">&gt;</span><span class="language-bash">SADD lucky Tom Jerry John Sean Marry Lindy Sary Mark</span></span><br><span class="line">(integer) 5</span><br></pre></td></tr></table></figure>

<p>Â¶ÇÊûúÂÖÅËÆ∏ÈáçÂ§ç‰∏≠Â•ñÔºåÂèØ‰ª•‰ΩøÁî® SRANDMEMBER ÂëΩ‰ª§„ÄÇ</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ÊäΩÂèñ 1 ‰∏™‰∏ÄÁ≠âÂ•ñÔºö</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">SRANDMEMBER lucky 1</span></span><br><span class="line">1) &quot;Tom&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ÊäΩÂèñ 2 ‰∏™‰∫åÁ≠âÂ•ñÔºö</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">SRANDMEMBER lucky 2</span></span><br><span class="line">1) &quot;Mark&quot;</span><br><span class="line">2) &quot;Jerry&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ÊäΩÂèñ 3 ‰∏™‰∏âÁ≠âÂ•ñÔºö</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">SRANDMEMBER lucky 3</span></span><br><span class="line">1) &quot;Sary&quot;</span><br><span class="line">2) &quot;Tom&quot;</span><br><span class="line">3) &quot;Jerry&quot;</span><br></pre></td></tr></table></figure>

<p>Â¶ÇÊûú‰∏çÂÖÅËÆ∏ÈáçÂ§ç‰∏≠Â•ñÔºåÂèØ‰ª•‰ΩøÁî® SPOP ÂëΩ‰ª§„ÄÇ</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ÊäΩÂèñ‰∏ÄÁ≠âÂ•ñ1‰∏™</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">SPOP lucky 1</span></span><br><span class="line">1) &quot;Sary&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ÊäΩÂèñ‰∫åÁ≠âÂ•ñ2‰∏™</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">SPOP lucky 2</span></span><br><span class="line">1) &quot;Jerry&quot;</span><br><span class="line">2) &quot;Mark&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ÊäΩÂèñ‰∏âÁ≠âÂ•ñ3‰∏™</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">SPOP lucky 3</span></span><br><span class="line">1) &quot;John&quot;</span><br><span class="line">2) &quot;Sean&quot;</span><br><span class="line">3) &quot;Lindy&quot;</span><br></pre></td></tr></table></figure>





<h4 id="2-5ÊúâÂ∫èÈõÜÂêàsorted-set"><a href="#2-5ÊúâÂ∫èÈõÜÂêàsorted-set" class="headerlink" title="2.5ÊúâÂ∫èÈõÜÂêàsorted set"></a>2.5ÊúâÂ∫èÈõÜÂêàsorted set</h4><p>Redis ÊúâÂ∫èÈõÜÂêàÂíåÈõÜÂêà‰∏ÄÊ†∑‰πüÊòØ string Á±ªÂûãÂÖÉÁ¥†ÁöÑÈõÜÂêà,‰∏î‰∏çÂÖÅËÆ∏ÈáçÂ§çÁöÑÊàêÂëò„ÄÇ</p>
<p>‰∏çÂêåÁöÑÊòØÊØè‰∏™ÂÖÉÁ¥†ÈÉΩ‰ºöÂÖ≥ËÅî‰∏Ä‰∏™ double Á±ªÂûãÁöÑÂàÜÊï∞„ÄÇredis Ê≠£ÊòØÈÄöËøáÂàÜÊï∞Êù•‰∏∫ÈõÜÂêà‰∏≠ÁöÑÊàêÂëòËøõË°å‰ªéÂ∞èÂà∞Â§ßÁöÑÊéíÂ∫è„ÄÇ</p>
<p>ÊúâÂ∫èÈõÜÂêàÁöÑÊàêÂëòÊòØÂîØ‰∏ÄÁöÑ,‰ΩÜÂàÜÊï∞(score)Âç¥ÂèØ‰ª•ÈáçÂ§ç„ÄÇ</p>
<p>ÈõÜÂêàÊòØÈÄöËøáÂìàÂ∏åË°®ÂÆûÁé∞ÁöÑÔºåÊâÄ‰ª•Ê∑ªÂä†ÔºåÂà†Èô§ÔºåÊü•ÊâæÁöÑÂ§çÊùÇÂ∫¶ÈÉΩÊòØ O(1)„ÄÇ ÈõÜÂêà‰∏≠ÊúÄÂ§ßÁöÑÊàêÂëòÊï∞‰∏∫ 2^32^ - 1 (4294967295, ÊØè‰∏™ÈõÜÂêàÂèØÂ≠òÂÇ®40Â§ö‰∫ø‰∏™ÊàêÂëò)„ÄÇ</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">redis 127.0.0.1:6379&gt; ZADD runoobkey 1 redis</span><br><span class="line">(integer) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; ZADD runoobkey 2 mongodb</span><br><span class="line">(integer) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; ZADD runoobkey 3 mysql</span><br><span class="line">(integer) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; ZADD runoobkey 3 mysql</span><br><span class="line">(integer) 0</span><br><span class="line">redis 127.0.0.1:6379&gt; ZADD runoobkey 4 mysql</span><br><span class="line">(integer) 0</span><br><span class="line">redis 127.0.0.1:6379&gt; ZRANGE runoobkey 0 10 WITHSCORES</span><br><span class="line"></span><br><span class="line">1) &quot;redis&quot;</span><br><span class="line">2) &quot;1&quot;</span><br><span class="line">3) &quot;mongodb&quot;</span><br><span class="line">4) &quot;2&quot;</span><br><span class="line">5) &quot;mysql&quot;</span><br><span class="line">6) &quot;4&quot;</span><br></pre></td></tr></table></figure>

<p><strong>Â∏∏Áî®ÂëΩ‰ª§</strong></p>
<p>‰∏ãË°®ÂàóÂá∫‰∫Ü redis ÊúâÂ∫èÈõÜÂêàÁöÑÂü∫Êú¨ÂëΩ‰ª§:</p>
<table>
<thead>
<tr>
<th align="left">Â∫èÂè∑</th>
<th align="left">ÂëΩ‰ª§ÂèäÊèèËø∞</th>
</tr>
</thead>
<tbody><tr>
<td align="left">1</td>
<td align="left"><strong>ZADD key score1 member1 [score2 member2]</strong> ÂêëÊúâÂ∫èÈõÜÂêàÊ∑ªÂä†‰∏Ä‰∏™ÊàñÂ§ö‰∏™ÊàêÂëòÔºåÊàñËÄÖÊõ¥Êñ∞Â∑≤Â≠òÂú®ÊàêÂëòÁöÑÂàÜÊï∞</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.redis.net.cn/order/3610.html"><strong>ZCARD key</strong></a> Ëé∑ÂèñÊúâÂ∫èÈõÜÂêàÁöÑÊàêÂëòÊï∞</td>
</tr>
<tr>
<td align="left">11</td>
<td align="left"><strong>ZREM key member [member ‚Ä¶]</strong> ÁßªÈô§ÊúâÂ∫èÈõÜÂêà‰∏≠ÁöÑ‰∏Ä‰∏™ÊàñÂ§ö‰∏™ÊàêÂëò</td>
</tr>
<tr>
<td align="left">18</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.redis.net.cn/order/3626.html"><strong>ZSCORE key member</strong></a> ËøîÂõûÊúâÂ∫èÈõÜ‰∏≠ÔºåÊàêÂëòÁöÑÂàÜÊï∞ÂÄº</td>
</tr>
<tr>
<td align="left">4</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.redis.net.cn/order/3612.html"><strong>ZINCRBY key increment member</strong></a> ÊúâÂ∫èÈõÜÂêà‰∏≠ÂØπÊåáÂÆöÊàêÂëòÁöÑÂàÜÊï∞Âä†‰∏äÂ¢ûÈáè increment</td>
</tr>
<tr>
<td align="left">7</td>
<td align="left"><strong>ZRANGE key start stop [WITHSCORES]</strong> ÈÄöËøáÁ¥¢ÂºïÂå∫Èó¥ËøîÂõûÊúâÂ∫èÈõÜÂêàÊàêÊåáÂÆöÂå∫Èó¥ÂÜÖÁöÑÊàêÂëò</td>
</tr>
<tr>
<td align="left">8</td>
<td align="left"><strong>ZRANGEBYLEX key min max [LIMIT offset count]</strong> ÈÄöËøáÂ≠óÂÖ∏Âå∫Èó¥ËøîÂõûÊúâÂ∫èÈõÜÂêàÁöÑÊàêÂëò</td>
</tr>
<tr>
<td align="left">9</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.redis.net.cn/order/3617.html"><strong>ZRANGEBYSCORE key min max [WITHSCORES] [LIMIT offset count</strong>]</a> ÈÄöËøáÂàÜÊï∞ËøîÂõûÊúâÂ∫èÈõÜÂêàÊåáÂÆöÂå∫Èó¥ÂÜÖÁöÑÊàêÂëò</td>
</tr>
<tr>
<td align="left">12</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.redis.net.cn/order/3620.html">ZREMRANGEBYLEX key min max</a> ÁßªÈô§ÊúâÂ∫èÈõÜÂêà‰∏≠ÁªôÂÆöÁöÑÂ≠óÂÖ∏Âå∫Èó¥ÁöÑÊâÄÊúâÊàêÂëò</td>
</tr>
<tr>
<td align="left">14</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.redis.net.cn/order/3622.html">ZREMRANGEBYSCORE key min max</a> ÁßªÈô§ÊúâÂ∫èÈõÜÂêà‰∏≠ÁªôÂÆöÁöÑÂàÜÊï∞Âå∫Èó¥ÁöÑÊâÄÊúâÊàêÂëò</td>
</tr>
<tr>
<td align="left">13</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.redis.net.cn/order/3621.html">ZREMRANGEBYRANK key start stop</a> ÁßªÈô§ÊúâÂ∫èÈõÜÂêà‰∏≠ÁªôÂÆöÁöÑÊéíÂêçÂå∫Èó¥ÁöÑÊâÄÊúâÊàêÂëò</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.redis.net.cn/order/3611.html">ZCOUNT key min max</a> ËÆ°ÁÆóÂú®ÊúâÂ∫èÈõÜÂêà‰∏≠ÊåáÂÆöÂå∫Èó¥ÂàÜÊï∞ÁöÑÊàêÂëòÊï∞</td>
</tr>
<tr>
<td align="left">5</td>
<td align="left">ZINTERSTORE destination numkeys key [key ‚Ä¶] ËÆ°ÁÆóÁªôÂÆöÁöÑ‰∏Ä‰∏™ÊàñÂ§ö‰∏™ÊúâÂ∫èÈõÜÁöÑ‰∫§ÈõÜÂπ∂Â∞ÜÁªìÊûúÈõÜÂ≠òÂÇ®Âú®Êñ∞ÁöÑÊúâÂ∫èÈõÜÂêà key ‰∏≠</td>
</tr>
<tr>
<td align="left">19</td>
<td align="left">ZUNIONSTORE destination numkeys key [key ‚Ä¶]ËÆ°ÁÆóÁªôÂÆöÁöÑ‰∏Ä‰∏™ÊàñÂ§ö‰∏™ÊúâÂ∫èÈõÜÁöÑÂπ∂ÈõÜÔºåÂπ∂Â≠òÂÇ®Âú®Êñ∞ÁöÑ key ‰∏≠</td>
</tr>
<tr>
<td align="left">6</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.redis.net.cn/order/3614.html">ZLEXCOUNT key min max</a> Âú®ÊúâÂ∫èÈõÜÂêà‰∏≠ËÆ°ÁÆóÊåáÂÆöÂ≠óÂÖ∏Âå∫Èó¥ÂÜÖÊàêÂëòÊï∞Èáè</td>
</tr>
<tr>
<td align="left">10</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.redis.net.cn/order/3618.html">ZRANK key member</a> ËøîÂõûÊúâÂ∫èÈõÜÂêà‰∏≠ÊåáÂÆöÊàêÂëòÁöÑÁ¥¢Âºï</td>
</tr>
<tr>
<td align="left">15</td>
<td align="left">ZREVRANGE key start stop [WITHSCORES] ËøîÂõûÊúâÂ∫èÈõÜ‰∏≠ÊåáÂÆöÂå∫Èó¥ÂÜÖÁöÑÊàêÂëòÔºåÈÄöËøáÁ¥¢ÂºïÔºåÂàÜÊï∞‰ªéÈ´òÂà∞Â∫ï</td>
</tr>
<tr>
<td align="left">16</td>
<td align="left">ZREVRANGEBYSCORE key max min [WITHSCORES] ËøîÂõûÊúâÂ∫èÈõÜ‰∏≠ÊåáÂÆöÂàÜÊï∞Âå∫Èó¥ÂÜÖÁöÑÊàêÂëòÔºåÂàÜÊï∞‰ªéÈ´òÂà∞‰ΩéÊéíÂ∫è</td>
</tr>
<tr>
<td align="left">17</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.redis.net.cn/order/3625.html">ZREVRANK key member</a> ËøîÂõûÊúâÂ∫èÈõÜÂêà‰∏≠ÊåáÂÆöÊàêÂëòÁöÑÊéíÂêçÔºåÊúâÂ∫èÈõÜÊàêÂëòÊåâÂàÜÊï∞ÂÄºÈÄíÂáè(‰ªéÂ§ßÂà∞Â∞è)ÊéíÂ∫è</td>
</tr>
<tr>
<td align="left">20</td>
<td align="left">[ZSCAN key cursor <a target="_blank" rel="noopener" href="https://www.redis.net.cn/order/3628.html">MATCH pattern] [COUNT count]</a> Ëø≠‰ª£ÊúâÂ∫èÈõÜÂêà‰∏≠ÁöÑÂÖÉÁ¥†ÔºàÂåÖÊã¨ÂÖÉÁ¥†ÊàêÂëòÂíåÂÖÉÁ¥†ÂàÜÂÄºÔºâ</td>
</tr>
</tbody></table>
<p>ÂÜÖÈÉ®ÂÆûÁé∞</p>
<p>Zset Á±ªÂûãÁöÑÂ∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑÊòØÁî±<strong>ÂéãÁº©ÂàóË°®ÊàñË∑≥Ë°®</strong>ÂÆûÁé∞ÁöÑÔºö</p>
<ul>
<li>Â¶ÇÊûúÊúâÂ∫èÈõÜÂêàÁöÑÂÖÉÁ¥†‰∏™Êï∞Â∞è‰∫é <code>128</code> ‰∏™ÔºåÂπ∂‰∏îÊØè‰∏™ÂÖÉÁ¥†ÁöÑÂÄºÂ∞è‰∫é <code>64</code> Â≠óËäÇÊó∂ÔºåRedis ‰ºö‰ΩøÁî®<strong>ÂéãÁº©ÂàóË°®</strong>‰Ωú‰∏∫ Zset Á±ªÂûãÁöÑÂ∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑÔºõ</li>
<li>Â¶ÇÊûúÊúâÂ∫èÈõÜÂêàÁöÑÂÖÉÁ¥†‰∏çÊª°Ë∂≥‰∏äÈù¢ÁöÑÊù°‰ª∂ÔºåRedis ‰ºö‰ΩøÁî®<strong>Ë∑≥Ë°®</strong>‰Ωú‰∏∫ Zset Á±ªÂûãÁöÑÂ∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑÔºõ</li>
</ul>
<p><strong>Âú® Redis 7.0 ‰∏≠ÔºåÂéãÁº©ÂàóË°®Êï∞ÊçÆÁªìÊûÑÂ∑≤ÁªèÂ∫üÂºÉ‰∫ÜÔºå‰∫§Áî± listpack Êï∞ÊçÆÁªìÊûÑÊù•ÂÆûÁé∞‰∫Ü„ÄÇ</strong></p>
<p><strong>Â∫îÁî®Âú∫ÊôØ</strong></p>
<p><strong>ÊéíË°åÊ¶ú</strong></p>
<p>ÊúâÂ∫èÈõÜÂêàÊØîËæÉÂÖ∏ÂûãÁöÑ‰ΩøÁî®Âú∫ÊôØÂ∞±ÊòØÊéíË°åÊ¶ú„ÄÇ‰æãÂ¶ÇÂ≠¶ÁîüÊàêÁª©ÁöÑÊéíÂêçÊ¶ú„ÄÅÊ∏∏ÊàèÁßØÂàÜÊéíË°åÊ¶ú„ÄÅËßÜÈ¢ëÊí≠ÊîæÊéíÂêç„ÄÅÁîµÂïÜÁ≥ªÁªü‰∏≠ÂïÜÂìÅÁöÑÈîÄÈáèÊéíÂêçÁ≠â„ÄÇ</p>
<p><strong>ÁîµËØù„ÄÅÂßìÂêçÊéíÂ∫è</strong></p>
<p>‰ΩøÁî®ÊúâÂ∫èÈõÜÂêàÁöÑ <code>ZRANGEBYLEX</code> Êàñ <code>ZREVRANGEBYLEX</code> ÂèØ‰ª•Â∏ÆÂä©Êàë‰ª¨ÂÆûÁé∞ÁîµËØùÂè∑Á†ÅÊàñÂßìÂêçÁöÑÊéíÂ∫èÔºåÊàë‰ª¨‰ª• <code>ZRANGEBYLEX</code> ÔºàËøîÂõûÊåáÂÆöÊàêÂëòÂå∫Èó¥ÂÜÖÁöÑÊàêÂëòÔºåÊåâ key Ê≠£Â∫èÊéíÂàóÔºåÂàÜÊï∞ÂøÖÈ°ªÁõ∏ÂêåÔºâ‰∏∫‰æã„ÄÇ</p>
<p><strong>Ê≥®ÊÑèÔºö‰∏çË¶ÅÂú®ÂàÜÊï∞‰∏ç‰∏ÄËá¥ÁöÑ SortSet ÈõÜÂêà‰∏≠Âéª‰ΩøÁî® ZRANGEBYLEXÂíå ZREVRANGEBYLEX Êåá‰ª§ÔºåÂõ†‰∏∫Ëé∑ÂèñÁöÑÁªìÊûú‰ºö‰∏çÂáÜÁ°Æ„ÄÇ</strong></p>
<h4 id="2-6-Êñ∞Êï∞ÊçÆÁ±ªÂûã"><a href="#2-6-Êñ∞Êï∞ÊçÆÁ±ªÂûã" class="headerlink" title="2.6 Êñ∞Êï∞ÊçÆÁ±ªÂûã"></a>2.6 Êñ∞Êï∞ÊçÆÁ±ªÂûã</h4><h6 id="Bitmaps"><a href="#Bitmaps" class="headerlink" title="Bitmaps"></a><strong>Bitmaps</strong></h6><p>RedisÊèê‰æõ‰∫ÜBitmapsËøô‰∏™‚ÄúÊï∞ÊçÆÁ±ªÂûã‚ÄùÂèØ‰ª•ÂÆûÁé∞ÂØπ‰ΩçÁöÑÊìç‰ΩúÔºö</p>
<p>Ôºà1Ôºâ  BitmapsÊú¨Ë∫´‰∏çÊòØ‰∏ÄÁßçÊï∞ÊçÆÁ±ªÂûãÔºå ÂÆûÈôÖ‰∏äÂÆÉÂ∞±ÊòØÂ≠óÁ¨¶‰∏≤Ôºàkey-valueÔºâ Ôºå ‰ΩÜÊòØÂÆÉÂèØ‰ª•ÂØπÂ≠óÁ¨¶‰∏≤ÁöÑ‰ΩçËøõË°åÊìç‰Ωú„ÄÇ</p>
<p>Ôºà2Ôºâ  BitmapsÂçïÁã¨Êèê‰æõ‰∫Ü‰∏ÄÂ•óÂëΩ‰ª§Ôºå ÊâÄ‰ª•Âú®Redis‰∏≠‰ΩøÁî®BitmapsÂíå‰ΩøÁî®Â≠óÁ¨¶‰∏≤ÁöÑÊñπÊ≥ï‰∏çÂ§™Áõ∏Âêå„ÄÇ ÂèØ‰ª•ÊääBitmapsÊÉ≥Ë±°Êàê‰∏Ä‰∏™‰ª•‰Ωç‰∏∫Âçï‰ΩçÁöÑÊï∞ÁªÑÔºå Êï∞ÁªÑÁöÑÊØè‰∏™ÂçïÂÖÉÂè™ËÉΩÂ≠òÂÇ®0Âíå1Ôºå Êï∞ÁªÑÁöÑ‰∏ãÊ†áÂú®Bitmaps‰∏≠Âè´ÂÅöÂÅèÁßªÈáè„ÄÇ</p>
<p>Â∏∏Áî®ÂëΩ‰ª§                       ‰ΩúÁî®</p>
<p>1„ÄÅ<code>getbit key offset</code>   Áî®‰∫éËé∑ÂèñÊåáÂÆökeyÂØπÂ∫îÁöÑÂÄºÔºå‰∏≠ÂØπÂ∫îoffsetÁöÑbit ÔºåÂØπ‰∏çÂ≠òÂú®ÁöÑ key ÊàñËÄÖ‰∏çÂ≠òÂú®ÁöÑ offset ËøõË°å GETBITÔºå ËøîÂõû 0</p>
<p>2„ÄÅ<code>setbit key offset value</code> Áî®‰∫é‰øÆÊîπÊåáÂÆökeyÂØπÂ∫îÁöÑÂÄºÔºå‰∏≠ÂØπÂ∫îoffsetÁöÑbit</p>
<p>3„ÄÅ <code>bitcount key [start end]</code>   Áî®‰∫éÁªüËÆ°Â≠óÁ¨¶‰∏≤Ë¢´ËÆæÁΩÆ‰∏∫1ÁöÑbitÊï∞</p>
<p>4„ÄÅ<code>bitop and/or/xor/not destkey key [key ‚Ä¶]</code> Áî®‰∫é‰∏Ä‰∏™ÊàñÂØπÂ§ö‰∏™keyÊ±ÇÈÄªËæë‰∏é&#x2F;ÈÄªËæëÊàñ&#x2F;ÈÄªËæëÂºÇÊàñ&#x2F;ÈÄªËæëÈùûÔºåÂπ∂Â∞ÜÁªìÊûú‰øùÂ≠òÂà∞ destkey ‰∏ä</p>
<p>BITOP AND destkey key [key ‚Ä¶] ÔºåÂØπ‰∏Ä‰∏™ÊàñÂ§ö‰∏™ key Ê±ÇÈÄª‰∏éÔºåÂπ∂Â∞ÜÁªìÊûú‰øùÂ≠òÂà∞ destkey</p>
<p>BITOP OR destkey key [key ‚Ä¶] ÔºåÂØπ‰∏Ä‰∏™ÊàñÂ§ö‰∏™ key Ê±ÇÈÄªËæëÊàñÔºåÂπ∂Â∞ÜÁªìÊûú‰øùÂ≠òÂà∞ destkey  ÂÖ®0‰∏∫0Ôºå‰∏çÂÖ®0‰∏∫1</p>
<p>BITOP XOR destkey key [key ‚Ä¶] ÔºåÂØπ‰∏Ä‰∏™ÊàñÂ§ö‰∏™ key Ê±ÇÈÄªËæëÂºÇÊàñÔºåÂπ∂Â∞ÜÁªìÊûú‰øùÂ≠òÂà∞ destkey  ‰∏çÂêå‰∏∫1ÔºåÁõ∏Âêå‰∏∫0</p>
<p>BITOP NOT destkey key ÔºåÂØπÁªôÂÆö key Ê±ÇÈÄªËæëÈùûÔºåÂπ∂Â∞ÜÁªìÊûú‰øùÂ≠òÂà∞ destkey  Êåâ‰ΩçÂèñÂèç</p>
<p>Èô§‰∫Ü NOT Êìç‰Ωú‰πãÂ§ñÔºåÂÖ∂‰ªñÊìç‰ΩúÈÉΩÂèØ‰ª•Êé•Âèó‰∏Ä‰∏™ÊàñÂ§ö‰∏™ key ‰Ωú‰∏∫ËæìÂÖ•ÔºåÂΩì BITOP Â§ÑÁêÜ‰∏çÂêåÈïøÂ∫¶ÁöÑÂ≠óÁ¨¶‰∏≤Êó∂ÔºåËæÉÁü≠ÁöÑÈÇ£‰∏™Â≠óÁ¨¶‰∏≤ÊâÄÁº∫Â∞ëÁöÑÈÉ®ÂàÜ‰ºöË¢´Áúã‰Ωú 0ÔºåÁ©∫ÁöÑ key ‰πüË¢´Áúã‰ΩúÊòØÂåÖÂê´ 0 ÁöÑÂ≠óÁ¨¶‰∏≤Â∫èÂàó</p>
<p>BITOP AND destkey key [key ‚Ä¶]ÊºîÁ§∫Ôºö</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; setbit k1 1 1</span><br><span class="line">(integer) 0</span><br><span class="line">&gt; setbit k2 7 1</span><br><span class="line">(integer) 0</span><br><span class="line">&gt; bitop and k3 k1 k2</span><br><span class="line">(integer) 1</span><br><span class="line">&gt; get k3</span><br><span class="line">&quot;\x00&quot;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic4.zhimg.com/80/v2-29777bd1e55114d2b6277123165c45f7_720w.jpg" alt="img"></p>
<p>‚Äã																									ÂÖ®1‰∏∫1Ôºå‰∏çÂÖ®1‰∏∫0</p>
<p><strong>Ê°à‰æã</strong></p>
<p>Redis ‰∫øÁ∫ßÁî®Êà∑‰ø°ÊÅØÂ≠òÂÇ®ÂÆûË∑µÔºöbitmap ‰ΩçÂõæÂ≠òÂÇ®</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://ask.qcloudimg.com/http-save/yehe-2233022/811b1c3c2c73e86780e5c0560780beb4.png?imageView2/2/w/1620"></p>
<p>Â¶ÇÊûú‰∏Ä‰∏™ÁΩëÁ´ôÊúâ1‰∫øÁî®Êà∑,ÂÅáÂ¶Çuser_idÁî®ÁöÑÊòØÊï¥Âûã,ÈïøÂ∫¶‰∏∫32‰Ωç,ÊØèÂ§©Êúâ5ÂçÉ‰∏áÁã¨Á´ãÁî®Êà∑ËÆøÈóÆ,Â¶Ç‰ΩïÂà§Êñ≠ÊòØÂì™5ÂçÉ‰∏áÁî®Êà∑ËÆøÈóÆ‰∫ÜÁΩëÁ´ô„ÄÇ</p>
<ul>
<li>ÊñπÂºè‰∏Ä:Áî®setÊù•‰øùÂ≠ò</li>
</ul>
<p>‰ΩøÁî®setÊù•‰øùÂ≠òÊï∞ÊçÆËøêË°å‰∏ÄÂ§©ÈúÄË¶ÅÂç†Áî®ÁöÑÂÜÖÂ≠ò‰∏∫ 32bit*50000000&#x3D;(4 * 50000000) &#x2F; 1024 &#x2F;1024 MB,Á∫¶‰∏∫200MB</p>
<p>ËøêË°å‰∏Ä‰∏™ÊúàÈúÄË¶ÅÂç†Áî®ÁöÑÂÜÖÂ≠ò‰∏∫30 * 200 &#x3D; 6GÔºåËøêË°å‰∏ÄÂπ¥Âç†Áî®ÁöÑÂÜÖÂ≠ò‰∏∫72G</p>
<ul>
<li>ÊñπÂºè‰∫åÔºö‰ΩøÁî®bitmapÁöÑÊñπÂºè</li>
</ul>
<p>user_id‰Ωú‰∏∫offsetÔºåÂ¶ÇÊûúuser_idËÆøÈóÆÁΩëÁ´ôÔºåÂàôÂú®user_idÁöÑÁ¥¢Âºï‰∏äËÆæÁΩÆ‰∏∫1ÔºåÊ≤°ÊúâËÆøÈóÆÁΩëÁ´ôÁöÑuser_idÔºåÂÖ∂Á¥¢ÂºïËÆæÁΩÆ‰∏∫0ÔºåÊ≠§ÁßçÊñπÂºèËøêË°å‰∏ÄÂ§©Âç†Áî®ÁöÑÂÜÖÂ≠ò‰∏∫ 1bit* 100000000 &#x3D; 100000000 &#x2F; 1024 &#x2F;1024&#x2F; 8MBÔºåÁ∫¶‰∏∫12.5MB ËøêË°å‰∏Ä‰∏™ÊúàÂç†Áî®ÁöÑÂÜÖÂ≠ò‰∏∫375MBÔºå‰∏ÄÂπ¥Âç†Áî®ÁöÑÂÜÖÂ≠òÂÆπÈáè‰∏∫4.5G</p>
<p>Âú∫ÊôØ</p>
<p><strong>ÁΩëÁ´ôÁî®Êà∑Á≠æÂà∞ÁöÑÂ§©Êï∞ÁªüËÆ°</strong></p>
<p>Áî®Êà∑ID‰∏∫keyÔºåÂ§©‰Ωú‰∏∫offsetÔºå‰∏äÁ∫øÁΩÆ‰∏∫1 366&gt; 000000000000000</p>
<p>366 &#x2F;8&#x3D;46Byte ID‰∏∫18ÁöÑÁî®Êà∑Ôºå‰ªäÂπ¥ÁöÑÁ¨¨1Â§©Á≠æÂà∞„ÄÅÁ¨¨30Â§©Á≠æÂà∞</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; setbit u18 1 1</span><br><span class="line">(integer) 0</span><br><span class="line">&gt; setbit u18 30 1</span><br><span class="line">(integer) 0</span><br><span class="line">&gt; bitcount u18 #ÁªüËÆ°id‰∏∫18ÁöÑÁî®Êà∑Á≠æÂà∞ÊÄªÊ¨°Êï∞</span><br><span class="line">(integer) 2</span><br></pre></td></tr></table></figure>

<p><strong>ÊåâÂ§©ÁªüËÆ°ÁΩëÁ´ôÊ¥ªË∑ÉÁî®Êà∑</strong></p>
<p>Â§©‰Ωú‰∏∫keyÔºåÁî®Êà∑ID‰∏∫offsetÔºå‰∏äÁ∫øÁΩÆ‰∏∫1</p>
<p>‰∏Ä‰∫øÁî®Êà∑ÔºåËøêË°å‰∏ÄÂ§©Âç†Áî®ÁöÑÂÜÖÂ≠ò‰∏∫ 1bit* 100000000 &#x3D; 100000000 &#x2F; 1024 &#x2F;1024&#x2F; 8MBÔºåÁ∫¶‰∏∫12.5MB ËøêË°å‰∏Ä‰∏™ÊúàÂç†Áî®ÁöÑÂÜÖÂ≠ò‰∏∫375MBÔºå‰∏ÄÂπ¥Âç†Áî®ÁöÑÂÜÖÂ≠òÂÆπÈáè‰∏∫4.5G</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;SETBIT 20190601 5  1    #0000 0100</span><br><span class="line">&gt;SETBIT 20190602 7  1    #0000 0001 </span><br><span class="line">&gt;SETBIT 20190603 7  1    #0000 0001</span><br><span class="line"></span><br><span class="line">Ê±Ç6Êúà1Êó•Âà∞6Êúà10Êó•ÁöÑÊ¥ªË∑ÉÁî®Êà∑Êï∞</span><br><span class="line">&gt;BITOP OR users 20190601 20190602 20190603 ... 20190610</span><br><span class="line">&gt;BITCOUNT users    #ÁõÆÊ†ákey‰∏∫users ÁªìÊûú‰∏∫2</span><br></pre></td></tr></table></figure>

<p>Áî®Êà∑Âú®Á∫øÁä∂ÊÄÅ„ÄÅÂú®Á∫ø‰∫∫Êï∞ÁªüËÆ°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt; SETBIT online 5  1 #0000 0100 ‰∏äÁ∫ø‰∏∫1</span><br><span class="line">(integer) 0</span><br><span class="line">&gt; SETBIT online 7  1 #0000 0101</span><br><span class="line">(integer) 0</span><br><span class="line">&gt; bitcount online #ÂΩìÂâçÂú®Á∫ø‰∫∫Êï∞</span><br><span class="line">(integer) 2 </span><br><span class="line">&gt; SETBIT online 7  0</span><br><span class="line">(integer) 1</span><br><span class="line">&gt; bitcount online #ÂΩìÂâçÂú®Á∫ø‰∫∫Êï∞</span><br><span class="line">(integer) 1</span><br></pre></td></tr></table></figure>



<h6 id="Redis-HyperLogLog"><a href="#Redis-HyperLogLog" class="headerlink" title="Redis HyperLogLog"></a>Redis HyperLogLog</h6><p>Redis Âú® 2.8.9 ÁâàÊú¨Ê∑ªÂä†‰∫Ü HyperLogLog ÁªìÊûÑ„ÄÇ</p>
<p>Redis HyperLogLog ÊòØÁî®Êù•ÂÅöÂü∫Êï∞ÁªüËÆ°ÁöÑÁÆóÊ≥ïÔºåHyperLogLog ÁöÑ‰ºòÁÇπÊòØÔºåÂú®ËæìÂÖ•ÂÖÉÁ¥†ÁöÑÊï∞ÈáèÊàñËÄÖ‰ΩìÁßØÈùûÂ∏∏ÈùûÂ∏∏Â§ßÊó∂ÔºåËÆ°ÁÆóÂü∫Êï∞ÊâÄÈúÄÁöÑÁ©∫Èó¥ÊÄªÊòØÂõ∫ÂÆö ÁöÑ„ÄÅÂπ∂‰∏îÊòØÂæàÂ∞èÁöÑ„ÄÇ</p>
<p>Âú® Redis ÈáåÈù¢ÔºåÊØè‰∏™ HyperLogLog ÈîÆÂè™ÈúÄË¶ÅËä±Ë¥π 12 KB ÂÜÖÂ≠òÔºåÂ∞±ÂèØ‰ª•ËÆ°ÁÆóÊé•Ëøë 2^64 ‰∏™‰∏çÂêåÂÖÉÁ¥†ÁöÑÂü∫ Êï∞„ÄÇËøôÂíåËÆ°ÁÆóÂü∫Êï∞Êó∂ÔºåÂÖÉÁ¥†Ë∂äÂ§öËÄóË¥πÂÜÖÂ≠òÂ∞±Ë∂äÂ§öÁöÑÈõÜÂêàÂΩ¢ÊàêÈ≤úÊòéÂØπÊØî„ÄÇ</p>
<p>‰ΩÜÊòØÔºåÂõ†‰∏∫ HyperLogLog Âè™‰ºöÊ†πÊçÆËæìÂÖ•ÂÖÉÁ¥†Êù•ËÆ°ÁÆóÂü∫Êï∞ÔºåËÄå‰∏ç‰ºöÂÇ®Â≠òËæìÂÖ•ÂÖÉÁ¥†Êú¨Ë∫´ÔºåÊâÄ‰ª• HyperLogLog ‰∏çËÉΩÂÉèÈõÜÂêàÈÇ£Ê†∑ÔºåËøîÂõûËæìÂÖ•ÁöÑÂêÑ‰∏™ÂÖÉÁ¥†„ÄÇ</p>
<h6 id="GEO"><a href="#GEO" class="headerlink" title="GEO"></a>GEO</h6><p>Redis GEO ‰∏ªË¶ÅÁî®‰∫éÂ≠òÂÇ®Âú∞ÁêÜ‰ΩçÁΩÆ‰ø°ÊÅØÔºåÂπ∂ÂØπÂ≠òÂÇ®ÁöÑ‰ø°ÊÅØËøõË°åÊìç‰ΩúÔºåËØ•ÂäüËÉΩÂú® Redis 3.2 ÁâàÊú¨Êñ∞Â¢û„ÄÇ</p>
<p>Redis GEO Êìç‰ΩúÊñπÊ≥ïÊúâÔºö</p>
<ul>
<li>geoaddÔºöÊ∑ªÂä†Âú∞ÁêÜ‰ΩçÁΩÆÁöÑÂùêÊ†á„ÄÇ</li>
<li>geoposÔºöËé∑ÂèñÂú∞ÁêÜ‰ΩçÁΩÆÁöÑÂùêÊ†á„ÄÇ</li>
<li>geodistÔºöËÆ°ÁÆó‰∏§‰∏™‰ΩçÁΩÆ‰πãÈó¥ÁöÑË∑ùÁ¶ª„ÄÇ</li>
<li>georadiusÔºöÊ†πÊçÆÁî®Êà∑ÁªôÂÆöÁöÑÁªèÁ∫¨Â∫¶ÂùêÊ†áÊù•Ëé∑ÂèñÊåáÂÆöËåÉÂõ¥ÂÜÖÁöÑÂú∞ÁêÜ‰ΩçÁΩÆÈõÜÂêà„ÄÇ</li>
<li>georadiusbymemberÔºöÊ†πÊçÆÂÇ®Â≠òÂú®‰ΩçÁΩÆÈõÜÂêàÈáåÈù¢ÁöÑÊüê‰∏™Âú∞ÁÇπËé∑ÂèñÊåáÂÆöËåÉÂõ¥ÂÜÖÁöÑÂú∞ÁêÜ‰ΩçÁΩÆÈõÜÂêà„ÄÇ</li>
<li>geohashÔºöËøîÂõû‰∏Ä‰∏™ÊàñÂ§ö‰∏™‰ΩçÁΩÆÂØπË±°ÁöÑ geohash ÂÄº„ÄÇ</li>
</ul>
<h3 id="4„ÄÅÂèëÂ∏ÉËÆ¢ÈòÖ"><a href="#4„ÄÅÂèëÂ∏ÉËÆ¢ÈòÖ" class="headerlink" title="4„ÄÅÂèëÂ∏ÉËÆ¢ÈòÖ"></a>4„ÄÅÂèëÂ∏ÉËÆ¢ÈòÖ</h3><p>Redis ÂèëÂ∏ÉËÆ¢ÈòÖ (pub&#x2F;sub) ÊòØ‰∏ÄÁßçÊ∂àÊÅØÈÄö‰ø°Ê®°ÂºèÔºöÂèëÈÄÅËÄÖ (pub) ÂèëÈÄÅÊ∂àÊÅØÔºåËÆ¢ÈòÖËÄÖ (sub) Êé•Êî∂Ê∂àÊÅØ„ÄÇ</p>
<p>Redis ÂÆ¢Êà∑Á´ØÂèØ‰ª•ËÆ¢ÈòÖ‰ªªÊÑèÊï∞ÈáèÁöÑÈ¢ëÈÅì„ÄÇ</p>
<p>‰∏ãÂõæÂ±ïÁ§∫‰∫ÜÈ¢ëÈÅì channel1 Ôºå ‰ª•ÂèäËÆ¢ÈòÖËøô‰∏™È¢ëÈÅìÁöÑ‰∏â‰∏™ÂÆ¢Êà∑Á´Ø ‚Äî‚Äî client2 „ÄÅ client5 Âíå client1 ‰πãÈó¥ÁöÑÂÖ≥Á≥ªÔºö</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://www.runoob.com/wp-content/uploads/2014/11/pubsub1.png" alt="img"></p>
<p>ÂΩìÊúâÊñ∞Ê∂àÊÅØÈÄöËøá PUBLISH ÂëΩ‰ª§ÂèëÈÄÅÁªôÈ¢ëÈÅì channel1 Êó∂Ôºå Ëøô‰∏™Ê∂àÊÅØÂ∞±‰ºöË¢´ÂèëÈÄÅÁªôËÆ¢ÈòÖÂÆÉÁöÑ‰∏â‰∏™ÂÆ¢Êà∑Á´ØÔºö</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://www.runoob.com/wp-content/uploads/2014/11/pubsub2.png" alt="img"></p>
<p>ÂÆû‰æã</p>
<p>‰ª•‰∏ãÂÆû‰æãÊºîÁ§∫‰∫ÜÂèëÂ∏ÉËÆ¢ÈòÖÊòØÂ¶Ç‰ΩïÂ∑•‰ΩúÁöÑÔºåÈúÄË¶ÅÂºÄÂêØ‰∏§‰∏™ redis-cli ÂÆ¢Êà∑Á´Ø„ÄÇ</p>
<p>Á¨¨‰∏Ä‰∏™ redis-cli ÂÆ¢Êà∑Á´ØÔºàËÆ¢ÈòÖËÄÖÔºâ</p>
<p>Âú®Êàë‰ª¨ÂÆû‰æã‰∏≠Êàë‰ª¨ÂàõÂª∫‰∫ÜËÆ¢ÈòÖÈ¢ëÈÅìÂêç‰∏∫ <strong>runoobChat</strong>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">redis 127.0.0.1:6379&gt; SUBSCRIBE runoobChat</span><br><span class="line"></span><br><span class="line">Reading messages... (press Ctrl-C to quit)</span><br><span class="line">1) &quot;subscribe&quot;</span><br><span class="line">2) &quot;runoobChat&quot;</span><br><span class="line">3)(integer) 1</span><br></pre></td></tr></table></figure>

<p>Áé∞Âú®ÔºåÊàë‰ª¨ÂÖàÈáçÊñ∞ÂºÄÂêØ‰∏™ redis ÂÆ¢Êà∑Á´ØÔºåÁÑ∂ÂêéÂú®Âêå‰∏Ä‰∏™È¢ëÈÅì runoobChat ÂèëÂ∏É‰∏§Ê¨°Ê∂àÊÅØÔºåËÆ¢ÈòÖËÄÖÂ∞±ËÉΩÊé•Êî∂Âà∞Ê∂àÊÅØ„ÄÇ</p>
<p>Á¨¨‰∫å‰∏™ redis-cli ÂÆ¢Êà∑Á´ØÔºàÂèëÂ∏ÉËÄÖÔºâ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">redis 127.0.0.1:6379&gt; PUBLISH runoobChat &quot;Redis PUBLISH test&quot;</span><br><span class="line">(integer) 1</span><br><span class="line"></span><br><span class="line">redis 127.0.0.1:6379&gt; PUBLISH runoobChat &quot;Learn redis by runoob.com&quot;</span><br><span class="line">(integer) 1</span><br></pre></td></tr></table></figure>

<p>\ËÆ¢ÈòÖËÄÖÁöÑÂÆ¢Êà∑Á´Ø‰ºöÊòæÁ§∫Â¶Ç‰∏ãÊ∂àÊÅØ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1) &quot;message&quot;</span><br><span class="line">2) &quot;runoobChat&quot;</span><br><span class="line">3) &quot;Redis PUBLISH test&quot;</span><br><span class="line"></span><br><span class="line">1) &quot;message&quot;</span><br><span class="line">2) &quot;runoobChat&quot;</span><br><span class="line">3) &quot;Learn redis by runoob.com&quot;</span><br></pre></td></tr></table></figure>

<p>gif ÊºîÁ§∫Â¶Ç‰∏ãÔºö</p>
<ul>
<li>ÂºÄÂêØÊú¨Âú∞ Redis ÊúçÂä°ÔºåÂºÄÂêØ‰∏§‰∏™ redis-cli ÂÆ¢Êà∑Á´Ø„ÄÇ</li>
<li>Âú®<strong>Á¨¨‰∏Ä‰∏™ redis-cli ÂÆ¢Êà∑Á´Ø</strong>ËæìÂÖ• <strong>SUBSCRIBE runoobChat</strong>ÔºåÊÑèÊÄùÊòØËÆ¢ÈòÖ <code>runoobChat</code> È¢ëÈÅì„ÄÇ</li>
<li>Âú®<strong>Á¨¨‰∫å‰∏™ redis-cli ÂÆ¢Êà∑Á´Ø</strong>ËæìÂÖ• <strong>PUBLISH runoobChat ‚ÄúRedis PUBLISH test‚Äù</strong> ÂæÄ runoobChat È¢ëÈÅìÂèëÈÄÅÊ∂àÊÅØÔºåËøô‰∏™Êó∂ÂÄôÂú®Á¨¨‰∏Ä‰∏™ redis-cli ÂÆ¢Êà∑Á´ØÂ∞±‰ºöÁúãÂà∞Áî±Á¨¨‰∫å‰∏™ redis-cli ÂÆ¢Êà∑Á´ØÂèëÈÄÅÁöÑÊµãËØïÊ∂àÊÅØ„ÄÇ</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://www.runoob.com/wp-content/uploads/2014/11/redis-pub-sub.gif" alt="img"></p>
<p>ÂëΩ‰ª§</p>
<table>
<thead>
<tr>
<th align="left">Â∫èÂè∑</th>
<th align="left">ÂëΩ‰ª§ÂèäÊèèËø∞</th>
</tr>
</thead>
<tbody><tr>
<td align="left">1</td>
<td align="left">PSUBSCRIBE pattern [pattern ‚Ä¶] ËÆ¢ÈòÖ‰∏Ä‰∏™ÊàñÂ§ö‰∏™Á¨¶ÂêàÁªôÂÆöÊ®°ÂºèÁöÑÈ¢ëÈÅì„ÄÇ</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">[PUBSUB subcommand <a target="_blank" rel="noopener" href="https://www.runoob.com/redis/pub-sub-pubsub.html">argument [argument ‚Ä¶]]</a> Êü•ÁúãËÆ¢ÈòÖ‰∏éÂèëÂ∏ÉÁ≥ªÁªüÁä∂ÊÄÅ„ÄÇ</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/pub-sub-publish.html">PUBLISH channel message</a> Â∞Ü‰ø°ÊÅØÂèëÈÄÅÂà∞ÊåáÂÆöÁöÑÈ¢ëÈÅì„ÄÇ</td>
</tr>
<tr>
<td align="left">4</td>
<td align="left">[PUNSUBSCRIBE <a target="_blank" rel="noopener" href="https://www.runoob.com/redis/pub-sub-punsubscribe.html">pattern [pattern ‚Ä¶]]</a> ÈÄÄËÆ¢ÊâÄÊúâÁªôÂÆöÊ®°ÂºèÁöÑÈ¢ëÈÅì„ÄÇ</td>
</tr>
<tr>
<td align="left">5</td>
<td align="left">SUBSCRIBE channel [channel ‚Ä¶] ËÆ¢ÈòÖÁªôÂÆöÁöÑ‰∏Ä‰∏™ÊàñÂ§ö‰∏™È¢ëÈÅìÁöÑ‰ø°ÊÅØ„ÄÇ</td>
</tr>
<tr>
<td align="left">6</td>
<td align="left">[UNSUBSCRIBE <a target="_blank" rel="noopener" href="https://www.runoob.com/redis/pub-sub-unsubscribe.html">channel [channel ‚Ä¶]]</a> ÊåáÈÄÄËÆ¢ÁªôÂÆöÁöÑÈ¢ëÈÅì„ÄÇ</td>
</tr>
</tbody></table>
<h3 id="5„ÄÅJava-‰ΩøÁî®-Redis-Jedis"><a href="#5„ÄÅJava-‰ΩøÁî®-Redis-Jedis" class="headerlink" title="5„ÄÅJava ‰ΩøÁî® Redis(Jedis)"></a>5„ÄÅJava ‰ΩøÁî® Redis(Jedis)</h3><p><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/redis-java.html">Ê°à‰æã</a></p>
<h3 id="6„ÄÅRedis‰∏éSpring-BootÊï¥Âêà"><a href="#6„ÄÅRedis‰∏éSpring-BootÊï¥Âêà" class="headerlink" title="6„ÄÅRedis‰∏éSpring BootÊï¥Âêà"></a>6„ÄÅ<strong>Redis‰∏éSpring BootÊï¥Âêà</strong></h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- redis --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- spring2.XÈõÜÊàêredisÊâÄÈúÄcommon-pool2--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.commons<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-pool2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>2.6.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>application.propertiesÈÖçÁΩÆredisÈÖçÁΩÆ</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#RedisÊúçÂä°Âô®Âú∞ÂùÄ</span></span><br><span class="line"><span class="attr">spring.redis.host</span>=<span class="string">192.168.140.136</span></span><br><span class="line"><span class="comment">#RedisÊúçÂä°Âô®ËøûÊé•Á´ØÂè£</span></span><br><span class="line"><span class="attr">spring.redis.port</span>=<span class="string">6379</span></span><br><span class="line"><span class="comment">#RedisÊï∞ÊçÆÂ∫ìÁ¥¢ÂºïÔºàÈªòËÆ§‰∏∫0Ôºâ</span></span><br><span class="line"><span class="attr">spring.redis.database</span>= <span class="string">0</span></span><br><span class="line"><span class="comment">#ËøûÊé•Ë∂ÖÊó∂Êó∂Èó¥ÔºàÊØ´ÁßíÔºâ</span></span><br><span class="line"><span class="attr">spring.redis.timeout</span>=<span class="string">1800000</span></span><br><span class="line"><span class="comment">#ËøûÊé•Ê±†ÊúÄÂ§ßËøûÊé•Êï∞Ôºà‰ΩøÁî®Ë¥üÂÄºË°®Á§∫Ê≤°ÊúâÈôêÂà∂Ôºâ</span></span><br><span class="line"><span class="attr">spring.redis.lettuce.pool.max-active</span>=<span class="string">20</span></span><br><span class="line"><span class="comment">#ÊúÄÂ§ßÈòªÂ°ûÁ≠âÂæÖÊó∂Èó¥(Ë¥üÊï∞Ë°®Á§∫Ê≤°ÈôêÂà∂)</span></span><br><span class="line"><span class="attr">spring.redis.lettuce.pool.max-wait</span>=<span class="string">-1</span></span><br><span class="line"><span class="comment">#ËøûÊé•Ê±†‰∏≠ÁöÑÊúÄÂ§ßÁ©∫Èó≤ËøûÊé•</span></span><br><span class="line"><span class="attr">spring.redis.lettuce.pool.max-idle</span>=<span class="string">5</span></span><br><span class="line"><span class="comment">#ËøûÊé•Ê±†‰∏≠ÁöÑÊúÄÂ∞èÁ©∫Èó≤ËøûÊé•</span></span><br><span class="line"><span class="attr">spring.redis.lettuce.pool.min-idle</span>=<span class="string">0</span></span><br></pre></td></tr></table></figure>

<p><strong>ÈÖçÁΩÆÁ±ª</strong>Ôºå‰∏ÄËà¨Ëá™ÂÆö‰πâÈÖçÁΩÆ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableCaching</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RedisConfig</span> <span class="keyword">extends</span> <span class="title class_">CachingConfigurerSupport</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> RedisTemplate&lt;String, Object&gt; <span class="title function_">redisTemplate</span><span class="params">(RedisConnectionFactory factory)</span> &#123;</span><br><span class="line">        RedisTemplate&lt;String, Object&gt; template = <span class="keyword">new</span> <span class="title class_">RedisTemplate</span>&lt;&gt;();</span><br><span class="line">        RedisSerializer&lt;String&gt; redisSerializer = <span class="keyword">new</span> <span class="title class_">StringRedisSerializer</span>();</span><br><span class="line">        <span class="type">Jackson2JsonRedisSerializer</span> <span class="variable">jackson2JsonRedisSerializer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Jackson2JsonRedisSerializer</span>(Object.class);</span><br><span class="line">        <span class="type">ObjectMapper</span> <span class="variable">om</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">        om.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);</span><br><span class="line">        om.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL);</span><br><span class="line">        jackson2JsonRedisSerializer.setObjectMapper(om);</span><br><span class="line">        template.setConnectionFactory(factory);</span><br><span class="line">		<span class="comment">//keyÂ∫èÂàóÂåñÊñπÂºè</span></span><br><span class="line">        template.setKeySerializer(redisSerializer);</span><br><span class="line">		<span class="comment">//valueÂ∫èÂàóÂåñ</span></span><br><span class="line">        template.setValueSerializer(jackson2JsonRedisSerializer);</span><br><span class="line">		<span class="comment">//value hashmapÂ∫èÂàóÂåñ</span></span><br><span class="line">        template.setHashValueSerializer(jackson2JsonRedisSerializer);</span><br><span class="line">        <span class="keyword">return</span> template;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> CacheManager <span class="title function_">cacheManager</span><span class="params">(RedisConnectionFactory factory)</span> &#123;</span><br><span class="line">        RedisSerializer&lt;String&gt; redisSerializer = <span class="keyword">new</span> <span class="title class_">StringRedisSerializer</span>();</span><br><span class="line">        <span class="type">Jackson2JsonRedisSerializer</span> <span class="variable">jackson2JsonRedisSerializer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Jackson2JsonRedisSerializer</span>(Object.class);</span><br><span class="line">		<span class="comment">//Ëß£ÂÜ≥Êü•ËØ¢ÁºìÂ≠òËΩ¨Êç¢ÂºÇÂ∏∏ÁöÑÈóÆÈ¢ò</span></span><br><span class="line">        <span class="type">ObjectMapper</span> <span class="variable">om</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">        om.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);</span><br><span class="line">        om.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL);</span><br><span class="line">        jackson2JsonRedisSerializer.setObjectMapper(om);</span><br><span class="line">		<span class="comment">// ÈÖçÁΩÆÂ∫èÂàóÂåñÔºàËß£ÂÜ≥‰π±Á†ÅÁöÑÈóÆÈ¢òÔºâ,ËøáÊúüÊó∂Èó¥600Áßí</span></span><br><span class="line">        <span class="type">RedisCacheConfiguration</span> <span class="variable">config</span> <span class="operator">=</span> RedisCacheConfiguration.defaultCacheConfig()</span><br><span class="line">                .entryTtl(Duration.ofSeconds(<span class="number">600</span>))</span><br><span class="line">                .serializeKeysWith(RedisSerializationContext.SerializationPair.fromSerializer(redisSerializer))</span><br><span class="line">                .serializeValuesWith(RedisSerializationContext.SerializationPair.fromSerializer(jackson2JsonRedisSerializer))</span><br><span class="line">                .disableCachingNullValues();</span><br><span class="line">        <span class="type">RedisCacheManager</span> <span class="variable">cacheManager</span> <span class="operator">=</span> RedisCacheManager.builder(factory)</span><br><span class="line">                .cacheDefaults(config)</span><br><span class="line">                .build();</span><br><span class="line">        <span class="keyword">return</span> cacheManager;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ÁÆÄÂçï‰ΩøÁî®redis</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;redis&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RedisController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate redisTemplate;</span><br><span class="line">    <span class="meta">@GetMapping</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">saveRedis</span><span class="params">()</span>&#123;</span><br><span class="line">        redisTemplate.opsForValue().set(<span class="string">&quot;springboot:redis:name&quot;</span>,<span class="string">&quot;promsing&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> redisTemplate.opsForValue().get(<span class="string">&quot;springboot:redis:name&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;redis‰∏≠Â≠òÂÇ®ÁöÑÂÜÖÂÆπ&quot;</span>+o);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> o.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RunWith(SpringRunner.class)</span></span><br><span class="line"><span class="meta">@SpringBootTest(classes = UserApplication.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RedisTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> StringRedisTemplate redisTemplate;<span class="comment">//Â≠òÂÇ®ÁöÑÊï∞ÊçÆËøõË°å‰∫ÜÂ∫èÂàóÂåñ,Âª∫ËÆÆ‰ΩøÁî®ÂÆÉ</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate redisTemplate2;<span class="comment">//Â≠òÂÇ®ÁöÑÊï∞ÊçÆÊ≤°ÊúâÁªôÂ∫èÂàóÂåñ</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testRedis</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// Â≠òÂÇ®Êï∞ÊçÆ</span></span><br><span class="line">        <span class="built_in">this</span>.redisTemplate.opsForValue().set(<span class="string">&quot;key2&quot;</span>, <span class="string">&quot;value2&quot;</span>);</span><br><span class="line">        <span class="comment">// Ëé∑ÂèñÊï∞ÊçÆ</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">val</span> <span class="operator">=</span> <span class="built_in">this</span>.redisTemplate.opsForValue().get(<span class="string">&quot;key2&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;val = &quot;</span> + val);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testRedis2</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// Â≠òÂÇ®Êï∞ÊçÆÔºåÂπ∂ÊåáÂÆöÂâ©‰ΩôÁîüÂëΩÊó∂Èó¥,5Â∞èÊó∂</span></span><br><span class="line">        <span class="built_in">this</span>.redisTemplate.opsForValue().set(<span class="string">&quot;key2&quot;</span>, <span class="string">&quot;value2&quot;</span>,</span><br><span class="line">                <span class="number">5</span>, TimeUnit.HOURS); </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testHash</span><span class="params">()</span> &#123;</span><br><span class="line">        BoundHashOperations&lt;String, Object, Object&gt; hashOps =</span><br><span class="line">                <span class="built_in">this</span>.redisTemplate.boundHashOps(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">        <span class="comment">// Êìç‰ΩúhashÊï∞ÊçÆ</span></span><br><span class="line">        hashOps.put(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;jack&quot;</span>);</span><br><span class="line">        hashOps.put(<span class="string">&quot;age&quot;</span>, <span class="string">&quot;21&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Ëé∑ÂèñÂçï‰∏™Êï∞ÊçÆ</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">name</span> <span class="operator">=</span> hashOps.get(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;name = &quot;</span> + name);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Ëé∑ÂèñÊâÄÊúâÊï∞ÊçÆ</span></span><br><span class="line">        Map&lt;Object, Object&gt; map = hashOps.entries();</span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;Object, Object&gt; me : map.entrySet()) &#123;</span><br><span class="line">            System.out.println(me.getKey() + <span class="string">&quot; : &quot;</span> + me.getValue());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://docs.spring.io/spring-data/redis/docs/current/api/org/springframework/data/redis/core/RedisTemplate.html">Êõ¥Â§öÊìç‰ΩúAPI</a></p>
<h3 id="7„ÄÅRedis‰∫ãÂä°"><a href="#7„ÄÅRedis‰∫ãÂä°" class="headerlink" title="7„ÄÅRedis‰∫ãÂä°"></a>7„ÄÅRedis‰∫ãÂä°</h3><p>Redis ‰∫ãÂä°ÂèØ‰ª•‰∏ÄÊ¨°ÊâßË°åÂ§ö‰∏™ÂëΩ‰ª§Ôºå Âπ∂‰∏îÂ∏¶Êúâ‰ª•‰∏ã‰∏â‰∏™ÈáçË¶ÅÁöÑ‰øùËØÅÔºö</p>
<ul>
<li>ÊâπÈáèÊìç‰ΩúÂú®ÂèëÈÄÅ EXEC ÂëΩ‰ª§ÂâçË¢´ÊîæÂÖ•ÈòüÂàóÁºìÂ≠ò„ÄÇ</li>
<li>Êî∂Âà∞ EXEC ÂëΩ‰ª§ÂêéËøõÂÖ•‰∫ãÂä°ÊâßË°åÔºå‰∫ãÂä°‰∏≠‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÂ§±Ë¥•ÔºåÂÖ∂‰ΩôÁöÑÂëΩ‰ª§‰æùÁÑ∂Ë¢´ÊâßË°å„ÄÇ</li>
<li>Âú®‰∫ãÂä°ÊâßË°åËøáÁ®ãÔºåÂÖ∂‰ªñÂÆ¢Êà∑Á´ØÊèê‰∫§ÁöÑÂëΩ‰ª§ËØ∑Ê±Ç‰∏ç‰ºöÊèíÂÖ•Âà∞‰∫ãÂä°ÊâßË°åÂëΩ‰ª§Â∫èÂàó‰∏≠„ÄÇ</li>
</ul>
<p>‰∏Ä‰∏™‰∫ãÂä°‰ªéÂºÄÂßãÂà∞ÊâßË°å‰ºöÁªèÂéÜ‰ª•‰∏ã‰∏â‰∏™Èò∂ÊÆµÔºö</p>
<ul>
<li>ÂºÄÂßã‰∫ãÂä°„ÄÇMULTI</li>
<li>ÂëΩ‰ª§ÂÖ•Èòü„ÄÇÁªÑÈòüÈò∂ÊÆµÂá∫Áé∞ÈîôËØØÔºåÊèê‰∫§‰ºöÂ§±Ë¥•</li>
<li>ÊâßË°å‰∫ãÂä°„ÄÇEXEC</li>
</ul>
<p>ÂÆû‰æã</p>
<p>‰ª•‰∏ãÊòØ‰∏Ä‰∏™‰∫ãÂä°ÁöÑ‰æãÂ≠êÔºå ÂÆÉÂÖà‰ª• <strong>MULTI</strong> ÂºÄÂßã‰∏Ä‰∏™‰∫ãÂä°Ôºå ÁÑ∂ÂêéÂ∞ÜÂ§ö‰∏™ÂëΩ‰ª§ÂÖ•ÈòüÂà∞‰∫ãÂä°‰∏≠Ôºå ÊúÄÂêéÁî± <strong>EXEC</strong> ÂëΩ‰ª§Ëß¶Âèë‰∫ãÂä°Ôºå ‰∏ÄÂπ∂ÊâßË°å‰∫ãÂä°‰∏≠ÁöÑÊâÄÊúâÂëΩ‰ª§Ôºö</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">redis 127.0.0.1:6379&gt; MULTI</span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line">redis 127.0.0.1:6379&gt; SET book-name &quot;Mastering C++ in 21 days&quot;</span><br><span class="line">QUEUED</span><br><span class="line"></span><br><span class="line">redis 127.0.0.1:6379&gt; GET book-name</span><br><span class="line">QUEUED</span><br><span class="line"></span><br><span class="line">redis 127.0.0.1:6379&gt; SADD tag &quot;C++&quot; &quot;Programming&quot; &quot;Mastering Series&quot;</span><br><span class="line">QUEUED</span><br><span class="line"></span><br><span class="line">redis 127.0.0.1:6379&gt; SMEMBERS tag</span><br><span class="line">QUEUED</span><br><span class="line"></span><br><span class="line">redis 127.0.0.1:6379&gt; EXEC</span><br><span class="line">1) OK</span><br><span class="line">2) &quot;Mastering C++ in 21 days&quot;</span><br><span class="line">3) (integer) 3</span><br><span class="line">4) 1) &quot;Mastering Series&quot;</span><br><span class="line">   2) &quot;C++&quot;</span><br><span class="line">   3) &quot;Programming&quot;</span><br></pre></td></tr></table></figure>

<p>Âçï‰∏™ Redis ÂëΩ‰ª§ÁöÑÊâßË°åÊòØÂéüÂ≠êÊÄßÁöÑÔºå‰ΩÜ Redis Ê≤°ÊúâÂú®‰∫ãÂä°‰∏äÂ¢ûÂä†‰ªª‰ΩïÁª¥ÊåÅÂéüÂ≠êÊÄßÁöÑÊú∫Âà∂ÔºåÊâÄ‰ª• Redis ‰∫ãÂä°ÁöÑÊâßË°åÂπ∂‰∏çÊòØÂéüÂ≠êÊÄßÁöÑ„ÄÇ</p>
<p>‰∫ãÂä°ÂèØ‰ª•ÁêÜËß£‰∏∫‰∏Ä‰∏™ÊâìÂåÖÁöÑÊâπÈáèÊâßË°åËÑöÊú¨Ôºå‰ΩÜÊâπÈáèÊåá‰ª§Âπ∂ÈùûÂéüÂ≠êÂåñÁöÑÊìç‰ΩúÔºå‰∏≠Èó¥ÊüêÊù°Êåá‰ª§ÁöÑÂ§±Ë¥•‰∏ç‰ºöÂØºËá¥ÂâçÈù¢Â∑≤ÂÅöÊåá‰ª§ÁöÑÂõûÊªöÔºå‰πü‰∏ç‰ºöÈÄ†ÊàêÂêéÁª≠ÁöÑÊåá‰ª§‰∏çÂÅö„ÄÇ</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">redis 127.0.0.1:6379&gt; MULTI</span><br><span class="line">OK</span><br><span class="line">redis 127.0.0.1:6379&gt; SET book-name &quot;Mastering C++ in 21 days&quot;</span><br><span class="line">QUEUED</span><br><span class="line">redis 127.0.0.1:6379&gt; INCR book_name</span><br><span class="line">QUEUED</span><br><span class="line">redis 127.0.0.1:6379&gt; SET K2 V2</span><br><span class="line">QUEUE</span><br><span class="line">redis 127.0.0.1:6379&gt; EXEC</span><br><span class="line">ok</span><br><span class="line">error #‰∏ç‰ºöÂèëÁîüÂõûÊªö</span><br><span class="line">ok</span><br></pre></td></tr></table></figure>

<p>ÁªÑÈòüÂ§±Ë¥•ÁöÑÊÉÖÂÜµ</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">redis 127.0.0.1:6379&gt; MULTI</span><br><span class="line">OK</span><br><span class="line">redis 127.0.0.1:6379&gt; SET book-name &quot;Mastering C++ in 21 days&quot;</span><br><span class="line">QUEUED</span><br><span class="line">redis 127.0.0.1:6379&gt; SET K1 </span><br><span class="line">ERROR</span><br><span class="line">redis 127.0.0.1:6379&gt; SET K2 V2</span><br><span class="line">QUEUE</span><br><span class="line">redis 127.0.0.1:6379&gt; EXEC</span><br><span class="line">ERROR</span><br></pre></td></tr></table></figure>

<p>‰∏ãË°®ÂàóÂá∫‰∫Ü redis ‰∫ãÂä°ÁöÑÁõ∏ÂÖ≥ÂëΩ‰ª§Ôºö</p>
<table>
<thead>
<tr>
<th align="left">Â∫èÂè∑</th>
<th align="left">ÂëΩ‰ª§ÂèäÊèèËø∞</th>
</tr>
</thead>
<tbody><tr>
<td align="left">1</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/transactions-discard.html">DISCARD</a> ÂèñÊ∂à‰∫ãÂä°ÔºåÊîæÂºÉÊâßË°å‰∫ãÂä°ÂùóÂÜÖÁöÑÊâÄÊúâÂëΩ‰ª§„ÄÇ</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/transactions-exec.html">EXEC</a> ÊâßË°åÊâÄÊúâ‰∫ãÂä°ÂùóÂÜÖÁöÑÂëΩ‰ª§„ÄÇ</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/transactions-multi.html">MULTI</a> Ê†áËÆ∞‰∏Ä‰∏™‰∫ãÂä°ÂùóÁöÑÂºÄÂßã„ÄÇ</td>
</tr>
<tr>
<td align="left">4</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/transactions-unwatch.html">UNWATCH</a> ÂèñÊ∂à WATCH ÂëΩ‰ª§ÂØπÊâÄÊúâ key ÁöÑÁõëËßÜ„ÄÇ</td>
</tr>
<tr>
<td align="left">5</td>
<td align="left">WATCH key [key ‚Ä¶]ÁõëËßÜ‰∏Ä‰∏™(ÊàñÂ§ö‰∏™) key ÔºåÂ¶ÇÊûúÂú®‰∫ãÂä°ÊâßË°å‰πãÂâçËøô‰∏™(ÊàñËøô‰∫õ) key Ë¢´ÂÖ∂‰ªñÂëΩ‰ª§ÊâÄÊîπÂä®ÔºåÈÇ£‰πà‰∫ãÂä°Â∞ÜË¢´ÊâìÊñ≠„ÄÇÂä†‰∫Ü‰πêËßÇÈîÅ</td>
</tr>
</tbody></table>
<blockquote>
<p>springbootÊï¥ÂêàredisÁöÑÊó∂ÂÄô‰∏çË¶ÅÂú®‰∫ãÂä°‰∏≠ÂÅöÊü•ËØ¢ÔºåÂõ†‰∏∫‰∏ç‰ºöÈ©¨‰∏äÊúâÁªìÊûú</p>
</blockquote>
<h3 id="8„ÄÅRedisËÑöÊú¨-Lua"><a href="#8„ÄÅRedisËÑöÊú¨-Lua" class="headerlink" title="8„ÄÅRedisËÑöÊú¨(Lua)"></a>8„ÄÅRedisËÑöÊú¨(Lua)</h3><p>Redis ËÑöÊú¨‰ΩøÁî® Lua Ëß£ÈáäÂô®Êù•ÊâßË°åËÑöÊú¨„ÄÇ Redis 2.6 ÁâàÊú¨ÈÄöËøáÂÜÖÂµåÊîØÊåÅ Lua ÁéØÂ¢É„ÄÇÊâßË°åËÑöÊú¨ÁöÑÂ∏∏Áî®ÂëΩ‰ª§‰∏∫ <strong>EVAL</strong>„ÄÇ</p>
<p>ËØ≠Ê≥ï</p>
<p>Eval ÂëΩ‰ª§ÁöÑÂü∫Êú¨ËØ≠Ê≥ïÂ¶Ç‰∏ãÔºö</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis 127.0.0.1:6379&gt; EVAL script numkeys key [key ...] arg [arg ...]</span><br></pre></td></tr></table></figure>

<p>ÂÆû‰æã</p>
<p>‰ª•‰∏ãÂÆû‰æãÊºîÁ§∫‰∫Ü redis ËÑöÊú¨Â∑•‰ΩúËøáÁ®ãÔºö</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">redis 127.0.0.1:6379&gt; EVAL &quot;return &#123;KEYS[1],KEYS[2],ARGV[1],ARGV[2]&#125;&quot; 2 key1 key2 first second</span><br><span class="line"></span><br><span class="line">1) &quot;key1&quot;</span><br><span class="line">2) &quot;key2&quot;</span><br><span class="line">3) &quot;first&quot;</span><br><span class="line">4) &quot;second&quot;</span><br></pre></td></tr></table></figure>

<p>Redis ËÑöÊú¨ÂëΩ‰ª§</p>
<p>‰∏ãË°®ÂàóÂá∫‰∫Ü redis ËÑöÊú¨Â∏∏Áî®ÂëΩ‰ª§Ôºö</p>
<table>
<thead>
<tr>
<th align="left">Â∫èÂè∑</th>
<th align="left">ÂëΩ‰ª§ÂèäÊèèËø∞</th>
</tr>
</thead>
<tbody><tr>
<td align="left">1</td>
<td align="left">[EVAL script numkeys key <a target="_blank" rel="noopener" href="https://www.runoob.com/redis/scripting-eval.html">key ‚Ä¶] arg [arg ‚Ä¶]</a> ÊâßË°å Lua ËÑöÊú¨„ÄÇ</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">[EVALSHA sha1 numkeys key <a target="_blank" rel="noopener" href="https://www.runoob.com/redis/scripting-evalsha.html">key ‚Ä¶] arg [arg ‚Ä¶]</a> ÊâßË°å Lua ËÑöÊú¨„ÄÇ</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">SCRIPT EXISTS script [script ‚Ä¶]Êü•ÁúãÊåáÂÆöÁöÑËÑöÊú¨ÊòØÂê¶Â∑≤ÁªèË¢´‰øùÂ≠òÂú®ÁºìÂ≠òÂΩì‰∏≠„ÄÇ</td>
</tr>
<tr>
<td align="left">4</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/scripting-script-flush.html">SCRIPT FLUSH</a> ‰ªéËÑöÊú¨ÁºìÂ≠ò‰∏≠ÁßªÈô§ÊâÄÊúâËÑöÊú¨„ÄÇ</td>
</tr>
<tr>
<td align="left">5</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/scripting-script-kill.html">SCRIPT KILL</a> ÊùÄÊ≠ªÂΩìÂâçÊ≠£Âú®ËøêË°åÁöÑ Lua ËÑöÊú¨„ÄÇ</td>
</tr>
<tr>
<td align="left">6</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/redis/scripting-script-load.html">SCRIPT LOAD script</a> Â∞ÜËÑöÊú¨ script Ê∑ªÂä†Âà∞ËÑöÊú¨ÁºìÂ≠ò‰∏≠Ôºå‰ΩÜÂπ∂‰∏çÁ´ãÂç≥ÊâßË°åËøô‰∏™ËÑöÊú¨„ÄÇ</td>
</tr>
</tbody></table>
<h3 id="9„ÄÅÊåÅ‰πÖÂåñ"><a href="#9„ÄÅÊåÅ‰πÖÂåñ" class="headerlink" title="9„ÄÅÊåÅ‰πÖÂåñ"></a>9„ÄÅÊåÅ‰πÖÂåñ</h3><h4 id="9-1-AOF"><a href="#9-1-AOF" class="headerlink" title="9.1 AOF"></a>9.1 AOF</h4><p>AOF ÊåÅ‰πÖÂåñËÆ∞ÂΩïÊúçÂä°Âô®ÊâßË°åÁöÑ<strong>ÊâÄÊúâÂÜôÊìç‰ΩúÂëΩ‰ª§</strong>ÔºåÂπ∂Âú®ÊúçÂä°Âô®ÂêØÂä®Êó∂ÔºåÈÄöËøáÈáçÊñ∞ÊâßË°åËøô‰∫õÂëΩ‰ª§Êù•ËøòÂéüÊï∞ÊçÆÈõÜ„ÄÇ AOF Êñá‰ª∂‰∏≠ÁöÑÂëΩ‰ª§ÂÖ®ÈÉ®‰ª• Redis ÂçèËÆÆÁöÑÊ†ºÂºèÊù•‰øùÂ≠òÔºåÊñ∞ÂëΩ‰ª§‰ºöË¢´ËøΩÂä†Âà∞Êñá‰ª∂ÁöÑÊú´Â∞æ„ÄÇAOFÊòØÂÜôÂêéÊó•ÂøóÔºå<strong>‚ÄúÂÜôÂêé‚Äù</strong>ÁöÑÊÑèÊÄùÊòØ Redis ÊòØÂÖàÊâßË°åÂëΩ‰ª§ÔºåÊääÊï∞ÊçÆÂÜôÂÖ•ÂÜÖÂ≠òÔºåÁÑ∂ÂêéÊâçËÆ∞ÂΩïÊó•Âøó,ÂëΩ‰ª§ÊâßË°åÂêéÊâçËÆ∞ÂΩïÊó•ÂøóÔºåÊâÄ‰ª•‰∏ç‰ºöÈòªÂ°ûÂΩìÂâçÁöÑÂÜôÊìç‰Ωú„ÄÇ</p>
<p>Â¶ÇÊûúÂÖàËÆ∞Êó•ÂøóÂÜçÊâßË°åÂëΩ‰ª§ÁöÑËØùÔºåÊó•Âøó‰∏≠Â∞±ÊúâÂèØËÉΩËÆ∞ÂΩï‰∫ÜÈîôËØØÁöÑÂëΩ‰ª§ÔºåRedis Âú®‰ΩøÁî®Êó•ÂøóÊÅ¢Â§çÊï∞ÊçÆÊó∂ÔºåÂ∞±ÂèØËÉΩ‰ºöÂá∫Èîô„ÄÇ</p>
<p>ÂêéÂÜôÈÅøÂÖç‰∫ÜÂØπÂΩìÂâçÂëΩ‰ª§ÁöÑÈòªÂ°ûÔºå‰ΩÜÂèØËÉΩ‰ºö<code>Áªô‰∏ã‰∏Ä‰∏™Êìç‰ΩúÂ∏¶Êù•ÈòªÂ°ûÈ£éÈô©</code>„ÄÇËøôÊòØÂõ†‰∏∫Ôºå<strong>AOF Êó•Âøó‰πüÊòØÂú®‰∏ªÁ∫øÁ®ã‰∏≠ÊâßË°åÁöÑ</strong>ÔºåÂ¶ÇÊûúÂú®ÊääÊó•ÂøóÊñá‰ª∂ÂÜôÂÖ•Á£ÅÁõòÊó∂ÔºåÁ£ÅÁõòÂÜôÂéãÂäõÂ§ßÔºåÂ∞±‰ºöÂØºËá¥ÂÜôÁõòÂæàÊÖ¢ÔºåËøõËÄåÂØºËá¥ÂêéÁª≠ÁöÑÊìç‰Ωú‰πüÊó†Ê≥ïÊâßË°å‰∫Ü„ÄÇ</p>
<p><code>Redis ËøòÂèØ‰ª•Âú®ÂêéÂè∞ÂØπ AOF Êñá‰ª∂ËøõË°åÈáçÂÜôÔºàrewriteÔºâ</code>Ôºå‰ΩøÂæó AOF Êñá‰ª∂ÁöÑ‰ΩìÁßØ‰∏ç‰ºöË∂ÖÂá∫‰øùÂ≠òÊï∞ÊçÆÈõÜÁä∂ÊÄÅÊâÄÈúÄÁöÑÂÆûÈôÖÂ§ßÂ∞è„ÄÇ</p>
<p>Redis ËøòÂèØ‰ª•ÂêåÊó∂‰ΩøÁî® AOF ÊåÅ‰πÖÂåñÂíå RDB ÊåÅ‰πÖÂåñ„ÄÇ Âú®ËøôÁßçÊÉÖÂÜµ‰∏ãÔºå ÂΩì Redis ÈáçÂêØÊó∂Ôºå ÂÆÉ‰ºö<strong>‰ºòÂÖà‰ΩøÁî® AOF Êñá‰ª∂Êù•ËøòÂéüÊï∞ÊçÆÈõÜ</strong>Ôºå Âõ†‰∏∫ AOF Êñá‰ª∂‰øùÂ≠òÁöÑÊï∞ÊçÆÈõÜÈÄöÂ∏∏ÊØî RDB Êñá‰ª∂ÊâÄ‰øùÂ≠òÁöÑÊï∞ÊçÆÈõÜÊõ¥ÂÆåÊï¥„ÄÇ‰Ω†ÁîöËá≥ÂèØ‰ª•ÂÖ≥Èó≠ÊåÅ‰πÖÂåñÂäüËÉΩÔºåËÆ©Êï∞ÊçÆÂè™Âú®ÊúçÂä°Âô®ËøêË°åÊó∂Â≠òÂú®„ÄÇ</p>
<p>‰Ω†ÂèØ‰ª•ÈÄöËøá‰øÆÊîπÈÖçÁΩÆÊñá‰ª∂Êù•ÊâìÂºÄ AOF ÂäüËÉΩÔºö</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">appendonly yes</span><br></pre></td></tr></table></figure>

<p><strong>Êó•ÂøóÈáçÂÜô</strong></p>
<p>‰Ω†ÂèØ‰ª•ÁåúÂæóÂà∞ÔºåÂÜôÊìç‰Ωú‰∏çÊñ≠ÊâßË°åÁöÑÊó∂ÂÄôAOFÊñá‰ª∂‰ºöË∂äÊù•Ë∂äÂ§ß„ÄÇ‰æãÂ¶ÇÔºåÂ¶ÇÊûú‰Ω†Â¢ûÂä†‰∏Ä‰∏™ËÆ°Êï∞Âô®100Ê¨°Ôºå‰Ω†ÁöÑÊï∞ÊçÆÈõÜÈáåÂè™‰ºöÊúâ‰∏Ä‰∏™ÈîÆÂ≠òÂÇ®ËøôÊúÄÁªàÂÄºÔºå‰ΩÜÊòØÂç¥Êúâ100Êù°ËÆ∞ÂΩïÂú®AOF‰∏≠„ÄÇÂÖ∂‰∏≠99Êù°ËÆ∞ÂΩïÂú®ÈáçÂª∫ÂΩìÂâçÁä∂ÊÄÅÊó∂ÊòØ‰∏çÈúÄË¶ÅÁöÑ„ÄÇ</p>
<p>‰∫éÊòØRedisÊîØÊåÅ‰∏Ä‰∏™ÊúâË∂£ÁöÑÁâπÊÄßÔºöÂú®ÂêéÂè∞ÈáçÂª∫AOFËÄå‰∏çÂΩ±ÂìçÊúçÂä°ÂÆ¢Êà∑Á´Ø„ÄÇÊØèÂΩì‰Ω†ÂèëÈÄÅBGREWRITEAOFÊó∂ÔºåRedisÂ∞Ü‰ºöÂÜôÂÖ•‰∏Ä‰∏™Êñ∞ÁöÑAOFÊñá‰ª∂ÔºåÂåÖÂê´ÈáçÂª∫ÂΩìÂâçÂÜÖÂ≠ò‰∏≠Êï∞ÊçÆÈõÜÊâÄÈúÄÁöÑÊúÄÁü≠ÂëΩ‰ª§Â∫èÂàó„ÄÇÂ¶ÇÊûú‰Ω†‰ΩøÁî®ÁöÑÊòØRedis 2.2ÁöÑAOFÔºå‰Ω†ÈúÄË¶Å‰∏çÊó∂ÁöÑËøêË°å<code>BGREWRITEAOF</code>ÂëΩ‰ª§„ÄÇRedis 2.4ÂèØ‰ª•Ëá™Âä®Ëß¶ÂèëÊó•ÂøóÈáçÂÜô(Êü•ÁúãRedis 2.4‰∏≠ÁöÑÁ§∫‰æãÈÖçÁΩÆÊñá‰ª∂‰ª•Ëé∑ÂæóÊõ¥Â§ö‰ø°ÊÅØ)„ÄÇ</p>
<p>Redis‰ºöËÆ∞ÂΩï‰∏äÊ¨°ÈáçÂÜôÊó∂ÁöÑAOFÂ§ßÂ∞èÔºåÈªòËÆ§ÈÖçÁΩÆÊòØÂΩìAOFÊñá‰ª∂Â§ßÂ∞èÊòØ‰∏äÊ¨°rewriteÂêéÂ§ßÂ∞èÁöÑ‰∏ÄÂÄç‰∏îÊñá‰ª∂Â§ß‰∫é64MÊó∂Ëß¶Âèë</p>
<p><strong>AOF3ÁßçÂÜôÁõòÁ≠ñÁï•</strong></p>
<p>‰Ω†ÂèØ‰ª•ÈÖçÁΩÆ Redis Â§ö‰πÖÊâçÂ∞ÜÊï∞ÊçÆ fsync Âà∞Á£ÅÁõò‰∏ÄÊ¨°„ÄÇÊúâ‰∏â‰∏™ÈÄâÈ°πÔºö</p>
<ul>
<li>ÊØèÊ¨°ÊúâÊñ∞ÂëΩ‰ª§ËøΩÂä†Âà∞ AOF Êñá‰ª∂Êó∂Â∞±ÊâßË°å‰∏ÄÊ¨° fsync ÔºöÈùûÂ∏∏ÊÖ¢Ôºå‰πüÈùûÂ∏∏ÂÆâÂÖ®„ÄÇ</li>
<li>ÊØèÁßí fsync ‰∏ÄÊ¨°ÔºöË∂≥Â§üÂø´ÔºàÂíå‰ΩøÁî® RDB ÊåÅ‰πÖÂåñÂ∑Æ‰∏çÂ§öÔºâÔºåÂπ∂‰∏îÂú®ÊïÖÈöúÊó∂Âè™‰ºö<code>‰∏¢Â§± 1 ÁßíÈíü</code>ÁöÑÊï∞ÊçÆ„ÄÇ</li>
<li>‰ªé‰∏ç fsync ÔºöÂ∞ÜÊï∞ÊçÆ‰∫§ÁªôÊìç‰ΩúÁ≥ªÁªüÊù•Â§ÑÁêÜ„ÄÇÊõ¥Âø´Ôºå‰πüÊõ¥‰∏çÂÆâÂÖ®ÁöÑÈÄâÊã©„ÄÇ</li>
</ul>
<p>Êé®ËçêÔºàÂπ∂‰∏î‰πüÊòØÈªòËÆ§ÔºâÁöÑÊé™ÊñΩ‰∏∫ÊØèÁßí fsync ‰∏ÄÊ¨°Ôºå ËøôÁßç fsync Á≠ñÁï•ÂèØ‰ª•ÂÖºÈ°æÈÄüÂ∫¶ÂíåÂÆâÂÖ®ÊÄß„ÄÇ ÊÄªÊòØ fsync ÁöÑÁ≠ñÁï•Âú®ÂÆûÈôÖ‰ΩøÁî®‰∏≠ÈùûÂ∏∏ÊÖ¢Ôºå Âç≥‰ΩøÂú® Redis 2.0 ÂØπÁõ∏ÂÖ≥ÁöÑÁ®ãÂ∫èËøõË°å‰∫ÜÊîπËøõ‰πãÂêé‰ªçÊòØÂ¶ÇÊ≠§ ‚Äî‚Äî È¢ëÁπÅË∞ÉÁî® fsync Ê≥®ÂÆö‰∫ÜËøôÁßçÁ≠ñÁï•‰∏çÂèØËÉΩÂø´ÂæóËµ∑Êù•„ÄÇ</p>
<p>ÂΩì‰ΩøÁî®AlwaysÁ≠ñÁï•Êó∂Ôºå‰∏ªÁ∫øÁ®ãÊâßË°åÂÆåÂëΩ‰ª§‰πãÂêéÔºå‰ºöË∞ÉÁî®fsync()ÂáΩÊï∞ÔºåÊääÁºìÂÜ≤Âå∫ÁöÑÊï∞ÊçÆÂÜôÂÖ•Âà∞Á°¨ÁõòÁöÑaofÊñá‰ª∂ÔºåÁ≠âÂà∞Á°¨ÁõòÊìç‰ΩúÂæÄ‰πãÂêéÂáΩÊï∞Êâç‰ºöËøîÂõûÔºåÂ¶ÇÊûúÂÜôÂÖ•ÁöÑÊòØ‰∏Ä‰∏™Â§ßkeyÔºå‰∏ªÁ∫øÁ®ãÂú®ÊâßË°åfsync()ÁöÑÊó∂ÂÄôÂ∞±‰ºöË¢´ÈòªÂ°ûÊØîËæÉ‰πÖ„ÄÇ</p>
<blockquote>
<p>Â§ßkeyÊòØÊåákeyÂØπÂ∫îÁöÑvalueÂæàÂ§ß</p>
<p>ÂØπ‰∫éstringÁ±ªÂûã ÂÄº&gt;10kb</p>
<p>hash list,set, zset Á±ªÂûãÁöÑÂÖÉÁ¥†‰∏™Êï∞Ë∂ÖÈ´ò5000‰∏™</p>
</blockquote>
<p><strong>Â¶ÇÊûú AOF Êñá‰ª∂Âá∫Èîô‰∫ÜÔºåÊÄé‰πàÂäûÔºü</strong></p>
<p>ÊúçÂä°Âô®ÂèØËÉΩÂú®Á®ãÂ∫èÊ≠£Âú®ÂØπ AOF Êñá‰ª∂ËøõË°åÂÜôÂÖ•Êó∂Â¥©Ê∫ÉÔºàËøô‰∏™‰∏çÂ∫îËØ•Á†¥ÂùèÊï∞ÊçÆÁöÑ‰∏ÄËá¥ÊÄßÔºâÔºå Redis‰∏ç‰ºöË£ÖËΩΩÂ∑≤Á†¥ÂùèÁöÑAOFÊñá‰ª∂„ÄÇÂΩìÂèëÁîüËøôÁßçÊÉÖÂÜµÊó∂Ôºå ÂèØ‰ª•Áî®‰ª•‰∏ãÊñπÊ≥ïÊù•‰øÆÂ§çÂá∫ÈîôÁöÑ AOF Êñá‰ª∂Ôºö</p>
<ul>
<li>‰∏∫Áé∞ÊúâÁöÑ AOF Êñá‰ª∂ÂàõÂª∫‰∏Ä‰∏™Â§á‰ªΩ„ÄÇ</li>
<li>‰ΩøÁî® Redis ÈôÑÂ∏¶ÁöÑ redis-check-aof Á®ãÂ∫èÔºåÂØπÂéüÊù•ÁöÑ AOF Êñá‰ª∂ËøõË°å‰øÆÂ§ç„ÄÇ</li>
<li>$ redis-check-aof ‚Äìfix</li>
<li>ÔºàÂèØÈÄâÔºâ‰ΩøÁî® diff -u ÂØπÊØî‰øÆÂ§çÂêéÁöÑ AOF Êñá‰ª∂ÂíåÂéüÂßã AOF Êñá‰ª∂ÁöÑÂ§á‰ªΩÔºåÊü•Áúã‰∏§‰∏™Êñá‰ª∂‰πãÈó¥ÁöÑ‰∏çÂêå‰πãÂ§Ñ„ÄÇ</li>
<li>ÈáçÂêØ Redis ÊúçÂä°Âô®ÔºåÁ≠âÂæÖÊúçÂä°Âô®ËΩΩÂÖ•‰øÆÂ§çÂêéÁöÑ AOF Êñá‰ª∂ÔºåÂπ∂ËøõË°åÊï∞ÊçÆÊÅ¢Â§ç„ÄÇ</li>
</ul>
<p><strong>ÈáçÂÜôÂ¶Ç‰ΩïÂ∑•‰Ωú</strong></p>
<p>Êó•ÂøóÈáçÂÜôÈááÁî®‰∫ÜÂíåÂø´ÁÖß‰∏ÄÊ†∑ÁöÑÂÜôÊó∂Â§çÂà∂Êú∫Âà∂„ÄÇ‰∏ãÈù¢ÊòØËøáÁ®ãÔºö</p>
<ul>
<li>RedisË∞ÉÁî®fork()„ÄÇ‰∫éÊòØÊàë‰ª¨Êúâ‰∫ÜÁà∂Â≠ê‰∏§‰∏™ËøõÁ®ã„ÄÇ</li>
<li>Â≠êËøõÁ®ãÂºÄÂßãÂêë‰∏Ä‰∏™‰∏¥Êó∂Êñá‰ª∂‰∏≠ÂÜôAOF„ÄÇ</li>
<li>Áà∂ËøõÁ®ãÂú®‰∏Ä‰∏™ÂÜÖÂ≠òÁºìÂÜ≤Âå∫‰∏≠ÁßØÁ¥ØÊñ∞ÁöÑÂèòÊõ¥(ÂêåÊó∂Â∞ÜÊñ∞ÁöÑÂèòÊõ¥ÂÜôÂÖ•ÊóßÁöÑAOFÊñá‰ª∂ÔºåÊâÄ‰ª•Âç≥‰ΩøÈáçÂÜôÂ§±Ë¥•Êàë‰ª¨‰πüÂÆâÂÖ®)„ÄÇ</li>
<li>ÂΩìÂ≠êËøõÁ®ãÂÆåÊàêÈáçÂÜôÊñá‰ª∂ÔºåÁà∂ËøõÁ®ãÊî∂Âà∞‰∏Ä‰∏™‰ø°Âè∑ÔºåËøΩÂä†ÂÜÖÂ≠òÁºìÂÜ≤Âå∫Âà∞Â≠êËøõÁ®ãÂàõÂª∫ÁöÑÊñá‰ª∂Êú´Â∞æ„ÄÇ</li>
<li>ÊêûÂÆöÔºÅÁé∞Âú®RedisÂéüÂ≠êÊÄßÂú∞ÈáçÂëΩÂêçÊóßÊñá‰ª∂‰∏∫Êñ∞ÁöÑÔºåÁÑ∂ÂêéÂºÄÂßãËøΩÂä†Êñ∞Êï∞ÊçÆÂà∞Êñ∞Êñá‰ª∂„ÄÇ</li>
</ul>
<p>AOFÈáçÂÜôÊòØÈùûÈòªÂ°ûÁöÑÔºåÂíå AOF Êó•ÂøóÁî±‰∏ªÁ∫øÁ®ãÂÜôÂõû‰∏çÂêåÔºåÈáçÂÜôËøáÁ®ãÊòØÁî±ÂêéÂè∞Á∫øÁ®ã bgrewriteaof Êù•ÂÆåÊàêÁöÑÔºåËøô‰πüÊòØ‰∏∫‰∫ÜÈÅøÂÖçÈòªÂ°û‰∏ªÁ∫øÁ®ãÔºåÂØºËá¥Êï∞ÊçÆÂ∫ìÊÄßËÉΩ‰∏ãÈôç„ÄÇ</p>
<p>ÊàëÊääÈáçÂÜôÁöÑËøáÁ®ãÊÄªÁªì‰∏∫<strong>‚Äú‰∏Ä‰∏™Êã∑Ë¥ùÔºå‰∏§Â§ÑÊó•Âøó‚Äù</strong>„ÄÇ</p>
<p>‚Äú‰∏Ä‰∏™Êã∑Ë¥ù‚ÄùÂ∞±ÊòØÊåáÔºåÊØèÊ¨°ÊâßË°åÈáçÂÜôÊó∂Ôºå‰∏ªÁ∫øÁ®ã fork Âá∫ÂêéÂè∞ÁöÑ bgrewriteaof Â≠êËøõÁ®ã„ÄÇÊ≠§Êó∂Ôºåfork ‰ºöÊää‰∏ªÁ∫øÁ®ãÁöÑÂÜÖÂ≠òÊã∑Ë¥ù‰∏Ä‰ªΩÁªô bgrewriteaof Â≠êËøõÁ®ãÔºåËøôÈáåÈù¢Â∞±ÂåÖÂê´‰∫ÜÊï∞ÊçÆÂ∫ìÁöÑÊúÄÊñ∞Êï∞ÊçÆ„ÄÇÁÑ∂ÂêéÔºåbgrewriteaof Â≠êËøõÁ®ãÂ∞±ÂèØ‰ª•Âú®‰∏çÂΩ±Âìç‰∏ªÁ∫øÁ®ãÁöÑÊÉÖÂÜµ‰∏ãÔºåÈÄê‰∏ÄÊääÊã∑Ë¥ùÁöÑÊï∞ÊçÆÂÜôÊàêÊìç‰ΩúÔºåËÆ∞ÂÖ•ÈáçÂÜôÊó•Âøó„ÄÇ</p>
<p>‚Äú‰∏§Â§ÑÊó•Âøó‚ÄùÂèàÊòØ‰ªÄ‰πàÂë¢Ôºü</p>
<p>Âõ†‰∏∫‰∏ªÁ∫øÁ®ãÊú™ÈòªÂ°ûÔºå‰ªçÁÑ∂ÂèØ‰ª•Â§ÑÁêÜÊñ∞Êù•ÁöÑÊìç‰Ωú„ÄÇÊ≠§Êó∂ÔºåÂ¶ÇÊûúÊúâÂÜôÊìç‰ΩúÔºåÁ¨¨‰∏ÄÂ§ÑÊó•ÂøóÂ∞±ÊòØÊåáÊ≠£Âú®‰ΩøÁî®ÁöÑ AOF Êó•ÂøóÔºåRedis ‰ºöÊääËøô‰∏™Êìç‰ΩúÂÜôÂà∞ÂÆÉÁöÑÁºìÂÜ≤Âå∫„ÄÇËøôÊ†∑‰∏ÄÊù•ÔºåÂç≥‰ΩøÂÆïÊú∫‰∫ÜÔºåËøô‰∏™ AOF Êó•ÂøóÁöÑÊìç‰Ωú‰ªçÁÑ∂ÊòØÈΩêÂÖ®ÁöÑÔºåÂèØ‰ª•Áî®‰∫éÊÅ¢Â§ç„ÄÇ</p>
<p>ËÄåÁ¨¨‰∫åÂ§ÑÊó•ÂøóÔºåÂ∞±ÊòØÊåáÊñ∞ÁöÑ AOF ÈáçÂÜôÊó•Âøó„ÄÇËøô‰∏™Êìç‰Ωú‰πü‰ºöË¢´ÂÜôÂà∞ÈáçÂÜôÊó•ÂøóÁöÑÁºìÂÜ≤Âå∫„ÄÇËøôÊ†∑ÔºåÈáçÂÜôÊó•Âøó‰πü‰∏ç‰ºö‰∏¢Â§±ÊúÄÊñ∞ÁöÑÊìç‰Ωú„ÄÇÁ≠âÂà∞Êã∑Ë¥ùÊï∞ÊçÆÁöÑÊâÄÊúâÊìç‰ΩúËÆ∞ÂΩïÈáçÂÜôÂÆåÊàêÂêéÔºåÈáçÂÜôÊó•ÂøóËÆ∞ÂΩïÁöÑËøô‰∫õÊúÄÊñ∞Êìç‰Ωú‰πü‰ºöÂÜôÂÖ•Êñ∞ÁöÑ AOF Êñá‰ª∂Ôºå‰ª•‰øùËØÅÊï∞ÊçÆÂ∫ìÊúÄÊñ∞Áä∂ÊÄÅÁöÑËÆ∞ÂΩï„ÄÇÊ≠§Êó∂ÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•Áî®Êñ∞ÁöÑ AOF Êñá‰ª∂Êõø‰ª£ÊóßÊñá‰ª∂‰∫Ü„ÄÇ</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://fastly.jsdelivr.net/gh/YuChaoM/images/OS/image-20220912153729399.png" alt="image-20220912153729399"></p>
<p><strong>AOF ÁöÑ‰ºòÁÇπ:</strong></p>
<ul>
<li>‰ΩøÁî®AOF Redis‰ºöÊõ¥ÂÖ∑ÊúâÂèØÊåÅ‰πÖÊÄß(durable)Ôºö‰Ω†ÂèØ‰ª•ÊúâÂæàÂ§ö‰∏çÂêåÁöÑfsyncÁ≠ñÁï•ÔºöÊ≤°ÊúâfsyncÔºåÊØèÁßífsyncÔºåÊØèÊ¨°ËØ∑Ê±ÇÊó∂fsync„ÄÇ‰ΩøÁî®<strong>ÈªòËÆ§ÁöÑÊØèÁßífsync</strong>Á≠ñÁï•ÔºåÂÜôÊÄßËÉΩ‰πü‰ªçÁÑ∂Âæà‰∏çÈîô(fsyncÊòØÁî±ÂêéÂè∞Á∫øÁ®ãÂÆåÊàêÁöÑÔºå‰∏ªÁ∫øÁ®ãÁªßÁª≠Âä™ÂäõÂú∞ÊâßË°åÂÜôËØ∑Ê±Ç)ÔºåÂç≥‰æø‰Ω†‰πüÂ∞±‰ªÖ‰ªÖÂè™ÊçüÂ§±‰∏ÄÁßíÈíüÁöÑÂÜôÊï∞ÊçÆ„ÄÇ</li>
<li>AOFÊó•ÂøóÊòØ‰∏Ä‰∏™ËøΩÂä†Êñá‰ª∂ÔºåÊâÄ‰ª•‰∏çÈúÄË¶ÅÂÆö‰ΩçÔºåÂú®Êñ≠ÁîµÊó∂‰πüÊ≤°ÊúâÊçüÂùèÈóÆÈ¢ò„ÄÇÂç≥‰ΩøÁî±‰∫éÊüêÁßçÂéüÂõ†Êñá‰ª∂Êú´Â∞æÊòØ‰∏Ä‰∏™ÂÜôÂà∞‰∏ÄÂçäÁöÑÂëΩ‰ª§(Á£ÅÁõòÊª°ÊàñËÄÖÂÖ∂‰ªñÂéüÂõ†),redis-check-aofÂ∑•ÂÖ∑‰πüÂèØ‰ª•ÂæàËΩªÊòìÁöÑ‰øÆÂ§ç„ÄÇ</li>
<li>ÂΩìAOFÊñá‰ª∂ÂèòÂæóÂæàÂ§ßÊó∂ÔºåRedis‰ºöËá™Âä®Âú®ÂêéÂè∞ËøõË°åÈáçÂÜô„ÄÇÈáçÂÜôÊòØÁªùÂØπÂÆâÂÖ®ÁöÑÔºåÂõ†‰∏∫RedisÁªßÁª≠ÂæÄÊóßÁöÑÊñá‰ª∂‰∏≠ËøΩÂä†Ôºå‰ΩøÁî®ÂàõÂª∫ÂΩìÂâçÊï∞ÊçÆÈõÜÊâÄÈúÄÁöÑÊúÄÂ∞èÊìç‰ΩúÈõÜÂêàÊù•ÂàõÂª∫‰∏Ä‰∏™ÂÖ®Êñ∞ÁöÑÊñá‰ª∂Ôºå‰∏ÄÊó¶Á¨¨‰∫å‰∏™Êñá‰ª∂ÂàõÂª∫ÂÆåÊØïÔºåRedisÂ∞±‰ºöÂàáÊç¢Ëøô‰∏§‰∏™Êñá‰ª∂ÔºåÂπ∂ÂºÄÂßãÂæÄÊñ∞Êñá‰ª∂ËøΩÂä†„ÄÇ</li>
<li>AOFÊñá‰ª∂ÈáåÈù¢ÂåÖÂê´‰∏Ä‰∏™Êé•‰∏Ä‰∏™ÁöÑÊìç‰ΩúÔºå‰ª•Êòì‰∫éÁêÜËß£ÂíåËß£ÊûêÁöÑÊ†ºÂºèÂ≠òÂÇ®„ÄÇ‰Ω†‰πüÂèØ‰ª•ËΩªÊòìÁöÑÂØºÂá∫‰∏Ä‰∏™AOFÊñá‰ª∂„ÄÇ‰æãÂ¶ÇÔºåÂç≥‰Ωø‰Ω†‰∏çÂ∞èÂøÉÈîôËØØÂú∞‰ΩøÁî®FLUSHALLÂëΩ‰ª§Ê∏ÖÁ©∫‰∏ÄÂàáÔºåÂ¶ÇÊûúÊ≠§Êó∂Âπ∂Ê≤°ÊúâÊâßË°åÈáçÂÜôÔºå‰Ω†‰ªçÁÑ∂ÂèØ‰ª•‰øùÂ≠ò‰Ω†ÁöÑÊï∞ÊçÆÈõÜÔºå‰Ω†Âè™Ë¶ÅÂÅúÊ≠¢ÊúçÂä°Âô®ÔºåÂà†Èô§ÊúÄÂêé‰∏ÄÊù°ÂëΩ‰ª§ÔºåÁÑ∂ÂêéÈáçÂêØRedisÂ∞±ÂèØ‰ª•„ÄÇ</li>
</ul>
<p><strong>AOF ÁöÑÁº∫ÁÇπ:</strong></p>
<ul>
<li>ÂØπÂêåÊ†∑ÁöÑÊï∞ÊçÆÈõÜÔºåAOFÊñá‰ª∂ÈÄöÂ∏∏Ë¶ÅÂ§ß‰∫éÁ≠â‰ª∑ÁöÑRDBÊñá‰ª∂„ÄÇ</li>
<li>AOFÂèØËÉΩÊØîRDBÊÖ¢ÔºåËøôÂèñÂÜ≥‰∫éÂáÜÁ°ÆÁöÑfsyncÁ≠ñÁï•„ÄÇÈÄöÂ∏∏fsyncËÆæÁΩÆ‰∏∫ÊØèÁßí‰∏ÄÊ¨°ÁöÑËØùÊÄßËÉΩ‰ªçÁÑ∂ÂæàÈ´òÔºåÂ¶ÇÊûúÂÖ≥Èó≠fsyncÔºåÂç≥‰ΩøÂú®ÂæàÈ´òÁöÑË¥üËΩΩ‰∏ã‰πüÂíåRDB‰∏ÄÊ†∑ÁöÑÂø´„ÄÇ‰∏çËøáÔºåÂç≥‰ΩøÂú®ÂæàÂ§ßÁöÑÂÜôË¥üËΩΩÊÉÖÂÜµ‰∏ãÔºåRDBËøòÊòØËÉΩÊèê‰æõËÉΩÂ•ΩÁöÑÊúÄÂ§ßÂª∂Ëøü‰øùËØÅ„ÄÇ</li>
<li>Âú®ËøáÂéªÔºåÊàë‰ª¨ÁªèÂéÜ‰∫Ü‰∏Ä‰∫õÈíàÂØπÁâπÊÆäÂëΩ‰ª§(‰æãÂ¶ÇÔºåÂÉèBRPOPLPUSHËøôÊ†∑ÁöÑÈòªÂ°ûÂëΩ‰ª§)ÁöÑÁΩïËßÅbugÔºåÂØºËá¥Âú®Êï∞ÊçÆÂä†ËΩΩÊó∂Êó†Ê≥ïÊÅ¢Â§çÂà∞‰øùÂ≠òÊó∂ÁöÑÊ†∑Â≠ê„ÄÇËøô‰∫õbugÂæàÁΩïËßÅÔºåÊàë‰ª¨‰πüÂú®ÊµãËØïÂ•ó‰ª∂‰∏≠ËøõË°å‰∫ÜÊµãËØïÔºåËá™Âä®ÈöèÊú∫ÂàõÈÄ†Â§çÊùÇÁöÑÊï∞ÊçÆÈõÜÔºåÁÑ∂ÂêéÂä†ËΩΩÂÆÉ‰ª¨‰ª•Ê£ÄÊü•‰∏ÄÂàáÊòØÂê¶Ê≠£Â∏∏Ôºå‰ΩÜÊòØÔºåËøôÁ±ªbugÂá†‰πé‰∏çÂèØËÉΩÂá∫Áé∞Âú®RDBÊåÅ‰πÖÂåñ‰∏≠„ÄÇ‰∏∫‰∫ÜËØ¥ÂæóÊõ¥Ê∏ÖÊ•ö‰∏ÄÁÇπÔºöRedis AOFÊòØÈÄöËøáÈÄíÂ¢ûÂú∞Êõ¥Êñ∞‰∏Ä‰∏™Â∑≤ÁªèÂ≠òÂú®ÁöÑÁä∂ÊÄÅÔºåÂÉèMySQLÊàñËÄÖMongoDB‰∏ÄÊ†∑ÔºåËÄåRDBÂø´ÁÖßÊòØ‰∏ÄÊ¨°Âèà‰∏ÄÊ¨°Âú∞‰ªéÂ§¥ÂºÄÂßãÂàõÈÄ†‰∏ÄÂàáÔºåÊ¶ÇÂøµ‰∏äÊõ¥ÂÅ•Â£Æ„ÄÇ‰ΩÜÊòØÔºå1)Ë¶ÅÊ≥®ÊÑèRedisÊØèÊ¨°ÈáçÂÜôAOFÊó∂ÈÉΩÊòØ‰ª•ÂΩìÂâçÊï∞ÊçÆÈõÜ‰∏≠ÁöÑÁúüÂÆûÊï∞ÊçÆ‰ªéÂ§¥ÂºÄÂßãÔºåÁõ∏ÂØπ‰∫é‰∏ÄÁõ¥ËøΩÂä†ÁöÑAOFÊñá‰ª∂(ÊàñËÄÖ‰∏ÄÊ¨°ÈáçÂÜôËØªÂèñËÄÅÁöÑAOFÊñá‰ª∂ËÄå‰∏çÊòØËØªÂÜÖÂ≠ò‰∏≠ÁöÑÊï∞ÊçÆ)ÂØπbugÁöÑÂÖçÁñ´ÂäõÊõ¥Âº∫„ÄÇ2)Êàë‰ª¨ËøòÊ≤°ÊúâÊî∂Âà∞‰∏Ä‰ªΩÁî®Êà∑Âú®ÁúüÂÆû‰∏ñÁïå‰∏≠Ê£ÄÊµãÂà∞Â¥©Ê∫ÉÁöÑÊä•Âëä„ÄÇ</li>
</ul>
<h4 id="9-2-RDB-Âø´ÁÖß"><a href="#9-2-RDB-Âø´ÁÖß" class="headerlink" title="9.2 RDB Âø´ÁÖß"></a>9.2 RDB Âø´ÁÖß</h4><p>AOF ÊñπÊ≥ïËøõË°åÊïÖÈöúÊÅ¢Â§çÁöÑÊó∂ÂÄôÔºåÈúÄË¶ÅÈÄê‰∏ÄÊääÊìç‰ΩúÊó•ÂøóÈÉΩÊâßË°å‰∏ÄÈÅç„ÄÇÂ¶ÇÊûúÊìç‰ΩúÊó•ÂøóÈùûÂ∏∏Â§öÔºåRedis Â∞±‰ºöÊÅ¢Â§çÂæóÂæàÁºìÊÖ¢ÔºåÂΩ±ÂìçÂà∞Ê≠£Â∏∏‰ΩøÁî®„ÄÇËøôÂΩìÁÑ∂‰∏çÊòØÁêÜÊÉ≥ÁöÑÁªìÊûú„ÄÇ<code>RDBÂèØ‰ª•Âú®ÂÆïÊú∫Êó∂ÂÆûÁé∞Âø´ÈÄüÊÅ¢Â§ç</code></p>
<p>RDB ÊåÅ‰πÖÂåñÂèØ‰ª•Âú®ÊåáÂÆöÁöÑÊó∂Èó¥Èó¥ÈöîÂÜÖÁîüÊàêÊï∞ÊçÆÈõÜÁöÑÊó∂Èó¥ÁÇπÂø´ÁÖßÔºàpoint-in-time snapshotÔºâ</p>
<p>ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåRedis‰øùÂ≠òÊï∞ÊçÆÈõÜÂø´ÁÖßÂà∞Á£ÅÁõòÔºåÂêç‰∏∫dump.rdbÁöÑ‰∫åËøõÂà∂Êñá‰ª∂„ÄÇ‰Ω†ÂèØ‰ª•ËÆæÁΩÆËÆ©RedisÂú®NÁßíÂÜÖËá≥Â∞ëÊúâMÊ¨°Êï∞ÊçÆÈõÜÊîπÂä®Êó∂‰øùÂ≠òÊï∞ÊçÆÈõÜÔºåÊàñËÄÖ‰Ω†‰πüÂèØ‰ª•<strong>ÊâãÂä®Ë∞ÉÁî®SAVEÊàñËÄÖBGSAVEÂëΩ‰ª§</strong>„ÄÇ</p>
<p>‰æãÂ¶ÇÔºåËøô‰∏™ÈÖçÁΩÆ‰ºöËÆ©RedisÂú®ÊØè‰∏™60ÁßíÂÜÖËá≥Â∞ëÊúâ1000Ê¨°ÈîÆÊîπÂä®Êó∂Ëá™Âä®ËΩ¨ÂÇ®Êï∞ÊçÆÈõÜÂà∞Á£ÅÁõòÔºö</p>
<blockquote>
<p>save 60 1000</p>
</blockquote>
<p>ËøôÁßçÁ≠ñÁï•Ë¢´Áß∞‰∏∫Âø´ÁÖß„ÄÇ</p>
<p><strong>Âø´ÁÖßÁöÑËøê‰ΩúÊñπÂºè:</strong></p>
<p>ÂΩì Redis ÈúÄË¶Å‰øùÂ≠ò dump.rdb Êñá‰ª∂Êó∂Ôºå ÊúçÂä°Âô®ÊâßË°å‰ª•‰∏ãÊìç‰ΩúÔºö</p>
<ul>
<li>Redis Ë∞ÉÁî® fork() ÔºåÂêåÊó∂Êã•ÊúâÁà∂ËøõÁ®ãÂíåÂ≠êËøõÁ®ã„ÄÇ</li>
<li>Â≠êËøõÁ®ãÂ∞ÜÊï∞ÊçÆÈõÜÂÜôÂÖ•Âà∞‰∏Ä‰∏™‰∏¥Êó∂ RDB Êñá‰ª∂‰∏≠„ÄÇ</li>
<li>ÂΩìÂ≠êËøõÁ®ãÂÆåÊàêÂØπÊñ∞ RDB Êñá‰ª∂ÁöÑÂÜôÂÖ•Êó∂ÔºåRedis Áî®Êñ∞ RDB Êñá‰ª∂ÊõøÊç¢ÂéüÊù•ÁöÑ RDB Êñá‰ª∂ÔºåÂπ∂Âà†Èô§ÊóßÁöÑ RDB Êñá‰ª∂„ÄÇ</li>
</ul>
<p>ËøôÁßçÂ∑•‰ΩúÊñπÂºè‰ΩøÂæó Redis ÂèØ‰ª•‰ªéÂÜôÊó∂Â§çÂà∂Ôºàcopy-on-writeÔºâÊú∫Âà∂‰∏≠Ëé∑Áõä„ÄÇ</p>
<p>ÈÖçÁΩÆÊñá‰ª∂ redis.confÔºåÊúçÂä°ÈáçÊñ∞ÂêØÂä®Êó∂Â∞±‰ºöÊÅ¢Â§çÊï∞ÊçÆ</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dbfilename dump.rdb #ÈªòËÆ§ÁöÑÊï∞ÊçÆÂ§á‰ªΩÊñá‰ª∂Âêç</span><br></pre></td></tr></table></figure>

<p>Êï∞ÊçÆÂ§á‰ªΩÊñá‰ª∂ÁöÑ‰ΩçÁΩÆÔºåÈªòËÆ§Âú®ÂÆâË£ÖÁõÆÂΩï‰∏ã</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CONFIG GET dir #ËæìÂá∫dump.rdbÊñá‰ª∂ÁöÑ‰ΩçÁΩÆ</span><br></pre></td></tr></table></figure>

<p>ÈÖçÁΩÆÊñá‰ª∂‰∏≠ÁöÑÂø´ÁÖßÈÖçÁΩÆ</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Unless specified otherwise, by default Redis will save the DB:</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">  * After 3600 seconds (an hour) <span class="keyword">if</span> at least 1 change was performed</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">  * After 300 seconds (5 minutes) <span class="keyword">if</span> at least 100 changes were performed</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">  * After 60 seconds <span class="keyword">if</span> at least 10000 changes were performed</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># You can set these explicitly by uncommenting the following line.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># save 3600 1 300 100 60 10000</span></span></span><br></pre></td></tr></table></figure>

<p><strong>RDB ÁöÑ‰ºòÁÇπ:</strong></p>
<ul>
<li>RDBÊòØ‰∏ÄÁßçË°®Á§∫Êüê‰∏™Âç≥Êó∂ÁÇπÁöÑRedisÊï∞ÊçÆÁöÑÁ¥ßÂáëÊñá‰ª∂„ÄÇRDBÊñá‰ª∂ÈÄÇÂêàÁî®‰∫éÂ§á‰ªΩ„ÄÇ‰æãÂ¶ÇÔºå‰Ω†ÂèØËÉΩÊÉ≥Ë¶ÅÊØèÂ∞èÊó∂ÂΩíÊ°£ÊúÄËøë24Â∞èÊó∂ÁöÑRDBÊñá‰ª∂ÔºåÊØèÂ§©‰øùÂ≠òËøë30Â§©ÁöÑRDBÂø´ÁÖß„ÄÇËøôÂÖÅËÆ∏‰Ω†ÂæàÂÆπÊòìÁöÑÊÅ¢Â§ç‰∏çÂêåÁâàÊú¨ÁöÑÊï∞ÊçÆÈõÜ‰ª•ÂÆπÁÅæ„ÄÇ</li>
<li>RDBÈùûÂ∏∏ÈÄÇÂêà‰∫éÁÅæÈöæÊÅ¢Â§çÔºå‰Ωú‰∏∫‰∏Ä‰∏™Á¥ßÂáëÁöÑÂçï‰∏ÄÊñá‰ª∂ÔºåÂèØ‰ª•Ë¢´‰º†ËæìÂà∞ËøúÁ®ãÁöÑÊï∞ÊçÆ‰∏≠ÂøÉÔºåÊàñËÄÖÊòØAmazon S3(ÂèØËÉΩÂæóÂä†ÂØÜ)„ÄÇ</li>
<li>RDBÊúÄÂ§ßÂåñ‰∫ÜRedisÁöÑÊÄßËÉΩÔºåÂõ†‰∏∫RedisÁà∂ËøõÁ®ãÊåÅ‰πÖÂåñÊó∂ÂîØ‰∏ÄÈúÄË¶ÅÂÅöÁöÑÊòØÂêØÂä®(fork)‰∏Ä‰∏™Â≠êËøõÁ®ãÔºåÁî±Â≠êËøõÁ®ãÂÆåÊàêÊâÄÊúâÂâ©‰ΩôÂ∑•‰Ωú„ÄÇÁà∂ËøõÁ®ãÂÆû‰æã‰∏çÈúÄË¶ÅÊâßË°åÂÉèÁ£ÅÁõòIOËøôÊ†∑ÁöÑÊìç‰Ωú„ÄÇ</li>
<li>RDBÂú®ÈáçÂêØ‰øùÂ≠ò‰∫ÜÂ§ßÊï∞ÊçÆÈõÜÁöÑÂÆû‰æãÊó∂ÊØîAOFË¶ÅÂø´„ÄÇ</li>
</ul>
<p><strong>RDB ÁöÑÁº∫ÁÇπ</strong></p>
<ul>
<li>ÂΩì‰Ω†ÈúÄË¶ÅÂú®RedisÂÅúÊ≠¢Â∑•‰Ωú(‰æãÂ¶ÇÂÅúÁîµ)Êó∂ÊúÄÂ∞èÂåñÊï∞ÊçÆ‰∏¢Â§±ÔºåRDBÂèØËÉΩ‰∏çÂ§™Â•Ω„ÄÇ‰Ω†ÂèØ‰ª•ÈÖçÁΩÆ‰∏çÂêåÁöÑ‰øùÂ≠òÁÇπ(save point)Êù•‰øùÂ≠òRDBÊñá‰ª∂(‰æãÂ¶ÇÔºå5ÂàÜÈíü‰πãÂêéËá≥Â∞ëÂØπÊï∞ÊçÆÈõÜ100Ê¨°ÂÜô‰πãÂêéÔºå‰ΩÜÊòØ‰Ω†ÂèØ‰ª•ÊúâÂ§ö‰∏™‰øùÂ≠òÁÇπ)„ÄÇÁÑ∂ËÄåÔºå‰Ω†ÈÄöÂ∏∏ÊØèÈöî5ÂàÜÈíüÊàñÊõ¥‰πÖÂàõÂª∫‰∏Ä‰∏™RDBÂø´ÁÖßÔºåÊâÄ‰ª•‰∏ÄÊó¶RedisÂõ†‰∏∫‰ªª‰ΩïÂéüÂõ†Ê≤°ÊúâÊ≠£Á°ÆÂÖ≥Èó≠ËÄåÂÅúÊ≠¢Â∑•‰ΩúÔºå‰Ω†Â∞±ÂæóÂÅöÂ•ΩÊúÄËøëÂá†ÂàÜÈíüÊï∞ÊçÆ‰∏¢Â§±ÁöÑÂáÜÂ§á‰∫Ü„ÄÇ</li>
<li>RDBÈúÄË¶ÅÁªèÂ∏∏Ë∞ÉÁî®fork()Â≠êËøõÁ®ãÊù•ÊåÅ‰πÖÂåñÂà∞Á£ÅÁõò„ÄÇÂ¶ÇÊûúÊï∞ÊçÆÈõÜÂæàÂ§ßÁöÑËØùÔºåfork()ÊØîËæÉËÄóÊó∂ÔºåÁªìÊûúÂ∞±ÊòØÔºåÂΩìÊï∞ÊçÆÈõÜÈùûÂ∏∏Â§ßÂπ∂‰∏îCPUÊÄßËÉΩ‰∏çÂ§üÂº∫Â§ßÁöÑËØùÔºåRedis‰ºöÂÅúÊ≠¢ÊúçÂä°ÂÆ¢Êà∑Á´ØÂá†ÊØ´ÁßíÁîöËá≥‰∏ÄÁßí„ÄÇAOF‰πüÈúÄË¶Åfork()Ôºå‰ΩÜÊòØ‰Ω†ÂèØ‰ª•Ë∞ÉÊï¥Â§ö‰πÖÈ¢ëÁéáÈáçÂÜôÊó•ÂøóËÄå‰∏ç‰ºöÊúâÊçü(trade-off)ÊåÅ‰πÖÊÄß(durability)„ÄÇ</li>
</ul>
<p>RDB ËÆ∞ÂΩïÁöÑÊòØÊüê‰∏ÄÊó∂ÂàªÁöÑÊï∞ÊçÆÔºåÂπ∂‰∏çÊòØÊìç‰Ωú</p>
<p>Êàë‰ª¨ËøòË¶ÅËÄÉËôë‰∏§‰∏™ÂÖ≥ÈîÆÈóÆÈ¢òÔºö</p>
<ul>
<li>ÂØπÂì™‰∫õÊï∞ÊçÆÂÅöÂø´ÁÖßÔºüËøôÂÖ≥Á≥ªÂà∞Âø´ÁÖßÁöÑÊâßË°åÊïàÁéáÈóÆÈ¢òÔºõ</li>
<li>ÂÅöÂø´ÁÖßÊó∂ÔºåÊï∞ÊçÆËøòËÉΩË¢´Â¢ûÂà†ÊîπÂêóÔºüËøôÂÖ≥Á≥ªÂà∞ Redis ÊòØÂê¶Ë¢´ÈòªÂ°ûÔºåËÉΩÂê¶ÂêåÊó∂Ê≠£Â∏∏Â§ÑÁêÜËØ∑Ê±Ç„ÄÇ</li>
</ul>
<p><strong>ÁªôÂì™‰∫õÂÜÖÂ≠òÊï∞ÊçÆÂÅöÂø´ÁÖßÔºü</strong></p>
<p>Redis ÁöÑÊï∞ÊçÆÈÉΩÂú®ÂÜÖÂ≠ò‰∏≠Ôºå‰∏∫‰∫ÜÊèê‰æõÊâÄÊúâÊï∞ÊçÆÁöÑÂèØÈù†ÊÄß‰øùËØÅÔºåÂÆÉÊâßË°åÁöÑÊòØ<code>ÂÖ®ÈáèÂø´ÁÖß</code>Ôºå‰πüÂ∞±<br>ÊòØËØ¥ÔºåÊääÂÜÖÂ≠ò‰∏≠ÁöÑÊâÄÊúâÊï∞ÊçÆÈÉΩËÆ∞ÂΩïÂà∞Á£ÅÁõò‰∏≠.<br>ÂØπ‰∫é Redis ËÄåË®ÄÔºåÂÆÉÁöÑÂçïÁ∫øÁ®ãÊ®°ÂûãÂ∞±ÂÜ≥ÂÆö‰∫ÜÔºåÊàë‰ª¨Ë¶ÅÂ∞ΩÈáèÈÅøÂÖçÊâÄÊúâ‰ºöÈòªÂ°û‰∏ªÁ∫øÁ®ãÁöÑÊìç‰ΩúÔºå</p>
<p>Redis Êèê‰æõ‰∫Ü‰∏§‰∏™ÂëΩ‰ª§Êù•ÁîüÊàê RDB Êñá‰ª∂ÔºåÂàÜÂà´ÊòØ save Âíå bgsave„ÄÇ</p>
<ul>
<li>saveÔºöÂú®‰∏ªÁ∫øÁ®ã‰∏≠ÊâßË°åÔºå‰ºöÂØºËá¥ÈòªÂ°ûÔºõ</li>
<li>bgsaveÔºöÂàõÂª∫‰∏Ä‰∏™Â≠êËøõÁ®ãÔºå‰∏ìÈó®Áî®‰∫éÂÜôÂÖ• RDB Êñá‰ª∂ÔºåÈÅøÂÖç‰∫Ü‰∏ªÁ∫øÁ®ãÁöÑÈòªÂ°ûÔºåËøô‰πüÊòØRedis RDB Êñá‰ª∂ÁîüÊàêÁöÑÈªòËÆ§ÈÖçÁΩÆ</li>
</ul>
<p><strong>Âø´ÁÖßÊó∂Êï∞ÊçÆËÉΩ‰øÆÊîπÂêó?</strong></p>
<p>‰∏æ‰∏™‰æãÂ≠ê„ÄÇÊàë‰ª¨Âú®Êó∂Âàª t ÁªôÂÜÖÂ≠òÂÅöÂø´ÁÖßÔºåÂÅáËÆæÂÜÖÂ≠òÊï∞ÊçÆÈáèÊòØ 4GBÔºåÁ£ÅÁõòÁöÑÂÜôÂÖ•Â∏¶ÂÆΩÊòØ0.2GB&#x2F;sÔºåÁÆÄÂçïÊù•ËØ¥ÔºåËá≥Â∞ëÈúÄË¶Å 20sÔºà4&#x2F;0.2 &#x3D; 20ÔºâÊâçËÉΩÂÅöÂÆå„ÄÇÂ¶ÇÊûúÂú®Êó∂Âàª t+5s Êó∂Ôºå‰∏Ä‰∏™<code>ËøòÊ≤°ÊúâË¢´ÂÜôÂÖ•Á£ÅÁõò</code>ÁöÑÂÜÖÂ≠òÊï∞ÊçÆ AÔºåË¢´‰øÆÊîπÊàê‰∫Ü A‚ÄôÔºåÈÇ£‰πàÂ∞±‰ºöÁ†¥ÂùèÂø´ÁÖßÁöÑÂÆåÊï¥ÊÄßÔºåÂõ†‰∏∫A‚Äô‰∏çÊòØÊó∂Âàª t Êó∂ÁöÑÁä∂ÊÄÅ„ÄÇÂõ†Ê≠§ÔºåÂíåÊãçÁÖßÁ±ª‰ººÔºåÊàë‰ª¨Âú®ÂÅöÂø´ÁÖßÊó∂‰πü‰∏çÂ∏åÊúõÊï∞ÊçÆ‚ÄúÂä®‚ÄùÔºå‰πüÂ∞±ÊòØ‰∏çËÉΩË¢´‰øÆÊîπ„ÄÇ‰ΩÜÊòØÔºåÂ¶ÇÊûúÂø´ÁÖßÊâßË°åÊúüÈó¥Êï∞ÊçÆ‰∏çËÉΩË¢´‰øÆÊîπÔºåRedis Â∞±‰∏çËÉΩÂ§ÑÁêÜÂØπËøô‰∫õÊï∞ÊçÆÁöÑ<code>ÂÜôÊìç‰Ωú</code>ÔºåÈÇ£Êó†ÁñëÂ∞±‰ºöÁªô‰∏öÂä°ÊúçÂä°ÈÄ†ÊàêÂ∑®Â§ßÁöÑÂΩ±Âìç„ÄÇ</p>
<p>‰∏∫‰∫Ü‰øùÊåÅÂÜôÊìç‰ΩúÔºåRedis Â∞±‰ºöÂÄüÂä©Êìç‰ΩúÁ≥ªÁªüÊèê‰æõÁöÑ<strong>ÂÜôÊó∂Â§çÂà∂ÊäÄÊúØ</strong>ÔºàCopy-On-Write, COWÔºâÔºåÂú®ÊâßË°åÂø´ÁÖßÁöÑÂêåÊó∂ÔºåÊ≠£Â∏∏Â§ÑÁêÜÂÜôÊìç‰Ωú„ÄÇ</p>
<p>ÁÆÄÂçïÊù•ËØ¥Ôºåbgsave Â≠êËøõÁ®ãÊòØÁî±‰∏ªÁ∫øÁ®ã fork ÁîüÊàêÁöÑÔºåÂèØ‰ª•ÂÖ±‰∫´‰∏ªÁ∫øÁ®ãÁöÑÊâÄÊúâÂÜÖÂ≠òÊï∞ÊçÆ„ÄÇbgsave Â≠êËøõÁ®ãËøêË°åÂêéÔºåÂºÄÂßãËØªÂèñ‰∏ªÁ∫øÁ®ãÁöÑÂÜÖÂ≠òÊï∞ÊçÆÔºåÂπ∂ÊääÂÆÉ‰ª¨ÂÜôÂÖ• RDB Êñá‰ª∂„ÄÇ</p>
<p>Ê≠§Êó∂ÔºåÂ¶ÇÊûú‰∏ªÁ∫øÁ®ãÂØπËøô‰∫õÊï∞ÊçÆ‰πüÈÉΩÊòØËØªÊìç‰ΩúÔºà‰æãÂ¶ÇÂõæ‰∏≠ÁöÑÈîÆÂÄºÂØπ AÔºâÔºåÈÇ£‰πàÔºå‰∏ªÁ∫øÁ®ãÂíåbgsave Â≠êËøõÁ®ãÁõ∏‰∫í‰∏çÂΩ±Âìç„ÄÇ‰ΩÜÊòØÔºåÂ¶ÇÊûú‰∏ªÁ∫øÁ®ãË¶Å‰øÆÊîπ‰∏ÄÂùóÊï∞ÊçÆÔºà‰æãÂ¶ÇÂõæ‰∏≠ÁöÑÈîÆÂÄºÂØπ CÔºåËøòÊú™ÂÜôÁ£ÅÁõòÔºâÔºåÈÇ£‰πàÔºåËøôÂùóÊï∞ÊçÆÂ∞±‰ºöË¢´Â§çÂà∂‰∏Ä‰ªΩÔºåÁîüÊàêËØ•Êï∞ÊçÆÁöÑÂâØÊú¨„ÄÇÁÑ∂ÂêéÔºåbgsave Â≠êËøõÁ®ã‰ºöÊääËøô‰∏™ÂâØÊú¨Êï∞ÊçÆÂÜôÂÖ• RDB Êñá‰ª∂ÔºåËÄåÂú®Ëøô‰∏™ËøáÁ®ã‰∏≠Ôºå‰∏ªÁ∫øÁ®ã‰ªçÁÑ∂ÂèØ‰ª•Áõ¥Êé•‰øÆÊîπÂéüÊù•ÁöÑÊï∞ÊçÆ„ÄÇ</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://fastly.jsdelivr.net/gh/YuChaoM/images/OS/image-20220912162822300.png" alt="image-20220912162822300"></p>
<p><strong>Â§ö‰πÖÂÅö‰∏ÄÊ¨°Âø´ÁÖßÔºü</strong></p>
<p>Â¶Ç‰∏ãÂõæÊâÄÁ§∫ÔºåÊàë‰ª¨ÂÖàÂú® T0 Êó∂ÂàªÂÅö‰∫Ü‰∏ÄÊ¨°Âø´ÁÖßÔºåÁÑ∂ÂêéÂèàÂú® T0+t Êó∂ÂàªÂÅö‰∫Ü‰∏ÄÊ¨°Âø´ÁÖßÔºåÂú®ËøôÊúüÈó¥ÔºåÊï∞ÊçÆÂùó 5 Âíå 9 Ë¢´‰øÆÊîπ‰∫Ü„ÄÇÂ¶ÇÊûúÂú® t ËøôÊÆµÊó∂Èó¥ÂÜÖÔºåÊú∫Âô®ÂÆïÊú∫‰∫ÜÔºåÈÇ£‰πàÔºåÂè™ËÉΩÊåâÁÖß T0 Êó∂ÂàªÁöÑÂø´ÁÖßËøõË°åÊÅ¢Â§ç„ÄÇÊ≠§Êó∂ÔºåÊï∞ÊçÆÂùó 5 Âíå 9 ÁöÑ‰øÆÊîπÂÄºÂõ†‰∏∫Ê≤°ÊúâÂø´ÁÖßËÆ∞ÂΩïÔºåÂ∞±Êó†Ê≥ïÊÅ¢Â§ç‰∫Ü„ÄÇ</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://fastly.jsdelivr.net/gh/YuChaoM/images/OS/image-20220912163132682.png" alt="image-20220912163132682"></p>
<p>Â¶ÇÊûúÊØèÁßíÂÅö‰∏ÄÊ¨°Âø´ÁÖßÔºå<code>ËôΩÁÑ∂ bgsave ÊâßË°åÊó∂‰∏çÈòªÂ°û‰∏ªÁ∫øÁ®ãÔºå‰ΩÜÊòØÔºåÂ¶ÇÊûúÈ¢ëÁπÅÂú∞ÊâßË°åÂÖ®ÈáèÂø´ÁÖßÔºå‰πü‰ºöÂ∏¶Êù•‰∏§ÊñπÈù¢ÁöÑÂºÄÈîÄ„ÄÇ</code></p>
<p>‰∏ÄÊñπÈù¢ÔºåÈ¢ëÁπÅÂ∞ÜÂÖ®ÈáèÊï∞ÊçÆÂÜôÂÖ•Á£ÅÁõòÔºå‰ºöÁªôÁ£ÅÁõòÂ∏¶Êù•ÂæàÂ§ßÂéãÂäõ„ÄÇ</p>
<p>Âè¶‰∏ÄÊñπÈù¢Ôºåbgsave Â≠êËøõÁ®ãÈúÄË¶ÅÈÄöËøá fork Êìç‰Ωú‰ªé‰∏ªÁ∫øÁ®ãÂàõÂª∫Âá∫Êù•„ÄÇËôΩÁÑ∂ÔºåÂ≠êËøõÁ®ãÂú®ÂàõÂª∫Âêé‰∏ç‰ºöÂÜçÈòªÂ°û‰∏ªÁ∫øÁ®ãÔºå‰ΩÜÊòØÔºåfork Ëøô‰∏™ÂàõÂª∫ËøáÁ®ãÊú¨Ë∫´‰ºöÈòªÂ°û‰∏ªÁ∫øÁ®ãÔºåËÄå‰∏î‰∏ªÁ∫øÁ®ãÁöÑÂÜÖÂ≠òË∂äÂ§ßÔºåÈòªÂ°ûÊó∂Èó¥Ë∂äÈïø„ÄÇÂ¶ÇÊûúÈ¢ëÁπÅ fork Âá∫ bgsave Â≠êËøõÁ®ãÔºåËøôÂ∞±‰ºöÈ¢ëÁπÅÈòªÂ°û‰∏ªÁ∫øÁ®ã‰∫Ü„ÄÇ</p>
<p>Êúâ‰ªÄ‰πàÊñπÊ≥ïÊó¢ËÉΩÂà©Áî® RDB ÁöÑÂø´ÈÄüÊÅ¢Â§çÔºåÂèàËÉΩ‰ª•ËæÉÂ∞èÁöÑÂºÄÈîÄÂÅöÂà∞Â∞ΩÈáèÂ∞ë‰∏¢Êï∞ÊçÆÂë¢Ôºü</p>
<h5 id="Ê∑∑Âêà‰ΩøÁî®-AOF-Êó•ÂøóÂíåÂÜÖÂ≠òÂø´ÁÖß"><a href="#Ê∑∑Âêà‰ΩøÁî®-AOF-Êó•ÂøóÂíåÂÜÖÂ≠òÂø´ÁÖß" class="headerlink" title="Ê∑∑Âêà‰ΩøÁî® AOF Êó•ÂøóÂíåÂÜÖÂ≠òÂø´ÁÖß"></a>Ê∑∑Âêà‰ΩøÁî® AOF Êó•ÂøóÂíåÂÜÖÂ≠òÂø´ÁÖß</h5><p>Redis 4.0 ‰∏≠ÊèêÂá∫‰∫Ü‰∏Ä‰∏™<strong>Ê∑∑Âêà‰ΩøÁî® AOF Êó•ÂøóÂíåÂÜÖÂ≠òÂø´ÁÖß</strong>ÁöÑÊñπÊ≥ï„ÄÇÁÆÄÂçïÊù•ËØ¥ÔºåÂÜÖÂ≠òÂø´ÁÖß‰ª•‰∏ÄÂÆöÁöÑÈ¢ëÁéáÊâßË°åÔºåÂú®‰∏§Ê¨°Âø´ÁÖß‰πãÈó¥Ôºå‰ΩøÁî® AOF Êó•ÂøóËÆ∞ÂΩïËøôÊúüÈó¥ÁöÑÊâÄÊúâÂëΩ‰ª§Êìç‰Ωú„ÄÇ</p>
<p>T1 Âíå T2 Êó∂ÂàªÁöÑ‰øÆÊîπÔºåÁî® AOF Êó•ÂøóËÆ∞ÂΩïÔºåÁ≠âÂà∞Á¨¨‰∫åÊ¨°ÂÅöÂÖ®ÈáèÂø´ÁÖßÊó∂ÔºåÂ∞±ÂèØ‰ª•Ê∏ÖÁ©∫ AOF Êó•ÂøóÔºåÂõ†‰∏∫Ê≠§Êó∂ÁöÑ‰øÆÊîπÈÉΩÂ∑≤ÁªèËÆ∞ÂΩïÂà∞Âø´ÁÖß‰∏≠‰∫ÜÔºåÊÅ¢Â§çÊó∂Â∞±‰∏çÂÜçÁî®Êó•Âøó‰∫Ü„ÄÇ</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://fastly.jsdelivr.net/gh/YuChaoM/images/OS/image-20220912163546708.png" alt="image-20220912163546708"></p>
<blockquote>
<p>ÂºÄÂêØÔºöÊ∑∑ÂêàÊåÅ‰πÖÂåñÁöÑÈÖçÁΩÆÂèÇÊï∞‰∏∫ aof-use-rdb-preambleÔºåÈÖçÁΩÆ‰∏∫ yes Êó∂ÂºÄÂêØÊ∑∑ÂêàÊåÅ‰πÖÂåñÔºåÂú® redis 4 ÂàöÂºïÂÖ•Êó∂ÔºåÈªòËÆ§ÊòØÂÖ≥Èó≠Ê∑∑ÂêàÊåÅ‰πÖÂåñÁöÑÔºå‰ΩÜÊòØÂú® <strong>redis 5 ‰∏≠ÈªòËÆ§Â∑≤ÁªèÊâìÂºÄ‰∫Ü</strong>„ÄÇ</p>
</blockquote>
<h4 id="9-3-Â¶Ç‰ΩïÁî±RDBÊåÅ‰πÖÂåñËΩ¨Êç¢Âà∞AOFÊåÅ‰πÖÂåñÔºü"><a href="#9-3-Â¶Ç‰ΩïÁî±RDBÊåÅ‰πÖÂåñËΩ¨Êç¢Âà∞AOFÊåÅ‰πÖÂåñÔºü" class="headerlink" title="9.3 Â¶Ç‰ΩïÁî±RDBÊåÅ‰πÖÂåñËΩ¨Êç¢Âà∞AOFÊåÅ‰πÖÂåñÔºü"></a>9.3 Â¶Ç‰ΩïÁî±RDBÊåÅ‰πÖÂåñËΩ¨Êç¢Âà∞AOFÊåÅ‰πÖÂåñÔºü</h4><p>Redis 2.0 Âíå Redis 2.2 Â§ÑÁêÜÊµÅÁ®ã‰∏ç‰∏ÄÊ†∑ÔºåÂèØ‰ª•ÂæàÁÆÄÂçïÁåúÊµãÂà∞ Redis 2.2 Â§ÑÁêÜÊµÅÁ®ãÊõ¥ÁÆÄÂçïÔºåÂπ∂‰∏î‰∏çÈúÄË¶ÅÈáçÂêØ„ÄÇ</p>
<p><strong>Redis &gt;&#x3D;2.2 Êó∂</strong></p>
<ul>
<li>ÂàõÂª∫ÊúÄËøëÁöÑRDBÊñá‰ª∂ÁöÑÂ§á‰ªΩ„ÄÇ</li>
<li>Â∞ÜÂ§á‰ªΩ‰øùÂ≠òÂú®ÂÆâÂÖ®ÁöÑ‰ΩçÁΩÆ„ÄÇ</li>
<li>ÂèëËµ∑Â¶Ç‰∏ãÂëΩ‰ª§„ÄÇ</li>
<li>$redis-cli config set appendonly yes„ÄÇ</li>
<li>$redis-cli config set save ‚Äú‚Äù„ÄÇ</li>
<li>Á°ÆËÆ§Êï∞ÊçÆÂ∫ìÂåÖÂê´Áõ∏ÂêåÁöÑkeys„ÄÇ</li>
<li>Á°ÆËÆ§writeÊìç‰ΩúË¢´Ê≠£Á°ÆËøΩÂä†Âà∞‰∫ÜAOFÊñá‰ª∂„ÄÇ</li>
</ul>
<p>Á¨¨‰∏Ä‰∏™CONFIGÂëΩ‰ª§ÂºÄÂêØAOF„ÄÇRedis‰ºöÈòªÂ°û‰ª•ÁîüÊàêÂàùÂßãËΩ¨ÂÇ®Êñá‰ª∂ÔºåÁÑ∂ÂêéÊâìÂºÄÊñá‰ª∂ÂáÜÂ§áÂÜôÔºåÂºÄÂßãËøΩÂä†ÂÜôÊìç‰Ωú„ÄÇ</p>
<p>Á¨¨‰∫å‰∏™CONFIGÂëΩ‰ª§Áî®‰∫éÂÖ≥Èó≠Âø´ÁÖßÊåÅ‰πÖÂåñ„ÄÇËøô‰∏ÄÊ≠•ÊòØÂèØÈÄâÁöÑÔºåÂ¶ÇÊûú‰Ω†ÊÉ≥ÂêåÊó∂ÂºÄÂêØËøô‰∏§ÁßçÊåÅ‰πÖÂåñÊñπÊ≥ï„ÄÇ</p>
<p><strong>ÈáçË¶ÅÔºö</strong>ËÆ∞ÂæóÁºñËæë‰Ω†ÁöÑredis.confÊñá‰ª∂Êù•ÂºÄÂêØAOFÔºåÂê¶ÂàôÂΩì‰Ω†ÈáçÂêØÊúçÂä°Âô®Êó∂Ôºå‰Ω†ÁöÑÈÖçÁΩÆ‰øÆÊîπÂ∞Ü‰ºö‰∏¢Â§±ÔºåÊúçÂä°Âô®Âèà‰ºö‰ΩøÁî®ÊóßÁöÑÈÖçÁΩÆ„ÄÇ</p>
<h3 id="10„ÄÅ‰∏ª‰ªéÂ§çÂà∂"><a href="#10„ÄÅ‰∏ª‰ªéÂ§çÂà∂" class="headerlink" title="10„ÄÅ‰∏ª‰ªéÂ§çÂà∂"></a>10„ÄÅ‰∏ª‰ªéÂ§çÂà∂</h3><p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6844903943764443149">Êê≠Âª∫ÂèÇËÄÉ</a></p>
<p>Redis ÂÖ∑ÊúâÈ´òÂèØÈù†ÊÄßÔºö‰∏ÄÊòØÊï∞ÊçÆÂ∞ΩÈáèÂ∞ë‰∏¢Â§±Ôºå‰∫åÊòØÊúçÂä°Â∞ΩÈáèÂ∞ë‰∏≠Êñ≠„ÄÇAOF Âíå RDB ‰øùËØÅ‰∫ÜÂâçËÄÖÔºåËÄåÂØπ‰∫éÂêéËÄÖÔºåRedis ÁöÑÂÅöÊ≥ïÂ∞±ÊòØÂ¢ûÂä†ÂâØÊú¨ÂÜó‰ΩôÈáèÔºåÂ∞Ü‰∏Ä‰ªΩÊï∞ÊçÆÂêåÊó∂‰øùÂ≠òÂú®Â§ö‰∏™ÂÆû‰æã‰∏ä„ÄÇ</p>
<p>ÂÆûÈôÖ‰∏äÔºåRedis Êèê‰æõ‰∫Ü‰∏ª‰ªéÂ∫ìÊ®°ÂºèÔºå‰ª•‰øùËØÅÊï∞ÊçÆÂâØÊú¨ÁöÑ‰∏ÄËá¥Ôºå‰∏ª‰ªéÂ∫ì‰πãÈó¥ÈááÁî®ÁöÑÊòØËØªÂÜôÂàÜÁ¶ªÁöÑÊñπÂºè„ÄÇ</p>
<ul>
<li>ËØªÊìç‰ΩúÔºö‰∏ªÂ∫ì„ÄÅ‰ªéÂ∫ìÈÉΩÂèØ‰ª•Êé•Êî∂Ôºõ</li>
<li>ÂÜôÊìç‰ΩúÔºöÈ¶ñÂÖàÂà∞‰∏ªÂ∫ìÊâßË°åÔºåÁÑ∂ÂêéÔºå‰∏ªÂ∫ìÂ∞ÜÂÜôÊìç‰ΩúÂêåÊ≠•Áªô‰ªéÂ∫ì„ÄÇ</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://fastly.jsdelivr.net/gh/YuChaoM/images/OS/image-20220912195034424.png" alt="image-20220912195034424"></p>
<p>Â¶ÇÊûúÂú®‰∏äÂõæ‰∏≠Ôºå‰∏çÁÆ°ÊòØ‰∏ªÂ∫ìËøòÊòØ‰ªéÂ∫ìÔºåÈÉΩËÉΩÊé•Êî∂ÂÆ¢Êà∑Á´ØÁöÑÂÜôÊìç‰ΩúÔºåÈÇ£‰πàÔºå‰∏Ä‰∏™Áõ¥Êé•ÁöÑÈóÆÈ¢òÂ∞±ÊòØÔºöÂ¶ÇÊûúÂÆ¢Êà∑Á´ØÂØπÂêå‰∏Ä‰∏™Êï∞ÊçÆÔºà‰æãÂ¶Ç k1ÔºâÂâçÂêé‰øÆÊîπ‰∫Ü‰∏âÊ¨°ÔºåÊØè‰∏ÄÊ¨°ÁöÑ‰øÆÊîπËØ∑Ê±ÇÈÉΩÂèëÈÄÅÂà∞‰∏çÂêåÁöÑÂÆû‰æã‰∏äÔºåÂú®‰∏çÂêåÁöÑÂÆû‰æã‰∏äÊâßË°åÔºåÈÇ£‰πàÔºåËøô‰∏™Êï∞ÊçÆÂú®Ëøô‰∏â‰∏™ÂÆû‰æã‰∏äÁöÑÂâØÊú¨Â∞±‰∏ç‰∏ÄËá¥‰∫ÜÔºàÂàÜÂà´ÊòØ v1„ÄÅv2 Âíå v3Ôºâ</p>
<p>Â¶ÇÊûúÊàë‰ª¨ÈùûË¶Å‰øùÊåÅËøô‰∏™Êï∞ÊçÆÂú®‰∏â‰∏™ÂÆû‰æã‰∏ä‰∏ÄËá¥ÔºåÂ∞±Ë¶ÅÊ∂âÂèäÂà∞Âä†ÈîÅ„ÄÅÂÆû‰æãÈó¥ÂçèÂïÜÊòØÂê¶ÂÆåÊàê‰øÆÊîπÁ≠â‰∏ÄÁ≥ªÂàóÊìç‰ΩúÔºå‰ΩÜËøô‰ºöÂ∏¶Êù•Â∑®È¢ùÁöÑÂºÄÈîÄ</p>
<p><strong>‰∏ª‰ªéÂ∫ìÈó¥Â¶Ç‰ΩïËøõË°åÁ¨¨‰∏ÄÊ¨°ÂêåÊ≠•Ôºü</strong></p>
<p>ÂΩìÊàë‰ª¨ÂêØÂä®Â§ö‰∏™ Redis ÂÆû‰æãÁöÑÊó∂ÂÄôÔºåÂÆÉ‰ª¨Áõ∏‰∫í‰πãÈó¥Â∞±ÂèØ‰ª•ÈÄöËøá replicaofÔºàRedis 5.0 ‰πãÂâç‰ΩøÁî® slaveofÔºâÂëΩ‰ª§ÂΩ¢Êàê‰∏ªÂ∫ìÂíå‰ªéÂ∫ìÁöÑÂÖ≥Á≥ªÔºå‰πãÂêé‰ºöÊåâÁÖß‰∏â‰∏™Èò∂ÊÆµÂÆåÊàêÊï∞ÊçÆÁöÑÁ¨¨‰∏ÄÊ¨°ÂêåÊ≠•„ÄÇ</p>
<p>‰æãÂ¶ÇÔºåÁé∞Âú®ÊúâÂÆû‰æã 1ÔºàipÔºö172.16.19.3ÔºâÂíåÂÆû‰æã 2ÔºàipÔºö172.16.19.5ÔºâÔºåÊàë‰ª¨Âú®ÂÆû‰æã 2 ‰∏äÊâßË°å‰ª•‰∏ãËøô‰∏™ÂëΩ‰ª§ÂêéÔºåÂÆû‰æã 2 Â∞±ÂèòÊàê‰∫ÜÂÆû‰æã 1 ÁöÑ‰ªéÂ∫ìÔºåÂπ∂‰ªéÂÆû‰æã 1 ‰∏äÂ§çÂà∂Êï∞ÊçÆÔºö</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">replicaof 172.16.19.3 6379</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://fastly.jsdelivr.net/gh/YuChaoM/images/OS/image-20220912195509697.png" alt="image-20220912195509697"></p>
<p>‰∏ª‰ªéÁ∫ßËÅîÊ®°ÂºèÂàÜÊãÖÂÖ®ÈáèÂ§çÂà∂Êó∂ÁöÑ‰∏ªÂ∫ìÂéãÂäõ</p>
<p>ËøôÂ∞±ÊòØ‚Äú‰∏ª - ‰ªé - ‰ªé‚ÄùÊ®°Âºè,Êàë‰ª¨ÂèØ‰ª•ÈÄöËøá‚Äú‰∏ª - ‰ªé - ‰ªé‚ÄùÊ®°ÂºèÂ∞Ü‰∏ªÂ∫ìÁîüÊàê RDB Âíå‰º†Ëæì RDB ÁöÑÂéãÂäõÔºå‰ª•Á∫ßËÅîÁöÑÊñπÂºèÂàÜÊï£Âà∞‰ªéÂ∫ì‰∏ä</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://fastly.jsdelivr.net/gh/YuChaoM/images/OS/image-20220912200657427.png" alt="image-20220912200657427"></p>
<p>Êàë‰ª¨‰∫ÜËß£‰∫Ü‰∏ª‰ªéÂ∫ìÈó¥ÈÄöËøáÂÖ®ÈáèÂ§çÂà∂ÂÆûÁé∞Êï∞ÊçÆÂêåÊ≠•ÁöÑËøáÁ®ãÔºå‰ª•ÂèäÈÄöËøá‚Äú‰∏ª -‰ªé - ‰ªé‚ÄùÊ®°ÂºèÂàÜÊãÖ‰∏ªÂ∫ìÂéãÂäõÁöÑÊñπÂºè„ÄÇÈÇ£‰πàÔºå‰∏ÄÊó¶‰∏ª‰ªéÂ∫ìÂÆåÊàê‰∫ÜÂÖ®ÈáèÂ§çÂà∂ÔºåÂÆÉ‰ª¨‰πãÈó¥Â∞±‰ºö‰∏ÄÁõ¥Áª¥Êä§‰∏Ä‰∏™ÁΩëÁªúËøûÊé•Ôºå‰∏ªÂ∫ì‰ºöÈÄöËøáËøô‰∏™ËøûÊé•Â∞ÜÂêéÁª≠ÈôÜÁª≠Êî∂Âà∞ÁöÑÂëΩ‰ª§Êìç‰ΩúÂÜçÂêåÊ≠•Áªô‰ªéÂ∫ìÔºåËøô‰∏™ËøáÁ®ã‰πüÁß∞‰∏∫<strong>Âü∫‰∫éÈïøËøûÊé•ÁöÑÂëΩ‰ª§‰º†Êí≠</strong>ÔºåÂèØ‰ª•ÈÅøÂÖçÈ¢ëÁπÅÂª∫Á´ãËøûÊé•ÁöÑÂºÄÈîÄ„ÄÇÂ¶ÇÊûúÁΩëÁªúÊñ≠ËøûÔºå‰∏ª‰ªéÂ∫ì‰πãÈó¥Â∞±Êó†Ê≥ïËøõË°åÂëΩ‰ª§‰º†Êí≠‰∫ÜÔºå‰ªéÂ∫ìÁöÑÊï∞ÊçÆËá™ÁÑ∂‰πüÂ∞±Ê≤°ÂäûÊ≥ïÂíå‰∏ªÂ∫ì‰øùÊåÅ‰∏ÄËá¥‰∫ÜÔºåÂÆ¢Êà∑Á´ØÂ∞±ÂèØËÉΩ‰ªé‰ªéÂ∫ìËØªÂà∞ÊóßÊï∞ÊçÆ„ÄÇ</p>
<p><strong>‰∏ª‰ªéÂ∫ìÈó¥ÁΩëÁªúÊñ≠‰∫ÜÊÄé‰πàÂäûÔºü</strong></p>
<p>Âú® Redis 2.8 ‰πãÂâçÔºåÂ¶ÇÊûú‰∏ª‰ªéÂ∫ìÂú®ÂëΩ‰ª§‰º†Êí≠Êó∂Âá∫Áé∞‰∫ÜÁΩëÁªúÈó™Êñ≠ÔºåÈÇ£‰πàÔºå‰ªéÂ∫ìÂ∞±‰ºöÂíå‰∏ªÂ∫ìÈáçÊñ∞ËøõË°å‰∏ÄÊ¨°ÂÖ®ÈáèÂ§çÂà∂ÔºåÂºÄÈîÄÈùûÂ∏∏Â§ß</p>
<p>‰ªé Redis 2.8 ÂºÄÂßãÔºåÁΩëÁªúÊñ≠‰∫Ü‰πãÂêéÔºå‰∏ª‰ªéÂ∫ì‰ºöÈááÁî®Â¢ûÈáèÂ§çÂà∂ÁöÑÊñπÂºèÁªßÁª≠ÂêåÊ≠•„ÄÇÂê¨ÂêçÂ≠óÂ§ßÊ¶ÇÂ∞±ÂèØ‰ª•ÁåúÂà∞ÂÆÉÂíåÂÖ®ÈáèÂ§çÂà∂ÁöÑ‰∏çÂêåÔºö<code>ÂÖ®ÈáèÂ§çÂà∂ÊòØÂêåÊ≠•ÊâÄÊúâÊï∞ÊçÆÔºåËÄåÂ¢ûÈáèÂ§çÂà∂Âè™‰ºöÊää‰∏ª‰ªéÂ∫ìÁΩëÁªúÊñ≠ËøûÊúüÈó¥‰∏ªÂ∫ìÊî∂Âà∞ÁöÑÂëΩ‰ª§ÔºåÂêåÊ≠•Áªô‰ªéÂ∫ì„ÄÇ</code></p>
<p>ÈÇ£‰πàÔºåÂ¢ûÈáèÂ§çÂà∂Êó∂Ôºå‰∏ª‰ªéÂ∫ì‰πãÈó¥ÂÖ∑‰ΩìÊòØÊÄé‰πà‰øùÊåÅÂêåÊ≠•ÁöÑÂë¢ÔºüËøôÈáåÁöÑÂ••Â¶ôÂ∞±Âú®‰∫é<code>repl_backlog_buffer</code> Ëøô‰∏™ÁºìÂÜ≤Âå∫„ÄÇÊàë‰ª¨ÂÖàÊù•Áúã‰∏ãÂÆÉÊòØÂ¶Ç‰ΩïÁî®‰∫éÂ¢ûÈáèÂëΩ‰ª§ÁöÑÂêåÊ≠•ÁöÑ„ÄÇ</p>
<p>ÂΩì‰∏ª‰ªéÂ∫ìÊñ≠ËøûÂêéÔºå‰∏ªÂ∫ì‰ºöÊääÊñ≠ËøûÊúüÈó¥Êî∂Âà∞ÁöÑÂÜôÊìç‰ΩúÂëΩ‰ª§Ôºå<code>ÂÜôÂÖ• replication bufferÔºåÂêåÊó∂‰πü‰ºöÊääËøô‰∫õÊìç‰ΩúÂëΩ‰ª§‰πüÂÜôÂÖ• repl_backlog_buffer Ëøô‰∏™ÁºìÂÜ≤Âå∫</code>„ÄÇ</p>
<p>repl_backlog_buffer ÊòØ‰∏Ä‰∏™ÁéØÂΩ¢ÁºìÂÜ≤Âå∫Ôºå<strong>‰∏ªÂ∫ì‰ºöËÆ∞ÂΩïËá™Â∑±ÂÜôÂà∞ÁöÑ‰ΩçÁΩÆÔºå‰ªéÂ∫ìÂàô‰ºöËÆ∞ÂΩïËá™Â∑±Â∑≤ÁªèËØªÂà∞ÁöÑ‰ΩçÁΩÆ„ÄÇ</strong></p>
<p>ÂàöÂºÄÂßãÁöÑÊó∂ÂÄôÔºå‰∏ªÂ∫ìÂíå‰ªéÂ∫ìÁöÑÂÜôËØª‰ΩçÁΩÆÂú®‰∏ÄËµ∑ÔºåËøôÁÆóÊòØÂÆÉ‰ª¨ÁöÑËµ∑Âßã‰ΩçÁΩÆ„ÄÇÈöèÁùÄ‰∏ªÂ∫ì‰∏çÊñ≠Êé•Êî∂Êñ∞ÁöÑÂÜôÊìç‰ΩúÔºåÂÆÉÂú®ÁºìÂÜ≤Âå∫‰∏≠ÁöÑÂÜô‰ΩçÁΩÆ‰ºöÈÄêÊ≠•ÂÅèÁ¶ªËµ∑Âßã‰ΩçÁΩÆÔºåÊàë‰ª¨ÈÄöÂ∏∏Áî®ÂÅèÁßªÈáèÊù•Ë°°ÈáèËøô‰∏™ÂÅèÁßªË∑ùÁ¶ªÁöÑÂ§ßÂ∞èÔºåÂØπ‰∏ªÂ∫ìÊù•ËØ¥ÔºåÂØπÂ∫îÁöÑÂÅèÁßªÈáèÂ∞±ÊòØ master_repl_offset„ÄÇ‰∏ªÂ∫ìÊé•Êî∂ÁöÑÊñ∞ÂÜôÊìç‰ΩúË∂äÂ§öÔºåËøô‰∏™ÂÄºÂ∞±‰ºöË∂äÂ§ß„ÄÇ</p>
<p>ÂêåÊ†∑Ôºå‰ªéÂ∫ìÂú®Â§çÂà∂ÂÆåÂÜôÊìç‰ΩúÂëΩ‰ª§ÂêéÔºåÂÆÉÂú®ÁºìÂÜ≤Âå∫‰∏≠ÁöÑËØª‰ΩçÁΩÆ‰πüÂºÄÂßãÈÄêÊ≠•ÂÅèÁßªÂàöÊâçÁöÑËµ∑Âßã‰ΩçÁΩÆÔºåÊ≠§Êó∂Ôºå‰ªéÂ∫ìÂ∑≤Â§çÂà∂ÁöÑÂÅèÁßªÈáè slave_repl_offset ‰πüÂú®‰∏çÊñ≠Â¢ûÂä†„ÄÇÊ≠£Â∏∏ÊÉÖÂÜµ‰∏ãÔºåËøô‰∏§‰∏™ÂÅèÁßªÈáèÂü∫Êú¨Áõ∏Á≠â„ÄÇ</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://fastly.jsdelivr.net/gh/YuChaoM/images/OS/image-20220912201550054.png" alt="image-20220912201550054"></p>
<p>‰∏ª‰ªéÂ∫ìÁöÑËøûÊé•ÊÅ¢Â§ç‰πãÂêéÔºå‰ªéÂ∫ìÈ¶ñÂÖà‰ºöÁªô‰∏ªÂ∫ìÂèëÈÄÅ psync ÂëΩ‰ª§ÔºåÂπ∂ÊääËá™Â∑±ÂΩìÂâçÁöÑslave_repl_offset ÂèëÁªô‰∏ªÂ∫ìÔºå‰∏ªÂ∫ì‰ºöÂà§Êñ≠Ëá™Â∑±ÁöÑ master_repl_offset Âíå slave_repl_offset‰πãÈó¥ÁöÑÂ∑ÆË∑ù„ÄÇ</p>
<p>Âú®ÁΩëÁªúÊñ≠ËøûÈò∂ÊÆµÔºå‰∏ªÂ∫ìÂèØËÉΩ‰ºöÊî∂Âà∞Êñ∞ÁöÑÂÜôÊìç‰ΩúÂëΩ‰ª§ÔºåÊâÄ‰ª•Ôºå‰∏ÄËà¨Êù•ËØ¥Ôºåmaster_repl_offset‰ºöÂ§ß‰∫é slave_repl_offset„ÄÇÊ≠§Êó∂Ôºå‰∏ªÂ∫ìÂè™Áî®Êää master_repl_offset Âíå slave_repl_offset‰πãÈó¥ÁöÑÂëΩ‰ª§Êìç‰ΩúÂêåÊ≠•Áªô‰ªéÂ∫ìÂ∞±Ë°å„ÄÇ</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://fastly.jsdelivr.net/gh/YuChaoM/images/OS/image-20220912201646405.png" alt="image-20220912201646405"></p>
<p>Âõ†‰∏∫ repl_backlog_buffer ÊòØ‰∏Ä‰∏™ÁéØÂΩ¢ÁºìÂÜ≤Âå∫ÔºåÊâÄ‰ª•Âú®ÁºìÂÜ≤Âå∫ÂÜôÊª°ÂêéÔºå‰∏ªÂ∫ì‰ºöÁªßÁª≠ÂÜôÂÖ•ÔºåÊ≠§Êó∂ÔºåÂ∞±‰ºöË¶ÜÁõñÊéâ‰πãÂâçÂÜôÂÖ•ÁöÑÊìç‰Ωú„ÄÇÂ¶ÇÊûú‰ªéÂ∫ìÁöÑËØªÂèñÈÄüÂ∫¶ÊØîËæÉÊÖ¢ÔºåÂ∞±ÊúâÂèØËÉΩÂØºËá¥‰ªéÂ∫ìËøòÊú™ËØªÂèñÁöÑÊìç‰ΩúË¢´‰∏ªÂ∫ìÊñ∞ÂÜôÁöÑÊìç‰ΩúË¶ÜÁõñ‰∫ÜÔºåËøô‰ºöÂØºËá¥‰∏ª‰ªéÂ∫ìÈó¥ÁöÑÊï∞ÊçÆ‰∏ç‰∏ÄËá¥„ÄÇ</p>
<p>‰∏ÄËà¨ËÄåË®ÄÔºåÊàë‰ª¨ÂèØ‰ª•Ë∞ÉÊï¥ repl_backlog_size Ëøô‰∏™ÂèÇÊï∞„ÄÇËøô‰∏™ÂèÇÊï∞ÂíåÊâÄÈúÄÁöÑÁºìÂÜ≤Á©∫Èó¥Â§ßÂ∞èÊúâÂÖ≥„ÄÇÁºìÂÜ≤Á©∫Èó¥ÁöÑËÆ°ÁÆóÂÖ¨ÂºèÊòØÔºöÁºìÂÜ≤Á©∫Èó¥Â§ßÂ∞è &#x3D; ‰∏ªÂ∫ìÂÜôÂÖ•ÂëΩ‰ª§ÈÄüÂ∫¶ * Êìç‰ΩúÂ§ßÂ∞è - ‰∏ª‰ªéÂ∫ìÈó¥ÁΩëÁªú‰º†ËæìÂëΩ‰ª§ÈÄüÂ∫¶ * Êìç‰ΩúÂ§ßÂ∞è„ÄÇÂú®ÂÆûÈôÖÂ∫îÁî®‰∏≠ÔºåËÄÉËôëÂà∞ÂèØËÉΩÂ≠òÂú®‰∏Ä‰∫õÁ™ÅÂèëÁöÑËØ∑Ê±ÇÂéãÂäõÔºåÊàë‰ª¨ÈÄöÂ∏∏ÈúÄË¶ÅÊääËøô‰∏™ÁºìÂÜ≤Á©∫Èó¥Êâ©Â§ß‰∏ÄÂÄçÔºåÂç≥repl_backlog_size &#x3D; ÁºìÂÜ≤Á©∫Èó¥Â§ßÂ∞è * 2ÔºåËøô‰πüÂ∞±ÊòØ repl_backlog_size ÁöÑÊúÄÁªàÂÄº„ÄÇ</p>
<h3 id="11„ÄÅÂì®ÂÖµ"><a href="#11„ÄÅÂì®ÂÖµ" class="headerlink" title="11„ÄÅÂì®ÂÖµ"></a>11„ÄÅÂì®ÂÖµ</h3><h3 id="12„ÄÅÈõÜÁæ§"><a href="#12„ÄÅÈõÜÁæ§" class="headerlink" title="12„ÄÅÈõÜÁæ§"></a>12„ÄÅÈõÜÁæ§</h3></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="http://example.com">AXDecap</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://example.com/2022/11/02/Redis/">http://example.com/2022/11/02/Redis/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://gcore.jsdelivr.net/gh/AXDecap/imagehost/img/mmexport1652792137012.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/AXDecap/imagehost/img/1.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">AXDecap</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">1</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/AXDecap"><i class="fab fa-github"></i><span>authorÔºöAXDecap</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/AXDecap" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:overu2soon@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">Ê¨¢ËøéÊù•Âà∞ÊàëÁöÑÂçöÂÆ¢ÔºÅ</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Redis"><span class="toc-text">Redis</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E5%AE%89%E8%A3%85"><span class="toc-text">1„ÄÅÂÆâË£Ö</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E9%85%8D%E7%BD%AE"><span class="toc-text">2„ÄÅÈÖçÁΩÆ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E5%B8%B8%E7%94%A8%E4%BA%94%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-text">3„ÄÅÂ∏∏Áî®‰∫îÂ§ßÊï∞ÊçÆÁ±ªÂûã</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1%E5%91%BD%E4%BB%A4"><span class="toc-text">2.1ÂëΩ‰ª§</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2%E9%94%AE"><span class="toc-text">2.2ÈîÆ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-text">2.1Â≠óÁ¨¶‰∏≤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2Hash"><span class="toc-text">2.2Hash</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3%E5%88%97%E8%A1%A8list"><span class="toc-text">2.3ÂàóË°®list</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4%E9%9B%86%E5%90%88set"><span class="toc-text">2.4ÈõÜÂêàset</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5%E6%9C%89%E5%BA%8F%E9%9B%86%E5%90%88sorted-set"><span class="toc-text">2.5ÊúâÂ∫èÈõÜÂêàsorted set</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-6-%E6%96%B0%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-text">2.6 Êñ∞Êï∞ÊçÆÁ±ªÂûã</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#Bitmaps"><span class="toc-text">Bitmaps</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Redis-HyperLogLog"><span class="toc-text">Redis HyperLogLog</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#GEO"><span class="toc-text">GEO</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85"><span class="toc-text">4„ÄÅÂèëÂ∏ÉËÆ¢ÈòÖ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81Java-%E4%BD%BF%E7%94%A8-Redis-Jedis"><span class="toc-text">5„ÄÅJava ‰ΩøÁî® Redis(Jedis)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6%E3%80%81Redis%E4%B8%8ESpring-Boot%E6%95%B4%E5%90%88"><span class="toc-text">6„ÄÅRedis‰∏éSpring BootÊï¥Âêà</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7%E3%80%81Redis%E4%BA%8B%E5%8A%A1"><span class="toc-text">7„ÄÅRedis‰∫ãÂä°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8%E3%80%81Redis%E8%84%9A%E6%9C%AC-Lua"><span class="toc-text">8„ÄÅRedisËÑöÊú¨(Lua)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9%E3%80%81%E6%8C%81%E4%B9%85%E5%8C%96"><span class="toc-text">9„ÄÅÊåÅ‰πÖÂåñ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-1-AOF"><span class="toc-text">9.1 AOF</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-2-RDB-%E5%BF%AB%E7%85%A7"><span class="toc-text">9.2 RDB Âø´ÁÖß</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B7%B7%E5%90%88%E4%BD%BF%E7%94%A8-AOF-%E6%97%A5%E5%BF%97%E5%92%8C%E5%86%85%E5%AD%98%E5%BF%AB%E7%85%A7"><span class="toc-text">Ê∑∑Âêà‰ΩøÁî® AOF Êó•ÂøóÂíåÂÜÖÂ≠òÂø´ÁÖß</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-3-%E5%A6%82%E4%BD%95%E7%94%B1RDB%E6%8C%81%E4%B9%85%E5%8C%96%E8%BD%AC%E6%8D%A2%E5%88%B0AOF%E6%8C%81%E4%B9%85%E5%8C%96%EF%BC%9F"><span class="toc-text">9.3 Â¶Ç‰ΩïÁî±RDBÊåÅ‰πÖÂåñËΩ¨Êç¢Âà∞AOFÊåÅ‰πÖÂåñÔºü</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10%E3%80%81%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6"><span class="toc-text">10„ÄÅ‰∏ª‰ªéÂ§çÂà∂</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11%E3%80%81%E5%93%A8%E5%85%B5"><span class="toc-text">11„ÄÅÂì®ÂÖµ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12%E3%80%81%E9%9B%86%E7%BE%A4"><span class="toc-text">12„ÄÅÈõÜÁæ§</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 By AXDecap</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="Switch Between Traditional Chinese And Simplified Chinese">ÁπÅ</button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="30" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body></html>